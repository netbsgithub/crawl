{"title": "java class加载机制及对象生成机制", "content": "java class加载机制及对象生成机制\n当使用到某个类，但该类还未初始化，未加载到内存中时会经历类加载、链接、初始化三个步骤完成类的初始化。需要注意的是类的初始化和链接的顺序有可能是互换的。\nClassLoader加载机制\nClassLoader用于动态加载class文件到内存中。\nJava 提供了三个ClassLoader：\n\n启动类加载器（BootStrap ClassLoader）：java类加载器中最顶层的类加载器，负责加载jdk中核心的类库，如：rt.jar、resources.jar、charsets.jar等。\n可通过System.out.println(System.getProperty(\"sun.boot.class.path\"));查看。\n扩展类加载器（Extension ClassLoader）：负责加载java的扩展类库，默认加载：JAVA_HOME/jre/lib/ext目录下的jar。\n系统类加载器（App ClassLoader）：负责加载应用程序classpath下的所有jar和class文件。\n自定义类加载器（CustomClassLoader）：自定义类加载器必须继承自java.lang.ClassLoader。\n\nClassLoader加载类的原理\n\n首先由最顶层的类加载器Bootstrap ClassLoader试图加载\n如果没加载到，则把任务转交给Extension ClassLoader试图加载\n如果也没加载到，则转交给App ClassLoader 进行加载\n\nJVM类加载机制\n\n全盘负责：当一个类加载某个class时，该class依赖的和引用的其它class都有该加载器负责加载，除非显式使用另外一个类加载器来载入。\n父类委托：先让父类试图加载该类，只有在父类无法加载该类时才从自己的类路径中进行加载。\n缓存机制：所有加载过的类都会缓存在内存中，如果程序中尝试使用某个class时，先从缓存中查找这个类；如果不存在，则读取该类对应的二进制文件并将其转换为class对象并存入缓存区。这就是为什么类修改后需要重启的原因。\n\n双亲委派模型的工作过程\n\n如果一个类加载器收到了类加载的请求，它首先不会自己去尝试加载这个类，而是把这个请求委派给父类加载器去完成，每一个层次的加载器都是如此，因此所有的类加载请求都会传给顶层的启动类加载器。\n只有当父加载器反馈自己无法完成该加载请求（该加载器的搜索范围中没有找到对应的类）时，子加载器才会尝试自己去加载。\n\n使用双亲委派模型的优点：\n\n保证了类加载的唯一性\n避免应用程序出现混乱\n\n类的链接\n当类加载完成后，系统会给为之生成一个对象；随后进入链接阶段，链接阶段负责把类的二进制数据添加到JRE中。\n三个阶段：\n\n验证：检验被加载的类是否有正确的内部结构，并和其他类协调一致\n准备：负责为类的类变量分配内存。并设置默认初始值\n解析：将类的二进制数据中的符号引用替换成直接引用\n\n类的初始化\nJVM负责对类进行初始化，主要对类变量进行初始化\n在Java中对类变量进行初始值设定有两种方式：\n* 声明类变量是指定初始值\n* 使用静态代码块为类变量指定初始值\nJVM初始化步骤\n\n假如这个类还没有被加载和连接，则程序先加载并连接该类\n假如该类的直接父类还没有被初始化，则先初始化其直接父类\n假如类中有初始化语句，则系统依次执行这些初始化语句\n\n参考文档：\n\n\nhttp://blog.csdn.net/boyupeng/article/details/47951037\n\n\n", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>java class加载机制及对象生成机制 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/6287840.html\">java class加载机制及对象生成机制</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><p>java class加载机制及对象生成机制</p>\n<p>当使用到某个类，但该类还未初始化，未加载到内存中时会经历<code>类加载</code>、<code>链接</code>、<code>初始化</code>三个步骤完成类的初始化。<code>需要注意的是类的初始化和链接的顺序有可能是互换的。</code></p>\n<h1 id=\"classloader加载机制\">ClassLoader加载机制</h1>\n<p>ClassLoader用于动态加载class文件到内存中。</p>\n<h2 id=\"java-提供了三个classloader\">Java 提供了三个ClassLoader：</h2>\n<ul>\n<li>启动类加载器（<code>BootStrap ClassLoader</code>）：java类加载器中最顶层的类加载器，负责加载<code>jdk中核心的类库</code>，如：rt.jar、resources.jar、charsets.jar等。<br>\n可通过<code>System.out.println(System.getProperty(\"sun.boot.class.path\"));</code>查看。</li>\n<li>扩展类加载器（<code>Extension ClassLoader</code>）：负责加载java的<code>扩展类库</code>，默认加载：JAVA_HOME/jre/lib/ext目录下的jar。</li>\n<li>系统类加载器（<code>App ClassLoader</code>）：负责加载<code>应用程序</code>classpath下的所有jar和class文件。</li>\n<li>自定义类加载器（<code>CustomClassLoader</code>）：自定义类加载器必须继承自<code>java.lang.ClassLoader</code>。</li>\n</ul>\n<h2 id=\"classloader加载类的原理\">ClassLoader加载类的原理</h2>\n<ul>\n<li>首先由最顶层的类加载器Bootstrap ClassLoader试图加载</li>\n<li>如果没加载到，则把任务转交给Extension ClassLoader试图加载</li>\n<li>如果也没加载到，则转交给App ClassLoader 进行加载</li>\n</ul>\n<h2 id=\"jvm类加载机制\">JVM类加载机制</h2>\n<ul>\n<li>全盘负责：当一个类加载某个class时，该class依赖的和引用的其它class都有该加载器负责加载，除非显式使用另外一个类加载器来载入。</li>\n<li>父类委托：先让父类试图加载该类，只有在父类无法加载该类时才从自己的类路径中进行加载。</li>\n<li>缓存机制：所有加载过的类都会缓存在内存中，如果程序中尝试使用某个class时，先从缓存中查找这个类；如果不存在，则读取该类对应的二进制文件并将其转换为class对象并存入缓存区。<code>这就是为什么类修改后需要重启的原因。</code></li>\n</ul>\n<h3 id=\"双亲委派模型的工作过程\">双亲委派模型的工作过程</h3>\n<ul>\n<li>如果一个类加载器收到了类加载的请求，它首先不会自己去尝试加载这个类，而是把这个请求委派给父类加载器去完成，每一个层次的加载器都是如此，因此所有的类加载请求都会传给顶层的启动类加载器。</li>\n<li>只有当父加载器反馈自己无法完成该加载请求（该加载器的搜索范围中没有找到对应的类）时，子加载器才会尝试自己去加载。</li>\n</ul>\n<p><strong>使用双亲委派模型的优点：</strong></p>\n<ul>\n<li>保证了类加载的唯一性</li>\n<li>避免应用程序出现混乱</li>\n</ul>\n<h1 id=\"类的链接\">类的链接</h1>\n<p>当类加载完成后，系统会给为之生成一个对象；随后进入链接阶段，链接阶段负责把类的二进制数据添加到JRE中。</p>\n<p>三个阶段：</p>\n<ul>\n<li>验证：检验被加载的类是否有正确的内部结构，并和其他类协调一致</li>\n<li>准备：负责为类的类变量分配内存。并设置<code>默认初始值</code></li>\n<li>解析：将类的二进制数据中的符号引用替换成直接引用</li>\n</ul>\n<h1 id=\"类的初始化\">类的初始化</h1>\n<p>JVM负责对类进行初始化，主要对类变量进行初始化</p>\n<p>在Java中对类变量进行初始值设定有两种方式：</p>\n<pre><code>* 声明类变量是指定初始值\n* 使用静态代码块为类变量指定初始值</code></pre>\n<h2 id=\"jvm初始化步骤\">JVM初始化步骤</h2>\n<ul>\n<li>假如这个类还没有被加载和连接，则程序先加载并连接该类</li>\n<li>假如该类的直接父类还没有被初始化，则先初始化其直接父类</li>\n<li>假如类中有初始化语句，则系统依次执行这些初始化语句</li>\n</ul>\n<p>参考文档：</p>\n<blockquote>\n<ul>\n<li><a href=\"http://blog.csdn.net/boyupeng/article/details/47951037\" class=\"uri\">http://blog.csdn.net/boyupeng/article/details/47951037</a></li>\n</ul>\n</blockquote>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-01-15 20:51</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=6287840\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(6287840);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=6287840,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2017/1/15 20:51:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/6287840.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=2", "desc": "摘要: java class加载机制及对象生成机制 当使用到某个类，但该类还未初始化，未加载到内存中时会经历 、`链接 初始化 需要注意的是类的初始化和链接的顺序有可能是互换的。` ClassLoader加载机制 ClassLoader用于动态加载class文件到内存中。 Java 提供了三个ClassLo"}
{"title": "垃圾收集器详解及参数配置", "content": "垃圾收集器详解及参数配置\n垃圾搜集器简介\n垃圾搜集器大致分为以下三类\n\n串行搜集器（serial collector）：它只有一条GC线程，且就像前面说的，它在运行的时候需要暂停用户程序（stop the world）。\n并行搜集器（parallel collector）：它有多条GC线程，且它也需要暂停用户程序（stop the world）。\n并发搜集器（concurrent collector）：它有一条或多条GC线程，且它需要在部分阶段暂停用户程序（stop the world），部分阶段与用户程序并发执行。\n\nhotspot中的垃圾搜集器\n\n串行搜集器的实现：serial（用于新生代，采用复制算法）、serial old（用于年老代，采用标记/整理算法）\n并行搜集器的实现：ParNew（用于新生代，采用复制算法）、Parallel Scavenge（用于新生代，采用复制算法）、Parallel old（用于年老代，采用标记/整理算法）\n并发搜集器的实现：concurrent mark sweep[CMS]（用于年老代，采用标记/清除算法）\n\n垃圾收集器详解\nJVM启动的两种模式\n\nclient模式：开发时默认启动模式\nserver模式：使用-server强制开启server模式，\n\n两者的主要区别：\n\nserver模式下做了大量的优化工作。\nserver模式下应用启动较慢，但在长时间运行情况下，运行速度会越来越快。\nclient模式启动快，但不适合长时间运行。\n\n搜集器详解\n\n\n\n名称\n算法\n内存区域\n执行方式\n执行过程\n特点\n适用场景\n开启参数\n\n\n\n\nSerial Garbage Collector\n复制算法\n针对新生代设计\n单线程、串行\n当新生代内存不够用时，先暂停全部用户程序，然后开启一条GC线程使用复制算法对垃圾进行回收，这一过程中可能会有一些对象提升到年老代\n由于单线程运行，且整个GC阶段都要暂停用户程序，因此会造成应用程序停顿时间较长，但对于小规模的程序来说，却非常适合。\n平时的开发与调试程序使用，以及桌面应用交互程序。\n-XX:+UseSerialGC（client模式默认值）\n\n\nSerial Old Garbage Collector\n标记/整理算法\n针对年老代设计\n单线程、串行\n同Serial Garbage Collector\n同Serial Garbage Collector\n同Serial Garbage Collector\n-\n\n\nParNew Garbage Collector\n复制算法\n针对新生代设计\n多线程、并行\n开启若干条GC线程使用复制算法并行进行垃圾回收，这一过程中可能会有一些对象提升到年老代\n有几个处理器就会开几个线程（不过线程数是可以使用参数-XX:ParallelGCThreads=控制的），因此只适合于多核多处理器的系统\n在中到大型的堆上，且系统处理器至少多于一个的情况。对于单个处理器来说，由于并行执行的开销（比如同步），ParNew的性能将会低于serial搜集器。\n-XX:+UseParNewGC\n\n\nParallel Scavenge Garbage Collector\n复制算法\n针对新生代设计\n并行\n优先满足最大停顿时间的目标，次之是吞吐量，最后才是新生代区域的最小值。\n更精确的控制GC停顿时间以及吞吐量\n适用场景\n控制最大的停顿时间（使用-XX:MaxGCPauseMillis=），以及控制吞吐量（使用-XX:GCTimeRatio=）server模式下默认的新生代搜集器\n\n\nParallel Old Garbage Collector\n标记/整理算法\n年老代设计\n并行搜集器\n-\n它是除了serial old以外唯一一个可以与parallel scavenge搭配工作的年老代搜集器\n-\n-XX:-UseParallelOldGC\n\n\nConcurrent Mark Sweep Garbage Collector\n标记/清除算法\n年老代\n-\n-\n应用程序与GC线程一起工作\n-\n-\n\n\n\n组合的威力\n三种经典的组合\nserial & serial old\nclient模式下默认的垃圾收集器组合，可通过-XX:+UseSerialGC强制开启。非常适合运行于客户端PC的小型应用程序，或者桌面应用程序（比如swing编写的用户界面程序），以及我们平时的开发、调试、测试等。\n开发、调试、测试共同的特点：\n\n1、由于都是在PC上运行，因此配置一般不会太高，或者说处理器个数不会太多。\n2、上面几种情况的应用程序都不会运行太久。\n3、规模不会太大，也就是说，堆相对较小，搜集起来也比较快，停顿时间会比较短。\n\nParallel Scavenge & Parallel Old\n这个组合是server模式下的默认组合（JDK6或JDK6之后），使用-XX:+UseParallelGC参数强制开启。\n适用于一些需要长期运行且对吞吐量有一定要求的后台程序。\n运行于后台的程序都有以下特点：\n\n1、系统配置较高，通常情况下至少四核（以目前的硬件水平为准）。\n2、对吞吐量要求较高，或需要达到一定的量。\n3、应用程序运行时间较长。\n4、应用程序规模较大，一般是中到大型的堆。\n\nParNew & CMS（Serial Old作为替补）\n它则是对响应时间（response time）要求较高的应用程序的首选，使用参数-XX:+UseConcMarkSweepGC开启。\n新生代采用并行搜集器\n适用于一些需要长期运行且对相应时间有一定要求的后台程序。\n采用ParNew & CMS组合的后台应用程序，一般都对相应时间有一定要求，最典型的就是我们的WEB应用程序。\n垃圾搜集器参数精解\n垃圾搜集器选择参数\n\n\n\n名称\n说明\n备注\n\n\n\n\nUseSerialGC\n开启此参数使用serial & serial old搜集器（client模式默认值）。\n\n\n\nUseParNewGC\n开启此参数使用ParNew & serial old搜集器（不推荐）。\n\n\n\nUseConcMarkSweepGC\n开启此参数使用ParNew & CMS（serial old为替补）搜集器。\n\n\n\nUseParallelGC\n开启此参数使用parallel scavenge & parallel old搜集器（server模式默认值）。\n\n\n\nUseParallelOldGC\n开启此参数在年老代使用parallel old搜集器（该参数在JDK1.5之后已无用）。\n\n\n\n\nJVM各个内存区域大小相关参数\n\n\n\n名称\n说明\n备注\n\n\n\n\nXms\n堆的初始值。默认为物理内存的1/64，最大不超1G。\n\n\n\nXmx\n堆的最大值。默认为物理内存的1/4，最大不超1G。\n\n\n\nXmn\n新生代的大小。\n\n\n\nXss\n线程栈大小。\n\n\n\nPermSize\n永久代初始大小。默认为物理内存的1/64，最大不超1G。\n\n\n\nMaxPermSize\n永久代最大值。默认为物理内存的1/4，最大不超1G。\n\n\n\nNewRatio\n新生代与年老代的比例。比如为3，则新生代占堆的1/4，年老代占3/4。\n\n\n\nSurvivorRatio\n新生代中调整eden区与survivor区的比例，默认为8，即eden区为80%的大小，两个survivor分别为10%的大小。\n\n\n\n\n垃圾搜集器性能通用参数\n\n\n\n名称\n说明\n备注\n\n\n\n\nPretenureSizeThreshold\n晋升年老代的对象大小。默认为0，比如设为10M，则超过10M的对象将不在eden区分配，而直接进入年老代。\n\n\n\nMaxTenuringThreshold\n晋升老年代的最大年龄。默认为15，比如设为10，则对象在10次普通GC后将会被放入年老代。\n\n\n\nDisableExplicitGC\n禁用System.gc()。\n\n\n\n\n并行搜集器参数\n\n\n\n名称\n说明\n备注\n\n\n\n\nParallelGCThreads\n回收时开启的线程数。默认与CPU个数相等。\n\n\n\nGCTimeRatio\n设置系统的吞吐量。比如设为99，则GC时间比为1/1+99=1%，也就是要求吞吐量为99%。若无法满足会缩小新生代大小。\n\n\n\nMaxGCPauseMillis\n设置垃圾回收的最大停顿时间。若无法满足设置值，则会优先缩小新生代大小，仍无法满足的话则会牺牲吞吐量。\n\n\n\n\n并发搜集器参数\n\n\n\n名称\n说明\n备注\n\n\n\n\nCMSInitiatingOccupancyFraction\n触发CMS收集器的内存比例。比如60%的意思就是说，当内存达到60%，就会开始进行CMS并发收集。\n\n\n\nUseCMSCompactAtFullCollection\n在每一次CMS收集器清理垃圾后送一次内存整理。\n\n\n\nCMSFullGCsBeforeCompaction\n设置在几次CMS垃圾收集后，触发一次内存整理。\n\n\n\n\n整理自：\n\n\nhttp://www.cnblogs.com/zuoxiaolong/p/jvm7.html\nhttp://www.cnblogs.com/zuoxiaolong/p/jvm8.html\nhttp://www.cnblogs.com/zuoxiaolong/p/jvm9.html\n\n\n", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>垃圾收集器详解及参数配置 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/6248205.html\">垃圾收集器详解及参数配置</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><h1 id=\"垃圾收集器详解及参数配置\">垃圾收集器详解及参数配置</h1>\n<h2 id=\"垃圾搜集器简介\">垃圾搜集器简介</h2>\n<h3 id=\"垃圾搜集器大致分为以下三类\">垃圾搜集器大致分为以下三类</h3>\n<ul>\n<li>串行搜集器（serial collector）：它只有一条GC线程，且就像前面说的，它在运行的时候需要暂停用户程序（stop the world）。</li>\n<li>并行搜集器（parallel collector）：它有多条GC线程，且它也需要暂停用户程序（stop the world）。</li>\n<li>并发搜集器（concurrent collector）：它有一条或多条GC线程，且它需要在部分阶段暂停用户程序（stop the world），部分阶段与用户程序并发执行。</li>\n</ul>\n<h3 id=\"hotspot中的垃圾搜集器\">hotspot中的垃圾搜集器</h3>\n<ul>\n<li>串行搜集器的实现：serial（用于新生代，采用<code>复制算法</code>）、serial old（用于年老代，<code>采用标记/整理算法</code>）</li>\n<li>并行搜集器的实现：ParNew（用于新生代，采用<code>复制算法</code>）、Parallel Scavenge（用于新生代，采用<code>复制算法</code>）、Parallel old（用于年老代，采用<code>标记/整理算法</code>）</li>\n<li>并发搜集器的实现：concurrent mark sweep[CMS]（用于年老代，采用<code>标记/清除算法</code>）</li>\n</ul>\n<h2 id=\"垃圾收集器详解\">垃圾收集器详解</h2>\n<h3 id=\"jvm启动的两种模式\">JVM启动的两种模式</h3>\n<ul>\n<li>client模式：开发时默认启动模式</li>\n<li>server模式：使用-server强制开启server模式，</li>\n</ul>\n<p>两者的主要区别：</p>\n<ul>\n<li>server模式下做了大量的优化工作。</li>\n<li>server模式下应用启动较慢，但在长时间运行情况下，运行速度会越来越快。</li>\n<li>client模式启动快，但不适合长时间运行。</li>\n</ul>\n<h3 id=\"搜集器详解\">搜集器详解</h3>\n<table>\n<thead>\n<tr class=\"header\">\n<th>名称</th>\n<th align=\"center\">算法</th>\n<th>内存区域</th>\n<th align=\"center\">执行方式</th>\n<th>执行过程</th>\n<th align=\"center\">特点</th>\n<th align=\"right\">适用场景</th>\n<th align=\"right\">开启参数</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td>Serial Garbage Collector</td>\n<td align=\"center\">复制算法</td>\n<td>针对新生代设计</td>\n<td align=\"center\">单线程、串行</td>\n<td>当新生代内存不够用时，先暂停全部用户程序，然后开启一条GC线程使用复制算法对垃圾进行回收，这一过程中可能会有一些对象提升到年老代</td>\n<td align=\"center\">由于单线程运行，且整个GC阶段都要暂停用户程序，因此会造成应用程序停顿时间较长，但对于小规模的程序来说，却非常适合。</td>\n<td align=\"right\">平时的开发与调试程序使用，以及桌面应用交互程序。</td>\n<td align=\"right\">-XX:+UseSerialGC（client模式默认值）</td>\n</tr>\n<tr class=\"even\">\n<td>Serial Old Garbage Collector</td>\n<td align=\"center\">标记/整理算法</td>\n<td>针对年老代设计</td>\n<td align=\"center\">单线程、串行</td>\n<td>同Serial Garbage Collector</td>\n<td align=\"center\">同Serial Garbage Collector</td>\n<td align=\"right\">同Serial Garbage Collector</td>\n<td align=\"right\">-</td>\n</tr>\n<tr class=\"odd\">\n<td>ParNew Garbage Collector</td>\n<td align=\"center\">复制算法</td>\n<td>针对新生代设计</td>\n<td align=\"center\">多线程、并行</td>\n<td>开启若干条GC线程使用复制算法并行进行垃圾回收，这一过程中可能会有一些对象提升到年老代</td>\n<td align=\"center\">有几个处理器就会开几个线程（不过线程数是可以使用参数-XX:ParallelGCThreads=<n>控制的），因此只适合于多核多处理器的系统</n></td>\n<td align=\"right\">在中到大型的堆上，且系统处理器至少多于一个的情况。对于单个处理器来说，由于并行执行的开销（比如同步），ParNew的性能将会低于serial搜集器。</td>\n<td align=\"right\">-XX:+UseParNewGC</td>\n</tr>\n<tr class=\"even\">\n<td>Parallel Scavenge Garbage Collector</td>\n<td align=\"center\">复制算法</td>\n<td>针对新生代设计</td>\n<td align=\"center\">并行</td>\n<td>优先满足最大停顿时间的目标，次之是吞吐量，最后才是新生代区域的最小值。</td>\n<td align=\"center\">更精确的控制GC停顿时间以及吞吐量</td>\n<td align=\"right\">适用场景</td>\n<td align=\"right\">控制最大的停顿时间（使用-XX:MaxGCPauseMillis=<n>），以及控制吞吐量（使用-XX:GCTimeRatio=<n>）server模式下默认的新生代搜集器</n></n></td>\n</tr>\n<tr class=\"odd\">\n<td>Parallel Old Garbage Collector</td>\n<td align=\"center\">标记/整理算法</td>\n<td>年老代设计</td>\n<td align=\"center\">并行搜集器</td>\n<td>-</td>\n<td align=\"center\">它是除了serial old以外唯一一个可以与parallel scavenge搭配工作的年老代搜集器</td>\n<td align=\"right\">-</td>\n<td align=\"right\">-XX:-UseParallelOldGC</td>\n</tr>\n<tr class=\"even\">\n<td>Concurrent Mark Sweep Garbage Collector</td>\n<td align=\"center\">标记/清除算法</td>\n<td>年老代</td>\n<td align=\"center\">-</td>\n<td>-</td>\n<td align=\"center\">应用程序与GC线程一起工作</td>\n<td align=\"right\">-</td>\n<td align=\"right\">-</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"组合的威力\">组合的威力</h2>\n<h3 id=\"三种经典的组合\">三种经典的组合</h3>\n<h4 id=\"serial-serial-old\">serial &amp; serial old</h4>\n<p>client模式下默认的垃圾收集器组合，可通过<code>-XX:+UseSerialGC</code>强制开启。非常适合运行于客户端PC的小型应用程序，或者桌面应用程序（比如swing编写的用户界面程序），以及我们平时的开发、调试、测试等。</p>\n<p>开发、调试、测试共同的特点：</p>\n<ul>\n<li>1、由于都是在PC上运行，因此配置一般不会太高，或者说处理器个数不会太多。</li>\n<li>2、上面几种情况的应用程序都不会运行太久。</li>\n<li>3、规模不会太大，也就是说，堆相对较小，搜集起来也比较快，停顿时间会比较短。</li>\n</ul>\n<h4 id=\"parallel-scavenge-parallel-old\">Parallel Scavenge &amp; Parallel Old</h4>\n<p>这个组合是server模式下的默认组合（JDK6或JDK6之后），使用<code>-XX:+UseParallelGC</code>参数强制开启。</p>\n<p>适用于一些需要长期运行且对吞吐量有一定要求的后台程序。</p>\n<p>运行于后台的程序都有以下特点：</p>\n<ul>\n<li>1、系统配置较高，通常情况下至少四核（以目前的硬件水平为准）。</li>\n<li>2、对吞吐量要求较高，或需要达到一定的量。</li>\n<li>3、应用程序运行时间较长。</li>\n<li>4、应用程序规模较大，一般是中到大型的堆。</li>\n</ul>\n<h4 id=\"parnew-cmsserial-old作为替补\">ParNew &amp; CMS（Serial Old作为替补）</h4>\n<p>它则是对响应时间（response time）要求较高的应用程序的首选，使用参数<code>-XX:+UseConcMarkSweepGC</code>开启。</p>\n<p>新生代采用并行搜集器</p>\n<p>适用于一些需要长期运行且对相应时间有一定要求的后台程序。</p>\n<p>采用<code>ParNew &amp; CMS</code>组合的后台应用程序，一般都对相应时间有一定要求，最典型的就是我们的<code>WEB应用程序</code>。</p>\n<h2 id=\"垃圾搜集器参数精解\">垃圾搜集器参数精解</h2>\n<h3 id=\"垃圾搜集器选择参数\">垃圾搜集器选择参数</h3>\n<table>\n<thead>\n<tr class=\"header\">\n<th>名称</th>\n<th align=\"center\">说明</th>\n<th align=\"center\">备注</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td>UseSerialGC</td>\n<td align=\"center\">开启此参数使用serial &amp; serial old搜集器（client模式默认值）。</td>\n<td align=\"center\"></td>\n</tr>\n<tr class=\"even\">\n<td>UseParNewGC</td>\n<td align=\"center\">开启此参数使用ParNew &amp; serial old搜集器（不推荐）。</td>\n<td align=\"center\"></td>\n</tr>\n<tr class=\"odd\">\n<td>UseConcMarkSweepGC</td>\n<td align=\"center\">开启此参数使用ParNew &amp; CMS（serial old为替补）搜集器。</td>\n<td align=\"center\"></td>\n</tr>\n<tr class=\"even\">\n<td>UseParallelGC</td>\n<td align=\"center\">开启此参数使用parallel scavenge &amp; parallel old搜集器（server模式默认值）。</td>\n<td align=\"center\"></td>\n</tr>\n<tr class=\"odd\">\n<td>UseParallelOldGC</td>\n<td align=\"center\">开启此参数在年老代使用parallel old搜集器（该参数在JDK1.5之后已无用）。</td>\n<td align=\"center\"></td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"jvm各个内存区域大小相关参数\">JVM各个内存区域大小相关参数</h3>\n<table>\n<thead>\n<tr class=\"header\">\n<th>名称</th>\n<th align=\"center\">说明</th>\n<th align=\"center\">备注</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td>Xms</td>\n<td align=\"center\">堆的初始值。默认为物理内存的1/64，最大不超1G。</td>\n<td align=\"center\"></td>\n</tr>\n<tr class=\"even\">\n<td>Xmx</td>\n<td align=\"center\">堆的最大值。默认为物理内存的1/4，最大不超1G。</td>\n<td align=\"center\"></td>\n</tr>\n<tr class=\"odd\">\n<td>Xmn</td>\n<td align=\"center\">新生代的大小。</td>\n<td align=\"center\"></td>\n</tr>\n<tr class=\"even\">\n<td>Xss</td>\n<td align=\"center\">线程栈大小。</td>\n<td align=\"center\"></td>\n</tr>\n<tr class=\"odd\">\n<td>PermSize</td>\n<td align=\"center\">永久代初始大小。默认为物理内存的1/64，最大不超1G。</td>\n<td align=\"center\"></td>\n</tr>\n<tr class=\"even\">\n<td>MaxPermSize</td>\n<td align=\"center\">永久代最大值。默认为物理内存的1/4，最大不超1G。</td>\n<td align=\"center\"></td>\n</tr>\n<tr class=\"odd\">\n<td>NewRatio</td>\n<td align=\"center\">新生代与年老代的比例。比如为3，则新生代占堆的1/4，年老代占3/4。</td>\n<td align=\"center\"></td>\n</tr>\n<tr class=\"even\">\n<td>SurvivorRatio</td>\n<td align=\"center\">新生代中调整eden区与survivor区的比例，默认为8，即eden区为80%的大小，两个survivor分别为10%的大小。</td>\n<td align=\"center\"></td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"垃圾搜集器性能通用参数\">垃圾搜集器性能通用参数</h3>\n<table>\n<thead>\n<tr class=\"header\">\n<th>名称</th>\n<th align=\"center\">说明</th>\n<th align=\"center\">备注</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td>PretenureSizeThreshold</td>\n<td align=\"center\">晋升年老代的对象大小。默认为0，比如设为10M，则超过10M的对象将不在eden区分配，而直接进入年老代。</td>\n<td align=\"center\"></td>\n</tr>\n<tr class=\"even\">\n<td>MaxTenuringThreshold</td>\n<td align=\"center\">晋升老年代的最大年龄。默认为15，比如设为10，则对象在10次普通GC后将会被放入年老代。</td>\n<td align=\"center\"></td>\n</tr>\n<tr class=\"odd\">\n<td>DisableExplicitGC</td>\n<td align=\"center\">禁用System.gc()。</td>\n<td align=\"center\"></td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"并行搜集器参数\">并行搜集器参数</h3>\n<table>\n<thead>\n<tr class=\"header\">\n<th>名称</th>\n<th align=\"center\">说明</th>\n<th align=\"center\">备注</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td>ParallelGCThreads</td>\n<td align=\"center\">回收时开启的线程数。默认与CPU个数相等。</td>\n<td align=\"center\"></td>\n</tr>\n<tr class=\"even\">\n<td>GCTimeRatio</td>\n<td align=\"center\">设置系统的吞吐量。比如设为99，则GC时间比为1/1+99=1%，也就是要求吞吐量为99%。若无法满足会缩小新生代大小。</td>\n<td align=\"center\"></td>\n</tr>\n<tr class=\"odd\">\n<td>MaxGCPauseMillis</td>\n<td align=\"center\">设置垃圾回收的最大停顿时间。若无法满足设置值，则会优先缩小新生代大小，仍无法满足的话则会牺牲吞吐量。</td>\n<td align=\"center\"></td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"并发搜集器参数\">并发搜集器参数</h3>\n<table>\n<thead>\n<tr class=\"header\">\n<th>名称</th>\n<th align=\"center\">说明</th>\n<th align=\"center\">备注</th>\n</tr>\n</thead>\n<tbody>\n<tr class=\"odd\">\n<td>CMSInitiatingOccupancyFraction</td>\n<td align=\"center\">触发CMS收集器的内存比例。比如60%的意思就是说，当内存达到60%，就会开始进行CMS并发收集。</td>\n<td align=\"center\"></td>\n</tr>\n<tr class=\"even\">\n<td>UseCMSCompactAtFullCollection</td>\n<td align=\"center\">在每一次CMS收集器清理垃圾后送一次内存整理。</td>\n<td align=\"center\"></td>\n</tr>\n<tr class=\"odd\">\n<td>CMSFullGCsBeforeCompaction</td>\n<td align=\"center\">设置在几次CMS垃圾收集后，触发一次内存整理。</td>\n<td align=\"center\"></td>\n</tr>\n</tbody>\n</table>\n<p>整理自：</p>\n<blockquote>\n<ul>\n<li><a href=\"http://www.cnblogs.com/zuoxiaolong/p/jvm7.html\" class=\"uri\">http://www.cnblogs.com/zuoxiaolong/p/jvm7.html</a></li>\n<li><a href=\"http://www.cnblogs.com/zuoxiaolong/p/jvm8.html\" class=\"uri\">http://www.cnblogs.com/zuoxiaolong/p/jvm8.html</a></li>\n<li><a href=\"http://www.cnblogs.com/zuoxiaolong/p/jvm9.html\" class=\"uri\">http://www.cnblogs.com/zuoxiaolong/p/jvm9.html</a></li>\n</ul>\n</blockquote>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-01-04 12:38</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=6248205\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(6248205);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=6248205,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2017/1/4 12:38:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/6248205.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=2", "desc": "摘要: 垃圾收集器详解及参数配置 垃圾搜集器简介 垃圾搜集器大致分为以下三类 串行搜集器（serial collector）：它只有一条GC线程，且就像前面说的，它在运行的时候需要暂停用户程序（stop the world）。 并行搜集器（parallel collector）：它有多条GC线程，且它也需要"}
{"title": "单例模式", "content": "所有单例模式都有一个共性，那就是这个类没有自己的状态。也就是说无论这个类有多少个实例，都是一样的；然后除此者外更重要的是，这个类如果有两个或两个以上的实例的话程序会产生错误。\n基于上述原因，非线程安全的实现方式，在此不再讨论。下面讨论的都是线程安全的一些实现方式和存在的问题。\n双重加锁模式\npublic class Singleton{\n  private volatile static Singleton singleton;\n  private Singleton(){\n\n  }\n\n  public static Singleton getInstance(){\n    if(null == singleton){\n      synchronized(Singleton.class){\n        if(null == singleton){\n          singleton = new Singleton();\n        }\n      }\n    }\n    return singleton;\n  }\n}\n双重加锁模式相对于普通的单例和加锁模式而言，从性能和线程安全上来说都有很大的提升和保障。然而双重加锁模式也存在一些隐蔽不易被发现的问题。首先我们要明白在JVM创建新的对象时，主要要经过三个步骤。\n\n\n分配内存\n\n\n初始化构造器\n\n\n将对象指向分配的内存地址\n\n\n这样的顺序在双重加锁模式下是么有问题的，对象在初始化完成之后再把内存地址指向对象。但是现代的JVM会针对字节码进行调优，这样的话就有可能导致2和3的顺序是相反的，一旦出现这样的情况问题就来了。\n所以更加理想的方案是利用静态内部类的方式来创建，因为静态属性由JVM确保第一次初始化时创建，因此也不用担心并发的问题出现。当初始化进行到一半的时候，别的线程是无法使用的，因为JVM会帮我们强行同步这个过程。另外由于静态变量只初始化一次，所以singleton仍然是单例的。\n静态内部类的方式\npublic class Singleton{\n\n  private Singleton(){}\n\n  public static Singleton getInstance(){\n    return InnerClassSingleton.singleton;\n  }\n\n  private class InnerClassSingleton{\n    protected static Singleton singleton = new Singleton();\n  }\n}\n然而，虽然静态内部类模式可以很好地避免并发创建出多个实例的问题，但这种方式仍然有其存在的隐患。\n\n\n一旦一个实例被持久化后重新生成的实例仍然有可能是不唯一的。\n\n\n由于java提供了反射机制，通过反射机制仍然有可能生成多个实例。\n\n\n单例最优方案，枚举的方式\n枚举实现单例的优势\n\n\n自由序列化；\n保证只有一个实例（即使使用反射机制也无法多次实例化一个枚举量）；\n线程安全；\n\n\npublic enum Singleton {\n    INSTANCE;\n\n    private Singleton(){}\n}\n参考文档：\n\n\nhttp://www.cnblogs.com/zuoxiaolong/p/pattern2.html\n\n\n", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>单例模式 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/6154976.html\">单例模式</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><p>所有单例模式都有一个共性，那就是这个类没有自己的状态。也就是说无论这个类有多少个实例，都是一样的；然后除此者外更重要的是，这个类如果有两个或两个以上的实例的话程序会产生错误。</p>\n<p>基于上述原因，非线程安全的实现方式，在此不再讨论。下面讨论的都是线程安全的一些实现方式和存在的问题。</p>\n<p><code>双重加锁模式</code></p>\n<pre><code>public class Singleton{\n  private volatile static Singleton singleton;\n  private Singleton(){\n\n  }\n\n  public static Singleton getInstance(){\n    if(null == singleton){\n      synchronized(Singleton.class){\n        if(null == singleton){\n          singleton = new Singleton();\n        }\n      }\n    }\n    return singleton;\n  }\n}</code></pre>\n<p><code>双重加锁模式</code>相对于普通的单例和加锁模式而言，从性能和线程安全上来说都有很大的提升和保障。然而<code>双重加锁模式</code>也存在一些隐蔽不易被发现的问题。首先我们要明白在JVM创建新的对象时，主要要经过三个步骤。</p>\n<ul>\n<li><ul>\n<li>分配内存</li>\n</ul></li>\n<li><ul>\n<li>初始化构造器</li>\n</ul></li>\n<li><ul>\n<li>将对象指向分配的内存地址</li>\n</ul></li>\n</ul>\n<p>这样的顺序在双重加锁模式下是么有问题的，对象在初始化完成之后再把内存地址指向对象。但是现代的JVM会针对字节码进行调优，这样的话就有可能导致2和3的顺序是相反的，一旦出现这样的情况问题就来了。</p>\n<p>所以更加理想的方案是利用静态内部类的方式来创建，因为静态属性由JVM确保第一次初始化时创建，因此也不用担心并发的问题出现。当初始化进行到一半的时候，别的线程是无法使用的，因为JVM会帮我们强行同步这个过程。另外由于静态变量只初始化一次，所以singleton仍然是单例的。</p>\n<p><code>静态内部类</code>的方式</p>\n<pre><code>public class Singleton{\n\n  private Singleton(){}\n\n  public static Singleton getInstance(){\n    return InnerClassSingleton.singleton;\n  }\n\n  private class InnerClassSingleton{\n    protected static Singleton singleton = new Singleton();\n  }\n}</code></pre>\n<p>然而，虽然<code>静态内部类</code>模式可以很好地避免并发创建出多个实例的问题，但这种方式仍然有其存在的隐患。</p>\n<ul>\n<li><ul>\n<li>一旦一个实例被持久化后重新生成的实例仍然有可能是不唯一的。</li>\n</ul></li>\n<li><ul>\n<li>由于java提供了反射机制，通过反射机制仍然有可能生成多个实例。</li>\n</ul></li>\n</ul>\n<p>单例最优方案，<code>枚举</code>的方式</p>\n<p>枚举实现单例的优势</p>\n<blockquote>\n<ul>\n<li>自由序列化；</li>\n<li>保证只有一个实例（即使使用反射机制也无法多次实例化一个枚举量）；</li>\n<li>线程安全；</li>\n</ul>\n</blockquote>\n<pre><code>public enum Singleton {\n    INSTANCE;\n\n    private Singleton(){}\n}</code></pre>\n<p>参考文档：</p>\n<blockquote>\n<ul>\n<li><a href=\"http://www.cnblogs.com/zuoxiaolong/p/pattern2.html\" class=\"uri\">http://www.cnblogs.com/zuoxiaolong/p/pattern2.html</a></li>\n</ul>\n</blockquote>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2016-12-10 10:12</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=6154976\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(6154976);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=6154976,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2016/12/10 10:12:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/6154976.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=2", "desc": "摘要: 所有单例模式都有一个共性，那就是这个类没有自己的状态。也就是说无论这个类有多少个实例，都是一样的；然后除此者外更重要的是，这个类如果有两个或两个以上的实例的话程序会产生错误。 基于上述原因，非线程安全的实现方式，在此不再讨论。下面讨论的都是线程安全的一些实现方式和存在的问题。 相对于普通的单例和加锁"}
{"title": "java性能调优及问题追踪--Btrace的使用", "content": "在生产环境中经常遇到格式各样的问题，如OOM或者莫名其妙的进程死掉。一般情况下是通过修改程序，添加打印日志；然后重新发布程序来完成。然而，这不仅麻烦，而且带来很多不可控的因素。有没有一种方式，在不修改原有运行程序的情况下获取运行时的数据信息呢？如方法参数、返回值、全局变量、堆栈信息等。Btrace就是这样一个工具，它可以在不修改原有代码的情况下动态地追踪java运行程序，通过hotswap技术，动态将跟踪字节码注入到运行类中，对运行代码侵入较小，对性能上的影响可以忽略不计。\n基础说明\n由于Btrace会把脚本逻辑直接侵入到运行的代码中，所以在使用上做很多限制：\n\n\n不能创建对象\n不能使用数组\n不能抛出或捕获异常\n不能使用循环\n不能使用synchronized关键字\n属性和方法必须使用static修饰\n\n\n需要特别注意的是：不恰当的使用BTrace可能导致JVM崩溃，如在BTrace脚本使用错误的class文件，所以在上生产环境之前，务必在本地充分的验证脚本的正确性。\nBtrace可以做什么？\n\n\n接口性能变慢，分析每个方法的耗时情况；\n当在Map中插入大量数据，分析其扩容情况；\n分析哪个方法调用了System.gc()，调用栈如何；\n执行某个方法抛出异常时，分析运行时参数；\n....\n\n\n参数说明：\n指定分析方法的入口：@OnMethod\nBtrace使用@OnMethod注解定义需要分析的方法入口\n在@OnMethod注解中，需要指定class、method以及location等，class表明需要监控的类，method表明需要监控的方法，指定方式如下：\n\n\n使用全限定名：clazz=\"com.metty.rpc.common.BtraceCase\", method=\"add\"\n使用正则表达式：clazz=\"/javax.swing../\", method=\"/./\"\n使用接口：clazz=\"+com.ctrip.demo.Filter\", method=\"doFilter\"\n使用注解：clazz=\"@javax.jws.WebService\", method=\"\"@javax.jws.WebMethod\"\n如果需要分析构造方法，需要指定method=\"\"\n\n\n指定方法拦截的位置：@Location\n定义Btrace对方法的拦截位置，通过@Location注解指定，默认为Kind.ENTRY\n\n\nKind.ENTRY：在进入方法时，调用Btrace脚本\nKind.RETURN：方法执行完时，调用Btrace脚本，只有把拦截位置定义为Kind.RETURN，才能获取方法的返回结果@Return和执行时间@Duration\nKind.CALL：分析方法中调用其它方法的执行情况，比如在execute方法中，想获取add方法的执行耗时，必须把where设置成Where.AFTER\nKind.LINE：通过设置line，可以监控代码是否执行到指定的位置\nKind.ERROR, Kind.THROW, Kind.CATCH\n\n\n总结\nBtrace能做的事情太多，但使用之前切记检查脚本的可行性，一旦Btrace脚本侵入到系统中，只有通过重启才能恢复。\n\n通过jvisualvm插件的方式进行测试：\n安装Btrace插件\n工具-->插件-->可用插件中找到BTrace Workbench进行安装即可。\n测试用例\npackage com.vmtools;\n\npublic class Counter {\n    // 总数\n    private static int totalCount = 0;\n\n    public int add(int num) throws Exception {\n        totalCount += num;\n        sleep();\n\n        return totalCount;\n    }\n\n    private void sleep() throws InterruptedException {\n        Thread.sleep(1000);\n    }\n}\n\npackage com.vmtools;\n\nimport java.util.Random;\npublic class BtraceTest {\n\n    public static void main(String[] args) throws Exception {\n\n        Random random = new Random();\n\n        // 计数器\n        Counter counter = new Counter();\n        while (true) {\n            // 每次增加随机值\n            counter.add(random.nextInt(10));\n            Thread.sleep(1000);\n        }\n    }\n}\n\n\nBtrace测试\n运行上诉测试用例\njvisualvm中找到对应的进程id-->Trace application...-->分别进行相应的测试\n获取add()方法参数值和返回值。\n/* BTrace Script Template */\nimport com.sun.btrace.annotations.*;\nimport static com.sun.btrace.BTraceUtils.*;\n\n//获取add()方法参数值和返回值。\n@BTrace\npublic class TracingScript {\n    /* put your code here */\n    @OnMethod(\n        clazz=\"com.vmtools.Counter\",\n        method=\"add\",\n        location=@Location(Kind.RETURN)\n    )\n\n    public static void func(\n            int a,\n            @Return int result) {\n        println(\"trace: =======================\");\n        jstack();\n        println(strcat(\"a:\", str(a)));\n        println(strcat(\"result:\", str(result)));\n    }\n}\n定时获取Counter类的属性值totalCount\n/* BTrace Script Template */\nimport com.sun.btrace.annotations.*;\nimport static com.sun.btrace.BTraceUtils.*;\n\n//定时获取Counter类的属性值totalCount。\n@BTrace\npublic class TracingScript {\n    private static Object totalCount=0;\n\n    /* put your code here */\n    @OnMethod(\n        clazz=\"com.vmtools.Counter\",\n        method=\"add\",\n        location=@Location(Kind.RETURN)\n    )\n    public static void func(@Self com.vmtools.Counter counter) {\n        totalCount = get(field(\"com.vmtools.Counter\", \"totalCount\"), counter);\n    }\n\n    @OnTimer(2000)\n    public static void print(){\n        println(\" ====== \");\n        println(strcat(\"totalCount: \",str(totalCount)));\n    }\n}\n获取add方法执行时间\n/* BTrace Script Template */\nimport com.sun.btrace.annotations.*;\nimport static com.sun.btrace.BTraceUtils.*;\n\n//获取add方法执行时间\n@BTrace\npublic class TracingScript {\n    @TLS private static long startTime = 0;\n\n    /* put your code here */\n    @OnMethod(\n        clazz=\"com.vmtools.Counter\",\n        method=\"add\"\n    )\n    public static void func(@Self com.vmtools.Counter counter) {\n        startTime = timeNanos();\n    }\n\n    @OnMethod(\n        clazz=\"com.vmtools.Counter\",\n        method=\"add\",\n        location=@Location(Kind.RETURN)\n    )\n    public static void endExecute(@Duration long duration){  \n     long time = timeNanos() - startTime;  \n     println(strcat(\"execute time(nanos): \", str(time)));  \n     println(strcat(\"duration(nanos): \", str(duration)));  \n   }   \n}\n参考文档：\n\n\nhttp://www.jianshu.com/p/dbb3a8b5c92f\nhttp://www.cnblogs.com/langtianya/p/4444025.html\n\n\n", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>java性能调优及问题追踪--Btrace的使用 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/6248210.html\">java性能调优及问题追踪--Btrace的使用</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><p>在生产环境中经常遇到格式各样的问题，如OOM或者莫名其妙的进程死掉。一般情况下是通过修改程序，添加打印日志；然后重新发布程序来完成。然而，这不仅麻烦，而且带来很多不可控的因素。有没有一种方式，在不修改原有运行程序的情况下获取运行时的数据信息呢？如方法参数、返回值、全局变量、堆栈信息等。Btrace就是这样一个工具，它可以在不修改原有代码的情况下动态地追踪java运行程序，通过hotswap技术，动态将跟踪字节码注入到运行类中，对运行代码侵入较小，对性能上的影响可以忽略不计。</p>\n<h2 id=\"基础说明\">基础说明</h2>\n<p>由于Btrace会把脚本逻辑直接侵入到运行的代码中，所以在使用上做很多限制：</p>\n<blockquote>\n<ul>\n<li>不能创建对象</li>\n<li>不能使用数组</li>\n<li>不能抛出或捕获异常</li>\n<li>不能使用循环</li>\n<li>不能使用synchronized关键字</li>\n<li>属性和方法必须使用static修饰</li>\n</ul>\n</blockquote>\n<p>需要特别注意的是：<code>不恰当的使用BTrace可能导致JVM崩溃，如在BTrace脚本使用错误的class文件，所以在上生产环境之前，务必在本地充分的验证脚本的正确性。</code></p>\n<p>Btrace可以做什么？</p>\n<blockquote>\n<ul>\n<li>接口性能变慢，分析每个方法的耗时情况；</li>\n<li>当在Map中插入大量数据，分析其扩容情况；</li>\n<li>分析哪个方法调用了System.gc()，调用栈如何；</li>\n<li>执行某个方法抛出异常时，分析运行时参数；</li>\n<li>....</li>\n</ul>\n</blockquote>\n<h3 id=\"参数说明\">参数说明：</h3>\n<h4 id=\"指定分析方法的入口onmethod\">指定分析方法的入口：<code>@OnMethod</code></h4>\n<p>Btrace使用<code>@OnMethod</code>注解定义需要分析的方法入口</p>\n<p>在<code>@OnMethod</code>注解中，需要指定class、method以及location等，class表明需要监控的类，method表明需要监控的方法，指定方式如下：</p>\n<blockquote>\n<ul>\n<li>使用全限定名：clazz=\"com.metty.rpc.common.BtraceCase\", method=\"add\"</li>\n<li>使用正则表达式：clazz=\"/javax.swing..<em>/\", method=\"/.</em>/\"</li>\n<li>使用接口：clazz=\"+com.ctrip.demo.Filter\", method=\"doFilter\"</li>\n<li>使用注解：<a href=\"mailto:clazz=%22@javax.jws.WebService%22\">clazz=\"@javax.jws.WebService\"</a>, <a href=\"mailto:method=%22%22@javax.jws.WebMethod\">method=\"\"@javax.jws.WebMethod</a>\"</li>\n<li>如果需要分析构造方法，需要指定method=\"<init>\"</init></li>\n</ul>\n</blockquote>\n<h4 id=\"指定方法拦截的位置location\">指定方法拦截的位置：<code>@Location</code></h4>\n<p>定义Btrace对方法的拦截位置，通过<code>@Location</code>注解指定，默认为<code>Kind.ENTRY</code></p>\n<blockquote>\n<ul>\n<li>Kind.ENTRY：在进入方法时，调用Btrace脚本</li>\n<li>Kind.RETURN：方法执行完时，调用Btrace脚本，只有把拦截位置定义为Kind.RETURN，<a href=\"mailto:%E6%89%8D%E8%83%BD%E8%8E%B7%E5%8F%96%E6%96%B9%E6%B3%95%E7%9A%84%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C@Return%E5%92%8C%E6%89%A7%E8%A1%8C%E6%97%B6%E9%97%B4@Duration\">才能获取方法的返回结果@Return和执行时间@Duration</a></li>\n<li>Kind.CALL：分析方法中调用其它方法的执行情况，比如在execute方法中，想获取add方法的执行耗时，必须把where设置成Where.AFTER</li>\n<li>Kind.LINE：通过设置line，可以监控代码是否执行到指定的位置</li>\n<li>Kind.ERROR, Kind.THROW, Kind.CATCH</li>\n</ul>\n</blockquote>\n<h3 id=\"总结\">总结</h3>\n<p><code>Btrace能做的事情太多，但使用之前切记检查脚本的可行性，一旦Btrace脚本侵入到系统中，只有通过重启才能恢复。</code></p>\n<hr>\n<p>通过<code>jvisualvm</code>插件的方式进行测试：</p>\n<h2 id=\"安装btrace插件\">安装Btrace插件</h2>\n<p>工具--&gt;插件--&gt;可用插件中找到<code>BTrace Workbench</code>进行安装即可。</p>\n<h2 id=\"测试用例\">测试用例</h2>\n<pre><code>package com.vmtools;\n\npublic class Counter {\n    // 总数\n    private static int totalCount = 0;\n\n    public int add(int num) throws Exception {\n        totalCount += num;\n        sleep();\n\n        return totalCount;\n    }\n\n    private void sleep() throws InterruptedException {\n        Thread.sleep(1000);\n    }\n}\n</code></pre>\n<pre><code>package com.vmtools;\n\nimport java.util.Random;\npublic class BtraceTest {\n\n    public static void main(String[] args) throws Exception {\n\n        Random random = new Random();\n\n        // 计数器\n        Counter counter = new Counter();\n        while (true) {\n            // 每次增加随机值\n            counter.add(random.nextInt(10));\n            Thread.sleep(1000);\n        }\n    }\n}\n</code></pre>\n<hr>\n<h2 id=\"btrace测试\">Btrace测试</h2>\n<p><strong>运行上诉测试用例</strong></p>\n<p><strong>jvisualvm中找到对应的进程id--&gt;Trace application...--&gt;分别进行相应的测试</strong></p>\n<h3 id=\"获取add方法参数值和返回值\">获取add()方法参数值和返回值。</h3>\n<pre><code>/* BTrace Script Template */\nimport com.sun.btrace.annotations.*;\nimport static com.sun.btrace.BTraceUtils.*;\n\n//获取add()方法参数值和返回值。\n@BTrace\npublic class TracingScript {\n    /* put your code here */\n    @OnMethod(\n        clazz=\"com.vmtools.Counter\",\n        method=\"add\",\n        location=@Location(Kind.RETURN)\n    )\n\n    public static void func(\n            int a,\n            @Return int result) {\n        println(\"trace: =======================\");\n        jstack();\n        println(strcat(\"a:\", str(a)));\n        println(strcat(\"result:\", str(result)));\n    }\n}</code></pre>\n<h3 id=\"定时获取counter类的属性值totalcount\">定时获取Counter类的属性值totalCount</h3>\n<pre><code>/* BTrace Script Template */\nimport com.sun.btrace.annotations.*;\nimport static com.sun.btrace.BTraceUtils.*;\n\n//定时获取Counter类的属性值totalCount。\n@BTrace\npublic class TracingScript {\n    private static Object totalCount=0;\n\n    /* put your code here */\n    @OnMethod(\n        clazz=\"com.vmtools.Counter\",\n        method=\"add\",\n        location=@Location(Kind.RETURN)\n    )\n    public static void func(@Self com.vmtools.Counter counter) {\n        totalCount = get(field(\"com.vmtools.Counter\", \"totalCount\"), counter);\n    }\n\n    @OnTimer(2000)\n    public static void print(){\n        println(\" ====== \");\n        println(strcat(\"totalCount: \",str(totalCount)));\n    }\n}</code></pre>\n<h3 id=\"获取add方法执行时间\">获取add方法执行时间</h3>\n<pre><code>/* BTrace Script Template */\nimport com.sun.btrace.annotations.*;\nimport static com.sun.btrace.BTraceUtils.*;\n\n//获取add方法执行时间\n@BTrace\npublic class TracingScript {\n    @TLS private static long startTime = 0;\n\n    /* put your code here */\n    @OnMethod(\n        clazz=\"com.vmtools.Counter\",\n        method=\"add\"\n    )\n    public static void func(@Self com.vmtools.Counter counter) {\n        startTime = timeNanos();\n    }\n\n    @OnMethod(\n        clazz=\"com.vmtools.Counter\",\n        method=\"add\",\n        location=@Location(Kind.RETURN)\n    )\n    public static void endExecute(@Duration long duration){  \n     long time = timeNanos() - startTime;  \n     println(strcat(\"execute time(nanos): \", str(time)));  \n     println(strcat(\"duration(nanos): \", str(duration)));  \n   }   \n}</code></pre>\n<p>参考文档：</p>\n<blockquote>\n<ul>\n<li><a href=\"http://www.jianshu.com/p/dbb3a8b5c92f\" class=\"uri\">http://www.jianshu.com/p/dbb3a8b5c92f</a></li>\n<li><a href=\"http://www.cnblogs.com/langtianya/p/4444025.html\" class=\"uri\">http://www.cnblogs.com/langtianya/p/4444025.html</a></li>\n</ul>\n</blockquote>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-01-04 12:40</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=6248210\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(6248210);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=6248210,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2017/1/4 12:40:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/6248210.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=2", "desc": "摘要: 在生产环境中经常遇到格式各样的问题，如OOM或者莫名其妙的进程死掉。一般情况下是通过修改程序，添加打印日志；然后重新发布程序来完成。然而，这不仅麻烦，而且带来很多不可控的因素。有没有一种方式，在不修改原有运行程序的情况下获取运行时的数据信息呢？如方法参数、返回值、全局变量、堆栈信息等。Btrace就"}
{"title": "Mybatis oracle多表联合查询分页数据重复的问题", "content": "Mybatis oracle多表联合查询分页数据重复的问题\n多表联合查询分页获取数据时出现一个诡异的现象；数据总条数正确，但有些记录多了，有些记录却又少了甚至没了。针对这个问题找了好久，最后发现是由于多个排序字段不唯一，同样的排序顺序每次运行返回的结果顺序不一致，导致这样的现象出现。\nSELECT TEMP_.*\n  FROM (select temp.*, ROWNUM ROWNUM_\n          from (SELECT\n                       t2.ID\n                  FROM tableA t, tableB t2\n                 WHERE t.ID = t2.AID\n                   and t2.STATUS != '001'\n                 ORDER BY t.CREATE_TIME DESC, t2.MIN_VALUE ASC) temp\n         where ROWNUM <= 10) TEMP_\n WHERE ROWNUM_ > 0\n增加排序的唯一性，修改为\nSELECT TEMP_.*\n  FROM (select temp.*, ROWNUM ROWNUM_\n          from (SELECT\n                       t2.ID\n                  FROM tableA t, tableB t2\n                 WHERE t.ID = t2.AID\n                   and t2.STATUS != '001'\n                 ORDER BY t.CREATE_TIME DESC, t2.MIN_VALUE ASC, t2.ID) temp\n         where ROWNUM <= 10) TEMP_\n WHERE ROWNUM_ > 0\n", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>Mybatis oracle多表联合查询分页数据重复的问题 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/6287830.html\">Mybatis oracle多表联合查询分页数据重复的问题</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><p>Mybatis oracle多表联合查询分页数据重复的问题</p>\n<p>多表联合查询分页获取数据时出现一个诡异的现象；数据总条数正确，但有些记录多了，有些记录却又少了甚至没了。针对这个问题找了好久，最后发现是由于多个排序字段不唯一，同样的排序顺序每次运行返回的结果顺序不一致，导致这样的现象出现。</p>\n<pre><code>SELECT TEMP_.*\n  FROM (select temp.*, ROWNUM ROWNUM_\n          from (SELECT\n                       t2.ID\n                  FROM tableA t, tableB t2\n                 WHERE t.ID = t2.AID\n                   and t2.STATUS != '001'\n                 ORDER BY t.CREATE_TIME DESC, t2.MIN_VALUE ASC) temp\n         where ROWNUM &lt;= 10) TEMP_\n WHERE ROWNUM_ &gt; 0</code></pre>\n<p>增加排序的唯一性，修改为</p>\n<pre><code>SELECT TEMP_.*\n  FROM (select temp.*, ROWNUM ROWNUM_\n          from (SELECT\n                       t2.ID\n                  FROM tableA t, tableB t2\n                 WHERE t.ID = t2.AID\n                   and t2.STATUS != '001'\n                 ORDER BY t.CREATE_TIME DESC, t2.MIN_VALUE ASC, t2.ID) temp\n         where ROWNUM &lt;= 10) TEMP_\n WHERE ROWNUM_ &gt; 0</code></pre>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-01-15 20:48</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=6287830\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(6287830);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=6287830,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2017/1/15 20:48:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/6287830.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=2", "desc": "摘要: Mybatis oracle多表联合查询分页数据重复的问题 多表联合查询分页获取数据时出现一个诡异的现象；数据总条数正确，但有些记录多了，有些记录却又少了甚至没了。针对这个问题找了好久，最后发现是由于多个排序字段不唯一，同样的排序顺序每次运行返回的结果顺序不一致，导致这样的现象出现。 增加排序的唯一"}
{"title": "ORA-01502: index 'INDEX_NAME' or partition of such index is in unusable state", "content": "ORA-01502: index 'INDEX_NAME' or partition of such index is in unusable state\n原因：\n　　这个错误一般是因为索引状态为UNUSABLE引起的。你可以通过下面SQL，查看索引的状态\n解决办法：\nSELECT OWNER, INDEX_NAME,STATUS  FROM DBA_INDEXES WHERE INDEX_NAME='INDEX_NAME';\nSELECT OWNER, INDEX_NAME,STATUS  FROM ALL_INDEXES WHERE INDEX_NAME='INDEX_NAME';\nSELECT  INDEX_NAME,STATUS  FROM USER_INDEXES WHERE INDEX_NAME='INDEX_NAME';\n重建索引即可\nALTER INDEX INDEX_NAME REBUILD\n", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>ORA-01502: index 'INDEX_NAME' or partition of such index is in unusable state - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/6210094.html\">ORA-01502: index 'INDEX_NAME' or partition of such index is in unusable state</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><p>ORA-01502: index 'INDEX_NAME' or partition of such index is in unusable state</p>\n<p>原因：</p>\n<p>　　这个错误一般是因为索引状态为<code>UNUSABLE</code>引起的。你可以通过下面SQL，查看索引的状态</p>\n<p>解决办法：</p>\n<pre><code>SELECT OWNER, INDEX_NAME,STATUS  FROM DBA_INDEXES WHERE INDEX_NAME='INDEX_NAME';\nSELECT OWNER, INDEX_NAME,STATUS  FROM ALL_INDEXES WHERE INDEX_NAME='INDEX_NAME';\nSELECT  INDEX_NAME,STATUS  FROM USER_INDEXES WHERE INDEX_NAME='INDEX_NAME';</code></pre>\n<p>重建索引即可</p>\n<pre><code>ALTER INDEX INDEX_NAME REBUILD</code></pre>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2016-12-22 10:21</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=6210094\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(6210094);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=6210094,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2016/12/22 10:21:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/6210094.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=2", "desc": "摘要: ORA 01502: index 'INDEX_NAME' or partition of such index is in unusable state 原因： 这个错误一般是因为索引状态为 引起的。你可以通过下面SQL，查看索引的状态 解决办法： 重建索引即可"}
{"title": "java并行计算Fork和Join的使用", "content": "Java在JDK7之后加入了并行计算的框架Fork/Join，可以解决我们系统中大数据计算的性能问题。Fork/Join采用的是分治法，Fork是将一个大任务拆分成若干个子任务，子任务分别去计算，而Join是获取到子任务的计算结果，然后合并，这个是递归的过程。子任务被分配到不同的核上执行时，效率最高。\npackage com.thread.forkjoin;\n\nimport java.util.Arrays;\nimport java.util.Random;\nimport java.util.concurrent.ExecutionException;\nimport java.util.concurrent.ForkJoinPool;\nimport java.util.concurrent.RecursiveTask;\n\n/**\n * Java在JDK7之后加入了并行计算的框架Fork/Join，可以解决我们系统中大数据计算的性能问题。\n * Fork/Join采用的是分治法，Fork是将一个大任务拆分成若干个子任务，子任务分别去计算，而Join是获取到子任务的计算结果，然后合并，这个是递归的过程。\n * 子任务被分配到不同的核上执行时，效率最高。\n */\npublic class ForkJoinTest extends RecursiveTask<Long> {\n    private static final int THREADSHOLD = 50000;\n    private long[] array;\n    private int low;\n    private int hight;\n\n    public ForkJoinTest(long[] array, int low, int hight) {\n        this.array = array;\n        this.low = low;\n        this.hight = hight;\n    }\n\n    @Override\n    protected Long compute() {\n        long sum = 0;\n        if (hight - low < THREADSHOLD) {\n            for (int i = low; i < hight; i++) {\n                sum += array[i];\n            }\n        } else {\n            int middle = (low + hight) >>> 1;\n            ForkJoinTest left = new ForkJoinTest(array, low, middle);\n            ForkJoinTest right = new ForkJoinTest(array, middle + 1, hight);\n\n            left.fork();\n            right.fork();\n\n            sum = left.join() + right.join();\n        }\n        return sum;\n    }\n\n    public static void main(String[] args) throws ExecutionException, InterruptedException {\n        long[] array = genArray(1000000);\n        System.out.println(Arrays.toString(array));\n\n        ForkJoinTest forkJoinTest = new ForkJoinTest(array, 0, array.length - 1);\n        long begin = System.currentTimeMillis();\n\n        ForkJoinPool forkJoinPool = new ForkJoinPool();\n        forkJoinPool.submit(forkJoinTest);\n        Long result = forkJoinTest.get();\n\n        long end = System.currentTimeMillis();\n\n        System.out.println(String.format(\"结果 %s 耗时 %sms\", result, end - begin));\n    }\n\n    private static long[] genArray(int size) {\n        long[] array = new long[size];\n        for (int i = 0; i < size; i++) {\n            array[i] = new Random().nextLong();\n        }\n        return array;\n    }\n}\n", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>java并行计算Fork和Join的使用 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/6231542.html\">java并行计算Fork和Join的使用</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><p>Java在JDK7之后加入了并行计算的框架Fork/Join，可以解决我们系统中大数据计算的性能问题。Fork/Join采用的是分治法，Fork是将一个大任务拆分成若干个子任务，子任务分别去计算，而Join是获取到子任务的计算结果，然后合并，这个是递归的过程。子任务被分配到不同的核上执行时，效率最高。</p>\n<pre><code>package com.thread.forkjoin;\n\nimport java.util.Arrays;\nimport java.util.Random;\nimport java.util.concurrent.ExecutionException;\nimport java.util.concurrent.ForkJoinPool;\nimport java.util.concurrent.RecursiveTask;\n\n/**\n * Java在JDK7之后加入了并行计算的框架Fork/Join，可以解决我们系统中大数据计算的性能问题。\n * Fork/Join采用的是分治法，Fork是将一个大任务拆分成若干个子任务，子任务分别去计算，而Join是获取到子任务的计算结果，然后合并，这个是递归的过程。\n * 子任务被分配到不同的核上执行时，效率最高。\n */\npublic class ForkJoinTest extends RecursiveTask&lt;Long&gt; {\n    private static final int THREADSHOLD = 50000;\n    private long[] array;\n    private int low;\n    private int hight;\n\n    public ForkJoinTest(long[] array, int low, int hight) {\n        this.array = array;\n        this.low = low;\n        this.hight = hight;\n    }\n\n    @Override\n    protected Long compute() {\n        long sum = 0;\n        if (hight - low &lt; THREADSHOLD) {\n            for (int i = low; i &lt; hight; i++) {\n                sum += array[i];\n            }\n        } else {\n            int middle = (low + hight) &gt;&gt;&gt; 1;\n            ForkJoinTest left = new ForkJoinTest(array, low, middle);\n            ForkJoinTest right = new ForkJoinTest(array, middle + 1, hight);\n\n            left.fork();\n            right.fork();\n\n            sum = left.join() + right.join();\n        }\n        return sum;\n    }\n\n    public static void main(String[] args) throws ExecutionException, InterruptedException {\n        long[] array = genArray(1000000);\n        System.out.println(Arrays.toString(array));\n\n        ForkJoinTest forkJoinTest = new ForkJoinTest(array, 0, array.length - 1);\n        long begin = System.currentTimeMillis();\n\n        ForkJoinPool forkJoinPool = new ForkJoinPool();\n        forkJoinPool.submit(forkJoinTest);\n        Long result = forkJoinTest.get();\n\n        long end = System.currentTimeMillis();\n\n        System.out.println(String.format(\"结果 %s 耗时 %sms\", result, end - begin));\n    }\n\n    private static long[] genArray(int size) {\n        long[] array = new long[size];\n        for (int i = 0; i &lt; size; i++) {\n            array[i] = new Random().nextLong();\n        }\n        return array;\n    }\n}</code></pre>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2016-12-29 08:37</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=6231542\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(6231542);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=6231542,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2016/12/29 8:37:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/6231542.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=2", "desc": "摘要: Java在JDK7之后加入了并行计算的框架Fork/Join，可以解决我们系统中大数据计算的性能问题。Fork/Join采用的是分治法，Fork是将一个大任务拆分成若干个子任务，子任务分别去计算，而Join是获取到子任务的计算结果，然后合并，这个是递归的过程。子任务被分配到不同的核上执行时，效率最高"}
{"title": "Java内存管理及GC算法", "content": "概述\n内存划分\n虚拟机规范中将内存分为六大部分，分别为PC寄存器、JAVA虚拟机栈、JAVA堆、方法区、运行时常量及本地方法栈。\n1.PC寄存器：线程独占；\n2.JAVA虚拟机栈：线程独有；JAVA虚拟机栈是在创建线程的同时创建的，用于存储栈帧，JAVA虚拟机栈也是线程独有的。\n3.JAVA堆：全局共享；\n4.方法区：全局共享；它主要存储的是\n\n运行时常量池\n字段信息\n方法信息\n构造方法\n普通函数的字节码内容以及一些特殊方法。\n5.本地方法栈：线程独有，本地方法栈是一个传统的栈，它用来支持native方法的执行。如果JAVA虚拟机是使用的其它语言实现指令集解释器的时候，也会用到本地方法栈。\n\n内存管理\n1.一部分是全局共享：\n\nJAVA堆\n方法区\n2.一部分是线程独有\nPC寄存器\nJAVA虚拟机栈\n本地方法栈\n\nGC简介及算法\nGC策略解决了哪些问题？\n内存作为一种有限的资源，然而随着时间的推移内存的垃圾会越来越多。但java并没有提供类似于C/C++这一类内存释放和管理的机制，而是通过内置的GC进行内存的管理。GC的主要工作是：\n1.哪些对象可以被回收？\n2.何时回收？\n3.采用什么样的方式回收？\nGC策略采用的何种算法\n有一种比较简单直观的办法，它的效率较高，被称作引用计数算法。但是这个算法有一个致命的缺陷，那就是对于循环引用的对象无法进行回收。\n根搜索算法(解决哪些对象可以被回收的问题)\n由于引用计数算法的缺陷，所以JVM一般会采用一种新的算法，叫做根搜索算法。它的处理方式就是，设立若干种根对象，当任何一个根对象到某一个对象均不可达时，则认为这个对象是可以被回收的。\nGC roots（GC根），在JAVA语言中，可以当做GC roots的对象有以下几种：\n\n虚拟机栈中的引用的对象。\n方法区中的类静态属性引用的对象。\n方法区中的常量引用的对象。(final)\n本地方法栈中JNI的引用的对象。\n第一和第四种都是指的方法的本地变量表，第二种表达的意思比较清晰，第三种主要指的是声明为final的常量值。\n\n垃圾收集算法\n垃圾搜集的算法主要有三种，分别是标记-清除算法、复制算法、标记-整理算法。这三种算法都扩充了根搜索算法。\n标记-清除算法\n当堆中的有效内存空间（available memory）被耗尽的时候，就会停止整个程序（也被成为stop the world），然后进行两项工作，第一项则是标记，第二项则是清除。\n\n标记：标记的过程其实就是，遍历所有的GC Roots，然后将所有GC Roots可达的对象标记为存活的对象。\n清除：清除的过程将遍历堆中所有的对象，将没有标记的对象全部清除掉。\n\n通俗地说也就是当可用内存即将耗尽时，逐步完成以下工作：\n\n1.GC线程就会被触发并将程序暂停；\n2.将依旧存活的对象标记起来；\n3.将堆中未标记的对象全部清除；\n4.程序恢复运行。\n\n缺陷：\n\n1、首先，它的缺点就是效率比较低（递归与全堆对象遍历），而且在进行GC的时候，需要停止应用程序，这会导致用户体验非常差劲\n2、第二点主要的缺点，则是这种方式清理出来的空闲内存是不连续的\n\n复制算法\n复制算法由“标记-清除算法”基础上演化而来。\n复制算法将内存划分为两个区间，在任意一个时间点，所有动态分配的对象只能分配在其中一个区间（活动区间），而另一个区间（空闲区间）则是空闲的。\n当可用内存即将耗尽时，会逐步完成以下工作：\n\n1.GC线程就会被触发并将程序暂停；\n2.将依旧存活的对象标记起来；\n3.将存活对象全部复制到空闲区间，且严格按照内存地址依次排序；\n4.将存活对象引用指向新地址；\n5.将活动区间转换成空闲区间，并一次性全部回收所有垃圾对象；\n6.程序恢复运行。\n\n复制算法弥补了标记-清除算法中内存布局混乱的缺点，但其缺点也很明显：\n\n浪费了一半的内存，也就是说有一半的内存空间是闲置的；\n如果对象的存活率很高，我们可以极端一点，假设是100%存活，那么我们需要将所有对象都复制一遍，并将所有引用地址重置一遍。复制这一工作所花费的时间，在对象存活率达到一定程度时，将会变的不可忽视。\n\n复制算法要想使用，最起码对象的存活率要非常低才行，而且最重要的是，我们必须要克服50%内存的浪费。\n标记-整理算法\n标记-整理算法和标记-清除算法类似，可以分成两个阶段：标记和整理\n\n1.标记：它的第一个阶段与标记/清除算法是一模一样的，均是遍历GC Roots，然后将存活的对象标记。\n2.整理：移动所有存活的对象，且按照内存地址次序依次排列，然后将末端内存地址以后的内存全部回收。因此，第二阶段才称为整理阶段。\n\n优点：标记/整理算法不仅可以弥补标记/清除算法当中，内存区域分散的缺点，也消除了复制算法当中，内存减半的高额代价\n缺点：标记/整理算法唯一的缺点就是效率也不高\n复制算法、标记/整理算法、标记/清除算法共同点：\n\n1、三个算法都基于根搜索算法去判断一个对象是否应该被回收，而支撑根搜索算法可以正常工作的理论依据，就是语法中变量作用域的相关内容。因此，要想防止内存泄露，最根本的办法就是掌握好变量作用域，而不应该使用前面内存管理杂谈一章中所提到的C/C++式内存管理方式。\n2、在GC线程开启时，或者说GC过程开始时，它们都要暂停应用程序（stop the world）。\n\n区别：\n\n效率：复制算法>标记/整理算法>标记/清除算法（此处的效率只是简单的对比时间复杂度，实际情况不一定如此）。\n内存整齐度：复制算法=标记/整理算法>标记/清除算法。\n内存利用率：标记/整理算法=标记/清除算法>复制算法。\n\n分代搜集算法\n没有最好的算法，只有最合适的算法，不同算法适合不同的场景。\n\n新生代或者年轻代【普通GC（minor GC）】：适合使用复制算法\n年老代【全局GC（major GC or Full GC）】：采用标记/整理或者标记/清除算法\n\n", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>Java内存管理及GC算法 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/6247255.html\">Java内存管理及GC算法</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><h1 id=\"概述\">概述</h1>\n<h2 id=\"内存划分\">内存划分</h2>\n<p>虚拟机规范中将内存分为六大部分，分别为PC寄存器、JAVA虚拟机栈、JAVA堆、方法区、运行时常量及本地方法栈。</p>\n<p>1.PC寄存器：<code>线程独占</code>；<br>\n2.JAVA虚拟机栈：<code>线程独有</code>；JAVA虚拟机栈是在创建线程的同时创建的，用于存储栈帧，JAVA虚拟机栈也是线程独有的。<br>\n3.JAVA堆：<code>全局共享</code>；<br>\n4.方法区：<code>全局共享</code>；它主要存储的是</p>\n<ul>\n<li><code>运行时常量池</code></li>\n<li><code>字段信息</code></li>\n<li><code>方法信息</code></li>\n<li><code>构造方法</code></li>\n<li><code>普通函数</code>的字节码内容以及一些特殊方法。<br>\n5.本地方法栈：<code>线程独有</code>，本地方法栈是一个传统的栈，它用来支持native方法的执行。如果JAVA虚拟机是使用的其它语言实现指令集解释器的时候，也会用到本地方法栈。</li>\n</ul>\n<h2 id=\"内存管理\">内存管理</h2>\n<p>1.一部分是全局共享：</p>\n<ul>\n<li>JAVA堆</li>\n<li>方法区<br>\n2.一部分是线程独有</li>\n<li>PC寄存器</li>\n<li>JAVA虚拟机栈</li>\n<li>本地方法栈</li>\n</ul>\n<h1 id=\"gc简介及算法\">GC简介及算法</h1>\n<h2 id=\"gc策略解决了哪些问题\">GC策略解决了哪些问题？</h2>\n<p>内存作为一种有限的资源，然而随着时间的推移内存的垃圾会越来越多。但java并没有提供类似于C/C++这一类内存释放和管理的机制，而是通过内置的GC进行内存的管理。GC的主要工作是：</p>\n<p>1.哪些对象可以被回收？<br>\n2.何时回收？<br>\n3.采用什么样的方式回收？</p>\n<h2 id=\"gc策略采用的何种算法\">GC策略采用的何种算法</h2>\n<p>有一种比较简单直观的办法，它的效率较高，被称作<code>引用计数算法</code>。但是这个算法有一个致命的缺陷，那就是对于循环引用的对象无法进行回收。</p>\n<h2 id=\"根搜索算法解决哪些对象可以被回收的问题\">根搜索算法(<code>解决哪些对象可以被回收的问题</code>)</h2>\n<p>由于引用计数算法的缺陷，所以JVM一般会采用一种新的算法，叫做<code>根搜索算法</code>。它的处理方式就是，<code>设立若干种根对象</code>，当任何一个根对象到某一个对象均<code>不可达时</code>，则认为这个对象是可以<code>被回收</code>的。</p>\n<p>GC roots（<code>GC根</code>），在JAVA语言中，可以当做GC roots的对象有以下几种：</p>\n<ul>\n<li>虚拟机栈中的引用的对象。</li>\n<li>方法区中的类静态属性引用的对象。</li>\n<li>方法区中的常量引用的对象。(final)</li>\n<li>本地方法栈中JNI的引用的对象。<br>\n第一和第四种都是指的方法的本地变量表，第二种表达的意思比较清晰，第三种主要指的是声明为final的常量值。</li>\n</ul>\n<h2 id=\"垃圾收集算法\">垃圾收集算法</h2>\n<p>垃圾搜集的算法主要有三种，分别是<code>标记-清除算法</code>、<code>复制算法</code>、<code>标记-整理算法</code>。这三种算法都扩充了根搜索算法。</p>\n<h3 id=\"标记-清除算法\">标记-清除算法</h3>\n<p>当堆中的有效内存空间（available memory）被耗尽的时候，就会停止整个程序（也被成为stop the world），然后进行两项工作，<code>第一项则是标记</code>，<code>第二项则是清除</code>。</p>\n<ul>\n<li>标记：标记的过程其实就是，遍历所有的GC Roots，然后将所有GC Roots可达的对象标记为存活的对象。</li>\n<li>清除：清除的过程将遍历堆中所有的对象，将没有标记的对象全部清除掉。</li>\n</ul>\n<p>通俗地说也就是当可用内存即将耗尽时，逐步完成以下工作：</p>\n<ul>\n<li>1.GC线程就会被触发并将程序暂停；</li>\n<li>2.将依旧存活的对象标记起来；</li>\n<li>3.将堆中未标记的对象全部清除；</li>\n<li>4.程序恢复运行。</li>\n</ul>\n<p><strong>缺陷：</strong></p>\n<ul>\n<li>1、首先，它的缺点就是效率比较低（递归与全堆对象遍历），而且在进行GC的时候，需要停止应用程序，这会导致用户体验非常差劲</li>\n<li>2、第二点主要的缺点，则是这种方式清理出来的空闲内存是不连续的</li>\n</ul>\n<h3 id=\"复制算法\">复制算法</h3>\n<p>复制算法由“<code>标记-清除算法</code>”基础上演化而来。</p>\n<p>复制算法将内存划分为两个区间，在任意一个时间点，所有动态分配的对象只能分配在其中一个区间（活动区间），而另一个区间（空闲区间）则是空闲的。</p>\n<p>当可用内存即将耗尽时，会逐步完成以下工作：</p>\n<ul>\n<li>1.GC线程就会被触发并将程序暂停；</li>\n<li>2.将依旧存活的对象标记起来；</li>\n<li>3.将存活对象全部复制到空闲区间，且严格按照内存地址依次排序；</li>\n<li>4.将存活对象引用指向新地址；</li>\n<li>5.将活动区间转换成空闲区间，并一次性全部回收所有垃圾对象；</li>\n<li>6.程序恢复运行。</li>\n</ul>\n<p><code>复制算法</code>弥补了<code>标记-清除算法</code>中内存布局混乱的缺点，但其缺点也很明显：</p>\n<ul>\n<li>浪费了一半的内存，也就是说有一半的内存空间是闲置的；</li>\n<li>如果对象的存活率很高，我们可以极端一点，假设是100%存活，那么我们需要将所有对象都复制一遍，并将所有引用地址重置一遍。<code>复制这一工作所花费的时间，在对象存活率达到一定程度时，将会变的不可忽视。</code></li>\n</ul>\n<p><strong>复制算法要想使用，最起码对象的存活率要非常低才行，而且最重要的是，我们必须要克服50%内存的浪费。</strong></p>\n<h3 id=\"标记-整理算法\">标记-整理算法</h3>\n<p><code>标记-整理算法</code>和<code>标记-清除算法</code>类似，可以分成两个阶段：标记和整理</p>\n<ul>\n<li>1.标记：它的第一个阶段与标记/清除算法是一模一样的，均是遍历GC Roots，然后将存活的对象标记。</li>\n<li>2.整理：移动所有存活的对象，且按照内存地址次序依次排列，然后将末端内存地址以后的内存全部回收。因此，第二阶段才称为整理阶段。</li>\n</ul>\n<p>优点：<code>标记/整理算法不仅可以弥补标记/清除算法当中，内存区域分散的缺点，也消除了复制算法当中，内存减半的高额代价</code><br>\n缺点：<code>标记/整理算法唯一的缺点就是效率也不高</code></p>\n<p>复制算法、标记/整理算法、标记/清除算法共同点：</p>\n<ul>\n<li>1、三个算法都基于根搜索算法去判断一个对象是否应该被回收，而支撑根搜索算法可以正常工作的理论依据，就是语法中变量作用域的相关内容。因此，要想防止内存泄露，最根本的办法就是掌握好变量作用域，而不应该使用前面内存管理杂谈一章中所提到的C/C++式内存管理方式。</li>\n<li>2、在GC线程开启时，或者说GC过程开始时，它们都要暂停应用程序（stop the world）。</li>\n</ul>\n<p>区别：</p>\n<ul>\n<li>效率：复制算法&gt;标记/整理算法&gt;标记/清除算法（此处的效率只是简单的对比时间复杂度，实际情况不一定如此）。</li>\n<li>内存整齐度：复制算法=标记/整理算法&gt;标记/清除算法。</li>\n<li>内存利用率：标记/整理算法=标记/清除算法&gt;复制算法。</li>\n</ul>\n<h3 id=\"分代搜集算法\">分代搜集算法</h3>\n<p>没有最好的算法，只有最合适的算法，不同算法适合不同的场景。</p>\n<ul>\n<li>新生代或者年轻代【普通GC（minor GC）】：<code>适合使用复制算法</code></li>\n<li>年老代【全局GC（major GC or Full GC）】：<code>采用标记/整理</code>或者<code>标记/清除算法</code></li>\n</ul>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2017-01-04 08:24</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=6247255\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(6247255);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=6247255,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2017/1/4 8:24:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/6247255.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=2", "desc": "摘要: 概述 内存划分 虚拟机规范中将内存分为六大部分，分别为PC寄存器、JAVA虚拟机栈、JAVA堆、方法区、运行时常量及本地方法栈。 1.PC寄存器： ； 2.JAVA虚拟机栈： ；JAVA虚拟机栈是在创建线程的同时创建的，用于存储栈帧，JAVA虚拟机栈也是线程独有的。 3.JAVA堆： ； 4.方法区"}
{"title": "线程池及并发编程基础总结", "content": "常用线程池\n可重用固定线程集合的线程池，以共享的无界队列方式来运行这些线程\nExecutorService threadPool = Executors.newFixedThreadPool(3);// 创建可以容纳3个线程的线程池\n根据需要创建新线程的线程池，但是在以前构造的线程可用时将重用它们\nExecutorService threadPool = Executors.newCachedThreadPool();// 线程池的大小会根据执行的任务数动态分配\n使用单个 worker 线程的 Executor，以无界队列方式来运行该线程\nExecutorService threadPool = Executors.newSingleThreadExecutor();// 创建单个线程的线程池，如果当前线程在执行任务时突然中断，则会创建一个新的线程替代它继续执行任务\n可安排在给定延迟后运行命令或者定期地执行的线程池\nScheduledExecutorService threadPool = Executors.newScheduledThreadPool(3);// 效果类似于Timer定时器\nJVM内部同步机制和JVM外部同步机制\n内部同步机制\n\n\nstatic的强制同步机制\nsynchronized的同步机制：可以使用this、类字面常亮、特有锁对象（专门为加锁使用，无实际意义的对象，此种方式效率更高。）\n\n\n外部同步机制\nReentrantLock（可重入的锁）\n\n\nsynchronized关键字同步的时候，等待的线程将无法控制，只能死等。\n\n\n解决方式：ReentrantLock可以使用tryLock(timeout, unit)方法去控制等待获得锁的时间，也可以使用无参数的tryLock方法立即返回，这就避免了死锁出现的可能性。\n\n\nsynchronized关键字同步的时候，不保证公平性，因此会有线程插队的现象。\n\n\n解决方式：ReentrantLock可以使用构造方法ReentrantLock(fair)来强制使用公平模式，这样就可以保证线程获得锁的顺序是按照等待的顺序进行的，而synchronized进行同步的时候，是默认非公平模式的，但JVM可以很好的保证线程不被饿死。\nReentrantLock有这样一些优点，当然也有不足的地方。最主要不足的一点，就是ReentrantLock需要开发人员手动释放锁，并且必须在finally块中释放。\nJVM内部条件控制机制和JVM外部条件控制机制\nJVM内部条件控制机制\n在Object中，有一个wait的本地方法；它可以用来协调线程之间的协作。\nwait一般情况下最常用的场景是构造一个花销非常大的对象的时候，比如JDK动态代理在生成代理类的时候就使用了这种方式。JDK6在生成一个代理类之前，会先检测一个是否正在生成中的标识，如果正在生成的话，JDK6就会在对象上等待，直到正在生成的代理类生成完毕，然后直接从缓存中获取。\nwait,notify和notifyAll方法在使用前，必须获取到当前对象的锁，否则会告诉你非法的监控状态异常。还有一点，则是如果有多个线程在wait等待，那么调用notify会随机通知其中一个线程，而不会按照顺序通知。换句话说，notify的通知机制是非公平的，notify并不保证先调用wait方法的线程优先被唤醒。notifyAll方法则不存在这个问题，它将通知所有处于wait等待的线程。\nJVM外部条件控制机制\nJDK的类库中，有这样的一个类Condition，来弥补wait方法本身的不足。\n\n\nwait方法当使用带参数的方法wait(timeout)或者wait(timeout,nanos)时，无法反馈究竟是被唤醒还是到达了等待时间，大部分时候，我们会使用循环（就像上面的例子一样）来检测是否达到了条件。\n\n\n解决方式：Condition可以使用返回值标识是否达到了超时时间。\n\n\n由于wait,notify,notifyAll方法都需要获得当前对象的锁，因此当出现多个条件等待时，则需要依次获得多个对象的锁，这是非常恶心麻烦且繁琐的事情。\n\n\n解决方式：Condition之需要获得Lock的锁即可，一个Lock可以拥有多个条件。\nJVM外部 线程协作\nCountDownLatch\n这个类是为了帮助猿友们方便的实现一个这样的场景，就是某一个线程需要等待其它若干个线程完成某件事以后才能继续进行。\nCyclicBarrier\n这个类是为了帮助猿友们方便的实现多个线程一起启动的场景，就像赛跑一样，只要大家都准备好了，那就开始一起冲。比如下面这个程序，所有的线程都准备好了，才会一起开始执行。\nSemaphore\n这个类是为了帮助猿友们方便的实现控制数量的场景，可以是线程数量或者任务数量等等。\nExchanger\n这个类是为了帮助猿友们方便的实现两个线程交换数据的场景，使用起来非常简单。\n参考文档：\n\n\nhttp://blog.csdn.net/ghsau/article/details/7443324\nhttp://www.cnblogs.com/zuoxiaolong/p/con2.html\n\n\n", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>线程池及并发编程基础总结 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/6231538.html\">线程池及并发编程基础总结</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><h2 id=\"常用线程池\">常用线程池</h2>\n<h3 id=\"可重用固定线程集合的线程池以共享的无界队列方式来运行这些线程\">可重用固定线程集合的线程池，以共享的无界队列方式来运行这些线程</h3>\n<pre><code>ExecutorService threadPool = Executors.newFixedThreadPool(3);// 创建可以容纳3个线程的线程池</code></pre>\n<h3 id=\"根据需要创建新线程的线程池但是在以前构造的线程可用时将重用它们\">根据需要创建新线程的线程池，但是在以前构造的线程可用时将重用它们</h3>\n<pre><code>ExecutorService threadPool = Executors.newCachedThreadPool();// 线程池的大小会根据执行的任务数动态分配</code></pre>\n<h3 id=\"使用单个-worker-线程的-executor以无界队列方式来运行该线程\">使用单个 worker 线程的 Executor，以无界队列方式来运行该线程</h3>\n<pre><code>ExecutorService threadPool = Executors.newSingleThreadExecutor();// 创建单个线程的线程池，如果当前线程在执行任务时突然中断，则会创建一个新的线程替代它继续执行任务</code></pre>\n<h3 id=\"可安排在给定延迟后运行命令或者定期地执行的线程池\">可安排在给定延迟后运行命令或者定期地执行的线程池</h3>\n<pre><code>ScheduledExecutorService threadPool = Executors.newScheduledThreadPool(3);// 效果类似于Timer定时器</code></pre>\n<h2 id=\"jvm内部同步机制和jvm外部同步机制\">JVM内部同步机制和JVM外部同步机制</h2>\n<h3 id=\"内部同步机制\">内部同步机制</h3>\n<blockquote>\n<ul>\n<li>static的强制同步机制</li>\n<li>synchronized的同步机制：可以使用this、类字面常亮、特有锁对象（专门为加锁使用，无实际意义的对象，此种方式效率更高。）</li>\n</ul>\n</blockquote>\n<h3 id=\"外部同步机制\">外部同步机制</h3>\n<p>ReentrantLock（可重入的锁）</p>\n<blockquote>\n<ul>\n<li>synchronized关键字同步的时候，等待的线程将无法控制，只能死等。</li>\n</ul>\n</blockquote>\n<p>解决方式：ReentrantLock可以使用tryLock(timeout, unit)方法去控制等待获得锁的时间，也可以使用无参数的tryLock方法立即返回，这就避免了死锁出现的可能性。</p>\n<blockquote>\n<ul>\n<li>synchronized关键字同步的时候，不保证公平性，因此会有线程插队的现象。</li>\n</ul>\n</blockquote>\n<p>解决方式：ReentrantLock可以使用构造方法ReentrantLock(fair)来强制使用公平模式，这样就可以保证线程获得锁的顺序是按照等待的顺序进行的，而synchronized进行同步的时候，是默认非公平模式的，但JVM可以很好的保证线程不被饿死。</p>\n<p><code>ReentrantLock有这样一些优点，当然也有不足的地方。最主要不足的一点，就是ReentrantLock需要开发人员手动释放锁，并且必须在finally块中释放。</code></p>\n<h2 id=\"jvm内部条件控制机制和jvm外部条件控制机制\">JVM内部条件控制机制和JVM外部条件控制机制</h2>\n<h3 id=\"jvm内部条件控制机制\">JVM内部条件控制机制</h3>\n<p>在Object中，有一个wait的本地方法；它可以用来协调线程之间的协作。</p>\n<p>wait一般情况下最常用的场景是构造一个花销非常大的对象的时候，比如JDK动态代理在生成代理类的时候就使用了这种方式。JDK6在生成一个代理类之前，会先检测一个是否正在生成中的标识，如果正在生成的话，JDK6就会在对象上等待，直到正在生成的代理类生成完毕，然后直接从缓存中获取。</p>\n<p>wait,notify和notifyAll方法在使用前，必须获取到当前对象的锁，否则会告诉你非法的监控状态异常。还有一点，则是如果有多个线程在wait等待，那么调用notify会随机通知其中一个线程，而不会按照顺序通知。换句话说，notify的通知机制是非公平的，notify并不保证先调用wait方法的线程优先被唤醒。notifyAll方法则不存在这个问题，它将通知所有处于wait等待的线程。</p>\n<h3 id=\"jvm外部条件控制机制\">JVM外部条件控制机制</h3>\n<p>JDK的类库中，有这样的一个类Condition，来弥补wait方法本身的不足。</p>\n<blockquote>\n<ul>\n<li>wait方法当使用带参数的方法wait(timeout)或者wait(timeout,nanos)时，无法反馈究竟是被唤醒还是到达了等待时间，大部分时候，我们会使用循环（就像上面的例子一样）来检测是否达到了条件。</li>\n</ul>\n</blockquote>\n<p>解决方式：Condition可以使用返回值标识是否达到了超时时间。</p>\n<blockquote>\n<ul>\n<li>由于wait,notify,notifyAll方法都需要获得当前对象的锁，因此当出现多个条件等待时，则需要依次获得多个对象的锁，这是非常恶心麻烦且繁琐的事情。</li>\n</ul>\n</blockquote>\n<p>解决方式：Condition之需要获得Lock的锁即可，一个Lock可以拥有多个条件。</p>\n<h2 id=\"jvm外部-线程协作\">JVM外部 线程协作</h2>\n<h3 id=\"countdownlatch\">CountDownLatch</h3>\n<p>这个类是为了帮助猿友们方便的实现一个这样的场景，就是某一个线程需要等待其它若干个线程完成某件事以后才能继续进行。</p>\n<h3 id=\"cyclicbarrier\">CyclicBarrier</h3>\n<p>这个类是为了帮助猿友们方便的实现多个线程一起启动的场景，就像赛跑一样，只要大家都准备好了，那就开始一起冲。比如下面这个程序，所有的线程都准备好了，才会一起开始执行。</p>\n<h3 id=\"semaphore\">Semaphore</h3>\n<p>这个类是为了帮助猿友们方便的实现控制数量的场景，可以是线程数量或者任务数量等等。</p>\n<h3 id=\"exchanger\">Exchanger</h3>\n<p>这个类是为了帮助猿友们方便的实现两个线程交换数据的场景，使用起来非常简单。</p>\n<p>参考文档：</p>\n<blockquote>\n<ul>\n<li><a href=\"http://blog.csdn.net/ghsau/article/details/7443324\" class=\"uri\">http://blog.csdn.net/ghsau/article/details/7443324</a></li>\n<li><a href=\"http://www.cnblogs.com/zuoxiaolong/p/con2.html\" class=\"uri\">http://www.cnblogs.com/zuoxiaolong/p/con2.html</a></li>\n</ul>\n</blockquote>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2016-12-29 08:29</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=6231538\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(6231538);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=6231538,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2016/12/29 8:29:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/6231538.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=2", "desc": "摘要: 常用线程池 可重用固定线程集合的线程池，以共享的无界队列方式来运行这些线程 根据需要创建新线程的线程池，但是在以前构造的线程可用时将重用它们 使用单个 worker 线程的 Executor，以无界队列方式来运行该线程 可安排在给定延迟后运行命令或者定期地执行的线程池 JVM内部同步机制和JVM外部"}
{"title": "Oracle客户端工具出现“Cannot access NLS data files or invalid environment specified”错误的解决办法", "content": "Oracle客户端工具出现“Cannot access NLS data files or invalid environment specified”错误的解决办法\n方法一：参考，http://blog.csdn.net/longyuhome/article/details/7977433\n方法二：此外也可以在环境变量（我的电脑-->右键属性-->高级系统设置-->环境变量-->系统变量）中添加NLS_LANG=SIMPLIFIED CHINESE_CHINA.ZHS16GBK\n", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>Oracle客户端工具出现“Cannot access NLS data files or invalid environment specified”错误的解决办法 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/6064438.html\">Oracle客户端工具出现“Cannot access NLS data files or invalid environment specified”错误的解决办法</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><p>Oracle客户端工具出现“Cannot access NLS data files or invalid environment specified”错误的解决办法</p>\n<p>方法一：参考，<code>http://blog.csdn.net/longyuhome/article/details/7977433</code></p>\n<p>方法二：此外也可以在环境变量（我的电脑--&gt;右键属性--&gt;高级系统设置--&gt;环境变量--&gt;系统变量）中添加<code>NLS_LANG=SIMPLIFIED CHINESE_CHINA.ZHS16GBK</code></p>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2016-11-15 09:28</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=6064438\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(6064438);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=6064438,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2016/11/15 9:28:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/6064438.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=2", "desc": "摘要: Oracle客户端工具出现“Cannot access NLS data files or invalid environment specified”错误的解决办法 方法一：参考， 方法二：此外也可以在环境变量（我的电脑 右键属性 高级系统设置 环境变量 系统变量）中添加`NLS_LANG=SIM"}
{"title": "lombok 简化java代码注解", "content": "lombok 简化java代码注解\n安装lombok插件\n以intellij ide为例\nFile-->Setting-->Plugins-->搜索“lombok plugin”，安装后重启ide\nlombok 注解\nlombok 提供的注解不多，可以参考官方视频的讲解和官方文档。\nLombok 注解在线帮助文档：https://projectlombok.org/features/index.html\n下面介绍几个我常用的 lombok 注解：\n\n\n@Data ：注解在类上；提供类所有属性的 getting 和 setting 方法，此外还提供了equals、canEqual、hashCode、toString 方法\n@Setter：注解在属性上；为属性提供 setting 方法\n@Getter：注解在属性上；为属性提供 getting 方法\n@Log4j ：注解在类上；为类提供一个 属性名为log 的 log4j 日志对象\n@NoArgsConstructor：注解在类上；为类提供一个无参的构造方法\n@AllArgsConstructor：注解在类上；为类提供一个全参的构造方法\n@NonNull：注解在参数上，可以省略重复的 if( null == persion)这类异常处理\n@Cleanup：注解在输入输出流等需要释放资源的变量上，不需要写额外繁琐而重复的释放资源代码\n\n\n不使用lombok\nimport java.io.*;\n\npublic class CleanupExample {\n  public static void main(String[] args) throws IOException {\n    InputStream in = new FileInputStream(args[0]);\n    try {\n      OutputStream out = new FileOutputStream(args[1]);\n      try {\n        byte[] b = new byte[10000];\n        while (true) {\n          int r = in.read(b);\n          if (r == -1) break;\n          out.write(b, 0, r);\n        }\n      } finally {\n        if (out != null) {\n          out.close();\n        }\n      }\n    } finally {\n      if (in != null) {\n        in.close();\n      }\n    }\n  }\n}\n使用lombok\nimport lombok.Cleanup;\nimport java.io.*;\n\npublic class CleanupExample {\n  public static void main(String[] args) throws IOException {\n    @Cleanup InputStream in = new FileInputStream(args[0]);\n    @Cleanup OutputStream out = new FileOutputStream(args[1]);\n    byte[] b = new byte[10000];\n    while (true) {\n      int r = in.read(b);\n      if (r == -1) break;\n      out.write(b, 0, r);\n    }\n  }\n}\n\n\nval：最终局部变量，在迭代器循环时刻做简单缩写。\n\n\n不使用lombok\npublic void example2() {\n  final HashMap<Integer, String> map = new HashMap<Integer, String>();\n  map.put(0, \"zero\");\n  map.put(5, \"five\");\n  for (final Map.Entry<Integer, String> entry : map.entrySet()) {\n    System.out.printf(\"%d: %s\\n\", entry.getKey(), entry.getValue());\n  }\n}\n使用lombok\npublic void example2() {\n val map = new HashMap<Integer, String>();\n map.put(0, \"zero\");\n map.put(5, \"five\");\n for (val entry : map.entrySet()) {\n   System.out.printf(\"%d: %s\\n\", entry.getKey(), entry.getValue());\n }\n}\n下面是简单示例\n不使用 lombok 的方案\npublic class Person {\n    private String id;\n    private String name;\n    private String identity;\n    private Logger log = Logger.getLogger(Person.class);\n    public Person() {\n\n    }\n\n    public Person(String id, String name, String identity) {\n        this.id              = id;\n        this.name       = name;\n        this.identity  = identity;\n    }\n\n    public String getId() {\n        return id;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public String getIdentity() {\n        return identity;\n    }\n\n    public void setId(String id) {\n        this.id = id;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public void setIdentity(String identity) {\n        this.identity = identity;\n    }\n}\n使用 lombok 的方案\n@Data\n@Log4j\n@NoArgsConstructor\n@AllArgsConstructor\npublic class Person {\n\n    private String id;\n    private String name;\n    private String identity;\n\n}\n参考文档：\n\n\nhttps://projectlombok.org/features/index.html\nhttp://www.blogjava.net/fancydeepin/archive/2012/07/12/lombok.html\n\n\n", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>lombok 简化java代码注解 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/6077317.html\">lombok 简化java代码注解</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><h1 id=\"lombok-简化java代码注解\">lombok 简化java代码注解</h1>\n<h2 id=\"安装lombok插件\">安装lombok插件</h2>\n<p>以intellij ide为例</p>\n<p>File--&gt;Setting--&gt;Plugins--&gt;搜索“lombok plugin”，安装后重启ide</p>\n<h2 id=\"lombok-注解\">lombok 注解</h2>\n<p>lombok 提供的注解不多，可以参考官方视频的讲解和官方文档。</p>\n<p>Lombok 注解在线帮助文档：<a href=\"https://projectlombok.org/features/index.html\" class=\"uri\">https://projectlombok.org/features/index.html</a></p>\n<p>下面介绍几个我常用的 lombok 注解：</p>\n<blockquote>\n<ul>\n<li><code>@Data</code> ：注解在类上；提供类所有属性的 <code>getting</code> 和 <code>setting</code> 方法，此外还提供了<code>equals</code>、<code>canEqual</code>、<code>hashCode</code>、<code>toString</code> 方法</li>\n<li><code>@Setter</code>：注解在属性上；为属性提供 <code>setting</code> 方法</li>\n<li><code>@Getter</code>：注解在属性上；为属性提供 <code>getting</code> 方法</li>\n<li><code>@Log4j</code> ：注解在类上；为类提供一个 属性名为log 的 <code>log4j</code> 日志对象</li>\n<li><code>@NoArgsConstructor</code>：注解在类上；为类提供一个无参的构造方法</li>\n<li><code>@AllArgsConstructor</code>：注解在类上；为类提供一个全参的构造方法</li>\n<li><code>@NonNull</code>：注解在参数上，可以省略重复的 <code>if( null == persion)</code>这类异常处理</li>\n<li><code>@Cleanup</code>：注解在输入输出流等需要释放资源的变量上，不需要写额外繁琐而重复的释放资源代码</li>\n</ul>\n</blockquote>\n<p>不使用<code>lombok</code></p>\n<pre><code>import java.io.*;\n\npublic class CleanupExample {\n  public static void main(String[] args) throws IOException {\n    InputStream in = new FileInputStream(args[0]);\n    try {\n      OutputStream out = new FileOutputStream(args[1]);\n      try {\n        byte[] b = new byte[10000];\n        while (true) {\n          int r = in.read(b);\n          if (r == -1) break;\n          out.write(b, 0, r);\n        }\n      } finally {\n        if (out != null) {\n          out.close();\n        }\n      }\n    } finally {\n      if (in != null) {\n        in.close();\n      }\n    }\n  }\n}</code></pre>\n<p>使用<code>lombok</code></p>\n<pre><code>import lombok.Cleanup;\nimport java.io.*;\n\npublic class CleanupExample {\n  public static void main(String[] args) throws IOException {\n    @Cleanup InputStream in = new FileInputStream(args[0]);\n    @Cleanup OutputStream out = new FileOutputStream(args[1]);\n    byte[] b = new byte[10000];\n    while (true) {\n      int r = in.read(b);\n      if (r == -1) break;\n      out.write(b, 0, r);\n    }\n  }\n}</code></pre>\n<blockquote>\n<ul>\n<li><code>val</code>：最终局部变量，在迭代器循环时刻做简单缩写。</li>\n</ul>\n</blockquote>\n<p>不使用<code>lombok</code></p>\n<pre><code>public void example2() {\n  final HashMap&lt;Integer, String&gt; map = new HashMap&lt;Integer, String&gt;();\n  map.put(0, \"zero\");\n  map.put(5, \"five\");\n  for (final Map.Entry&lt;Integer, String&gt; entry : map.entrySet()) {\n    System.out.printf(\"%d: %s\\n\", entry.getKey(), entry.getValue());\n  }\n}</code></pre>\n<p>使用<code>lombok</code></p>\n<pre><code>public void example2() {\n val map = new HashMap&lt;Integer, String&gt;();\n map.put(0, \"zero\");\n map.put(5, \"five\");\n for (val entry : map.entrySet()) {\n   System.out.printf(\"%d: %s\\n\", entry.getKey(), entry.getValue());\n }\n}</code></pre>\n<h2 id=\"下面是简单示例\">下面是简单示例</h2>\n<h3 id=\"不使用-lombok-的方案\">不使用 lombok 的方案</h3>\n<pre><code>public class Person {\n    private String id;\n    private String name;\n    private String identity;\n    private Logger log = Logger.getLogger(Person.class);\n    public Person() {\n\n    }\n\n    public Person(String id, String name, String identity) {\n        this.id              = id;\n        this.name       = name;\n        this.identity  = identity;\n    }\n\n    public String getId() {\n        return id;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public String getIdentity() {\n        return identity;\n    }\n\n    public void setId(String id) {\n        this.id = id;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public void setIdentity(String identity) {\n        this.identity = identity;\n    }\n}</code></pre>\n<h3 id=\"使用-lombok-的方案\">使用 lombok 的方案</h3>\n<pre><code>@Data\n@Log4j\n@NoArgsConstructor\n@AllArgsConstructor\npublic class Person {\n\n    private String id;\n    private String name;\n    private String identity;\n\n}</code></pre>\n<p>参考文档：</p>\n<blockquote>\n<ul>\n<li><a href=\"https://projectlombok.org/features/index.html\" class=\"uri\">https://projectlombok.org/features/index.html</a></li>\n<li><a href=\"http://www.blogjava.net/fancydeepin/archive/2012/07/12/lombok.html\" class=\"uri\">http://www.blogjava.net/fancydeepin/archive/2012/07/12/lombok.html</a></li>\n</ul>\n</blockquote>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2016-11-18 12:50</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=6077317\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(6077317);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=6077317,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2016/11/18 12:50:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/6077317.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=2", "desc": "摘要: lombok 简化java代码注解 安装lombok插件 以intellij ide为例 File Setting Plugins 搜索“lombok plugin”，安装后重启ide lombok 注解 lombok 提供的注解不多，可以参考官方视频的讲解和官方文档。 Lombok 注解在线帮助文"}
{"title": "LruCache算法原理及实现", "content": "LruCache算法原理及实现\nLruCache算法原理\nLRU为Least Recently Used的缩写，意思也就是近期最少使用算法。LruCache将LinkedHashMap的顺序设置为LRU顺序来实现LRU缓存，每次调用get并获取到值(也就是从内存缓存中命中)，则将该对象移到链表的尾端。调用put插入新的对象也是存储在链表尾端，这样当内存缓存达到设定的最大值时，将链表头部的对象（近期最少用到的）移除。\n基于LinkedHashMap的LRUCache的实现，关键是重写LinkedHashMap的removeEldestEntry方法，在LinkedHashMap中该方法默认返回false（LRUCache本身未考虑线程安全的问题），这样此映射的行为将类似于正常映射，即永远不能移除最旧的元素。\nLruCache算法实现的思路\n\n\n按从近期访问最少到近期访问最多的顺序（即访问顺序）来保存元素，LinkedHashMap提供了LinkedHashMap(int initialCapacity, float loadFactor, boolean accessOrder)构造函数，该哈希映射的迭代顺序就是最后访问其条目的顺序，这种映射很适合构建LRU缓存。\n\n\n\n\nLinkedHashMap提供了removeEldestEntry(Map.Entry eldest)方法。该方法在每次添加新条目时移除最旧条目，但该方法默认返回false，这样，此映射的行为将类似于正常映射，即永远不能移除最旧的元素。因而需要重写该方法。\n\n\n基于LinkedHashMap的LruCache具体实现\nimport java.util.LinkedHashMap;\nimport java.util.Map;\n\npublic class LruCache<K, V> {\n    private LinkedHashMap<K, V> map;//链表存储对象\n\n    private int cacheSize;//cache大小\n    private int hitCount;//命中次数\n    private int missCount;//未命中次数\n\n    public synchronized final int getCacheSize() {\n        return cacheSize;\n    }\n\n    public synchronized final int getHitCount() {\n        return hitCount;\n    }\n\n    public synchronized final int getMissCount() {\n        return missCount;\n    }\n\n    static final int DEFAULT_CACHE_SIZE = 2;//cache默认大小\n\n    public V put(K key, V value) {\n        return map.put(key, value);\n    }\n\n    public V get(Object key) {\n\n        if (null == key) {\n            throw new NullPointerException(\" key == null \");\n        }\n\n        V val = null;\n        synchronized (this) {\n            val = map.get(key);\n            if (null != val) {\n                hitCount += 1;\n                return val;\n            }\n\n            missCount += 1;\n        }\n\n        return val;\n    }\n\n    public LruCache() {\n        this(DEFAULT_CACHE_SIZE);\n    }\n\n    public LruCache(int cacheSize) {\n        this.cacheSize = cacheSize;\n        int hashTableSize = (int) (Math.ceil(cacheSize / 0.75f) + 1);\n\n        //LruCache算法实现的关键\n\n        //1、按从近期访问最少到近期访问最多的顺序（即访问顺序）来保存元素，那么请使用下面的构造方法构造LinkedHashMap\n        //public LinkedHashMap(int initialCapacity, float loadFactor, boolean accessOrder); //该哈希映射的迭代顺序就是最后访问其条目的顺序，这种映射很适合构建LRU缓存。\n        //2、LinkedHashMap提供了removeEldestEntry(Map.Entry<K,V> eldest)方法。该方法可以提供在每次添加新条目时移除最旧条目的实现程序，默认返回false，这样，此映射的行为将类似于正常映射，即永远不能移除最旧的元素。\n        map = new LinkedHashMap<K, V>(hashTableSize, 0.75f, true){\n            private static final long serialVersionUID = 1L;\n\n            @Override\n            protected boolean removeEldestEntry(Map.Entry<K, V> eldest) {\n                System.out.println(\" ***** size=\" + size() + \" cacheSize=\" + LruCache.this.cacheSize + \" ****\");\n//                return super.removeEldestEntry(eldest);\n                return size() > LruCache.this.cacheSize;\n            }\n        };\n    }\n\n    public static void main(String[] args) {\n\n        LruCache<String, String> lruCache = new LruCache<String, String>(3);\n        lruCache.put(\"1\", \"1\");\n        lruCache.put(\"2\", \"2\");\n        lruCache.put(\"3\", \"3\");\n        lruCache.put(\"4\", \"4\");\n        lruCache.put(\"5\", \"5\");\n\n        System.out.println(\"==========================================================================\");\n        System.out.println(\"hitCount=\" + lruCache.getHitCount() + \" missCount=\" +  lruCache.getMissCount());\n        System.out.println(\"==========================================================================\");\n\n        System.out.println(lruCache.get(\"1\") + \" hitCount=\" + lruCache.getHitCount() + \" missCount=\" +  lruCache.getMissCount());\n        System.out.println(lruCache.get(\"2\") + \" hitCount=\" + lruCache.getHitCount() + \" missCount=\" +  lruCache.getMissCount());\n        System.out.println(lruCache.get(\"3\") + \" hitCount=\" + lruCache.getHitCount() + \" missCount=\" +  lruCache.getMissCount());\n        System.out.println(lruCache.get(\"4\") + \" hitCount=\" + lruCache.getHitCount() + \" missCount=\" +  lruCache.getMissCount());\n        System.out.println(lruCache.get(\"4\") + \" hitCount=\" + lruCache.getHitCount() + \" missCount=\" +  lruCache.getMissCount());\n        System.out.println(lruCache.get(\"4\") + \" hitCount=\" + lruCache.getHitCount() + \" missCount=\" +  lruCache.getMissCount());\n        System.out.println(lruCache.get(\"4\") + \" hitCount=\" + lruCache.getHitCount() + \" missCount=\" +  lruCache.getMissCount());\n        lruCache.put(\"6\", \"6\");\n        lruCache.put(\"7\", \"7\");\n        System.out.println(lruCache.get(\"4\") + \" hitCount=\" + lruCache.getHitCount() + \" missCount=\" + lruCache.getMissCount());\n        lruCache.put(\"8\", \"8\");\n\n        System.out.println(lruCache.get(\"5\") + \" hitCount=\" + lruCache.getHitCount() + \" missCount=\" +  lruCache.getMissCount());\n\n        System.out.println(\"==========================================================================\");\n        for(Map.Entry<String, String> entry : lruCache.map.entrySet()) {\n            System.out.println(entry.getKey()+\":\"+entry.getValue());\n        }\n\n    }\n}\n执行结果\n***** size=1 cacheSize=3 ****\n***** size=2 cacheSize=3 ****\n***** size=3 cacheSize=3 ****\n***** size=4 cacheSize=3 ****\n***** size=4 cacheSize=3 ****\n==========================================================================\nhitCount=0 missCount=0\n==========================================================================\nnull hitCount=0 missCount=1\nnull hitCount=0 missCount=2\n3 hitCount=1 missCount=2\n4 hitCount=2 missCount=2\n4 hitCount=3 missCount=2\n4 hitCount=4 missCount=2\n4 hitCount=5 missCount=2\n***** size=4 cacheSize=3 ****\n***** size=4 cacheSize=3 ****\n4 hitCount=6 missCount=2\n***** size=4 cacheSize=3 ****\nnull hitCount=6 missCount=3\n==========================================================================\n7:7\n4:4\n8:8\n参考文档：\n\n\nhttp://blog.csdn.net/pingnanlee/article/details/40585941\nhttp://www.cnblogs.com/children/archive/2012/10/02/2710624.html\n\n\n", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>LruCache算法原理及实现 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/6093198.html\">LruCache算法原理及实现</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><h1 id=\"lrucache算法原理及实现\">LruCache算法原理及实现</h1>\n<h2 id=\"lrucache算法原理\">LruCache算法原理</h2>\n<p><code>LRU</code>为<code>Least Recently Used</code>的缩写，意思也就是近期最少使用算法。<code>LruCache</code>将<code>LinkedHashMap</code>的顺序设置为LRU顺序来实现LRU缓存，每次调用<code>get</code>并获取到值(也就是从内存缓存中命中)，则将该对象<code>移到链表的尾端</code>。调用<code>put</code>插入新的对象也是存储在<code>链表尾端</code>，这样当内存缓存达到设定的最大值时，将<code>链表头部的对象</code>（近期最少用到的）移除。</p>\n<p>基于<code>LinkedHashMap</code>的<code>LRUCache</code>的实现，关键是重写<code>LinkedHashMap</code>的<code>removeEldestEntry</code>方法，在<code>LinkedHashMap</code>中该方法默认返回<code>false</code>（LRUCache本身未考虑线程安全的问题），这样此映射的行为将类似于正常映射，即永远不能移除最旧的元素。</p>\n<h2 id=\"lrucache算法实现的思路\">LruCache算法实现的思路</h2>\n<blockquote>\n<ul>\n<li>按从近期访问最少到近期访问最多的顺序（即访问顺序）来保存元素，LinkedHashMap提供了LinkedHashMap(int initialCapacity, float loadFactor, boolean accessOrder)构造函数，该哈希映射的迭代顺序就是最后访问其条目的顺序，这种映射很适合构建LRU缓存。</li>\n</ul>\n</blockquote>\n<blockquote>\n<ul>\n<li>LinkedHashMap提供了removeEldestEntry(Map.Entry<k> eldest)方法。该方法在每次添加新条目时移除最旧条目，但该方法默认返回false，这样，此映射的行为将类似于正常映射，即永远不能移除最旧的元素。因而需要重写该方法。</k></li>\n</ul>\n</blockquote>\n<h2 id=\"基于linkedhashmap的lrucache具体实现\">基于LinkedHashMap的LruCache具体实现</h2>\n<pre><code>import java.util.LinkedHashMap;\nimport java.util.Map;\n\npublic class LruCache&lt;K, V&gt; {\n    private LinkedHashMap&lt;K, V&gt; map;//链表存储对象\n\n    private int cacheSize;//cache大小\n    private int hitCount;//命中次数\n    private int missCount;//未命中次数\n\n    public synchronized final int getCacheSize() {\n        return cacheSize;\n    }\n\n    public synchronized final int getHitCount() {\n        return hitCount;\n    }\n\n    public synchronized final int getMissCount() {\n        return missCount;\n    }\n\n    static final int DEFAULT_CACHE_SIZE = 2;//cache默认大小\n\n    public V put(K key, V value) {\n        return map.put(key, value);\n    }\n\n    public V get(Object key) {\n\n        if (null == key) {\n            throw new NullPointerException(\" key == null \");\n        }\n\n        V val = null;\n        synchronized (this) {\n            val = map.get(key);\n            if (null != val) {\n                hitCount += 1;\n                return val;\n            }\n\n            missCount += 1;\n        }\n\n        return val;\n    }\n\n    public LruCache() {\n        this(DEFAULT_CACHE_SIZE);\n    }\n\n    public LruCache(int cacheSize) {\n        this.cacheSize = cacheSize;\n        int hashTableSize = (int) (Math.ceil(cacheSize / 0.75f) + 1);\n\n        //LruCache算法实现的关键\n\n        //1、按从近期访问最少到近期访问最多的顺序（即访问顺序）来保存元素，那么请使用下面的构造方法构造LinkedHashMap\n        //public LinkedHashMap(int initialCapacity, float loadFactor, boolean accessOrder); //该哈希映射的迭代顺序就是最后访问其条目的顺序，这种映射很适合构建LRU缓存。\n        //2、LinkedHashMap提供了removeEldestEntry(Map.Entry&lt;K,V&gt; eldest)方法。该方法可以提供在每次添加新条目时移除最旧条目的实现程序，默认返回false，这样，此映射的行为将类似于正常映射，即永远不能移除最旧的元素。\n        map = new LinkedHashMap&lt;K, V&gt;(hashTableSize, 0.75f, true){\n            private static final long serialVersionUID = 1L;\n\n            @Override\n            protected boolean removeEldestEntry(Map.Entry&lt;K, V&gt; eldest) {\n                System.out.println(\" ***** size=\" + size() + \" cacheSize=\" + LruCache.this.cacheSize + \" ****\");\n//                return super.removeEldestEntry(eldest);\n                return size() &gt; LruCache.this.cacheSize;\n            }\n        };\n    }\n\n    public static void main(String[] args) {\n\n        LruCache&lt;String, String&gt; lruCache = new LruCache&lt;String, String&gt;(3);\n        lruCache.put(\"1\", \"1\");\n        lruCache.put(\"2\", \"2\");\n        lruCache.put(\"3\", \"3\");\n        lruCache.put(\"4\", \"4\");\n        lruCache.put(\"5\", \"5\");\n\n        System.out.println(\"==========================================================================\");\n        System.out.println(\"hitCount=\" + lruCache.getHitCount() + \" missCount=\" +  lruCache.getMissCount());\n        System.out.println(\"==========================================================================\");\n\n        System.out.println(lruCache.get(\"1\") + \" hitCount=\" + lruCache.getHitCount() + \" missCount=\" +  lruCache.getMissCount());\n        System.out.println(lruCache.get(\"2\") + \" hitCount=\" + lruCache.getHitCount() + \" missCount=\" +  lruCache.getMissCount());\n        System.out.println(lruCache.get(\"3\") + \" hitCount=\" + lruCache.getHitCount() + \" missCount=\" +  lruCache.getMissCount());\n        System.out.println(lruCache.get(\"4\") + \" hitCount=\" + lruCache.getHitCount() + \" missCount=\" +  lruCache.getMissCount());\n        System.out.println(lruCache.get(\"4\") + \" hitCount=\" + lruCache.getHitCount() + \" missCount=\" +  lruCache.getMissCount());\n        System.out.println(lruCache.get(\"4\") + \" hitCount=\" + lruCache.getHitCount() + \" missCount=\" +  lruCache.getMissCount());\n        System.out.println(lruCache.get(\"4\") + \" hitCount=\" + lruCache.getHitCount() + \" missCount=\" +  lruCache.getMissCount());\n        lruCache.put(\"6\", \"6\");\n        lruCache.put(\"7\", \"7\");\n        System.out.println(lruCache.get(\"4\") + \" hitCount=\" + lruCache.getHitCount() + \" missCount=\" + lruCache.getMissCount());\n        lruCache.put(\"8\", \"8\");\n\n        System.out.println(lruCache.get(\"5\") + \" hitCount=\" + lruCache.getHitCount() + \" missCount=\" +  lruCache.getMissCount());\n\n        System.out.println(\"==========================================================================\");\n        for(Map.Entry&lt;String, String&gt; entry : lruCache.map.entrySet()) {\n            System.out.println(entry.getKey()+\":\"+entry.getValue());\n        }\n\n    }\n}</code></pre>\n<h2 id=\"执行结果\">执行结果</h2>\n<pre><code>***** size=1 cacheSize=3 ****\n***** size=2 cacheSize=3 ****\n***** size=3 cacheSize=3 ****\n***** size=4 cacheSize=3 ****\n***** size=4 cacheSize=3 ****\n==========================================================================\nhitCount=0 missCount=0\n==========================================================================\nnull hitCount=0 missCount=1\nnull hitCount=0 missCount=2\n3 hitCount=1 missCount=2\n4 hitCount=2 missCount=2\n4 hitCount=3 missCount=2\n4 hitCount=4 missCount=2\n4 hitCount=5 missCount=2\n***** size=4 cacheSize=3 ****\n***** size=4 cacheSize=3 ****\n4 hitCount=6 missCount=2\n***** size=4 cacheSize=3 ****\nnull hitCount=6 missCount=3\n==========================================================================\n7:7\n4:4\n8:8</code></pre>\n<p>参考文档：</p>\n<blockquote>\n<ul>\n<li><a href=\"http://blog.csdn.net/pingnanlee/article/details/40585941\" class=\"uri\">http://blog.csdn.net/pingnanlee/article/details/40585941</a></li>\n<li><a href=\"http://www.cnblogs.com/children/archive/2012/10/02/2710624.html\" class=\"uri\">http://www.cnblogs.com/children/archive/2012/10/02/2710624.html</a></li>\n</ul>\n</blockquote>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2016-11-23 12:35</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=6093198\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(6093198);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=6093198,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2016/11/23 12:35:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/6093198.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=2", "desc": "摘要: LruCache算法原理及实现 LruCache算法原理 为`Least Recently Used LruCache LinkedHashMap get 移到链表的尾端 put 链表尾端 链表头部的对象`（近期最少用到的）移除。 基于 的`LRUCache LinkedHashMap remove"}
{"title": "Curator Zookeeper分布式锁", "content": "Curator Zookeeper分布式锁\npom.xml中添加如下配置\n<!-- https://mvnrepository.com/artifact/org.apache.curator/curator-recipes -->\n<dependency>\n  <groupId>org.apache.curator</groupId>\n  <artifactId>curator-recipes</artifactId>\n  <version>2.10.0</version>\n</dependency>\nzookeeper配置\n下载zookeeper并解压至D:\\java\\zookeeper-3.4.6：\nhttp://www.eu.apache.org/dist/zookeeper/zookeeper-3.4.6/zookeeper-3.4.6.tar.gz\nzookeeper配置文件：\nzoo-1.cfg\n# The number of milliseconds of each tick\ntickTime=2000\n# The number of ticks that the initial\n# synchronization phase can take\ninitLimit=10\n# The number of ticks that can pass between\n# sending a request and getting an acknowledgement\nsyncLimit=5\n# the directory where the snapshot is stored.\n# do not use /tmp for storage, /tmp here is just\n# example sakes.\ndataDir=D:/java/zookeeper-3.4.6/data/1\n#日志位置\ndataLogDir=D:/java/zookeeper-3.4.6/log/1\n# the port at which the clients will connect\nclientPort=2181\n# the maximum number of client connections.\n# increase this if you need to handle more clients\n#maxClientCnxns=60\n#\n# Be sure to read the maintenance section of the\n# administrator guide before turning on autopurge.\n#\n# http:/zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_maintenance\n#\n# The number of snapshots to retain in dataDir\n#autopurge.snapRetainCount=3\n# Purge task interval in hours\n# Set to \"0\" to disable auto purge feature\n#autopurge.purgeInterval=1\nserver.1=localhost:2887:3887\nserver.2=localhost:2888:3888\nserver.3=localhost:2889:3889\nzoo-2.cfg和zoo-3.cfg修改如下配置并创建相应的目录\n修改clientPort：\nzoo-1.cfg：clientPort=2181\nzoo-2.cfg：clientPort=2182\nzoo-3.cfg：clientPort=2183\n创建目录：\nzoo-1.cfg：D:/java/zookeeper-3.4.6/data/1\nzoo-2.cfg：D:/java/zookeeper-3.4.6/data/2\nzoo-3.cfg：D:/java/zookeeper-3.4.6/data/3\n分别创建文件：myid，内容分别为各自的id：1、2和3\nD:/java/zookeeper-3.4.6/data/1/myid：1\nD:/java/zookeeper-3.4.6/data/2/myid：2\nD:/java/zookeeper-3.4.6/data/3/myid：3\n分别自动各个zookeeper实例\n代码测试\nimport org.apache.curator.RetryPolicy;\nimport org.apache.curator.framework.CuratorFramework;\nimport org.apache.curator.framework.CuratorFrameworkFactory;\nimport org.apache.curator.framework.recipes.locks.InterProcessMutex;\nimport org.apache.curator.retry.ExponentialBackoffRetry;\n\nimport java.util.concurrent.CountDownLatch;\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\nimport java.util.concurrent.TimeUnit;\n\npublic class CuratorLockTest {\n    public static void main(String[] args) throws InterruptedException {\n        CountDownLatch latch = new CountDownLatch(5);\n        String zookeeperConnectionString = \"localhost:2181,localhost:2182,localhost:2183\";\n        RetryPolicy retryPolicy = new ExponentialBackoffRetry(1000, 3);\n        CuratorFramework client = CuratorFrameworkFactory.newClient(\n                zookeeperConnectionString, retryPolicy);\n        client.start();\n        System.out.println(\"客户端启动。。。。\");\n        ExecutorService exec = Executors.newCachedThreadPool();\n        for (int i = 0; i < 5; i++) {\n            exec.submit(new MyLock(\"client\" + i, client, latch));\n        }\n        exec.shutdown();\n        latch.await();\n        System.out.println(\"所有任务执行完毕\");\n        client.close();\n        System.out.println(\"客户端关闭。。。。\");\n    }\n\n    static class MyLock implements Runnable {\n        private String name;\n        private CuratorFramework client;\n        private CountDownLatch latch;\n\n        public MyLock(String name, CuratorFramework client, CountDownLatch latch) {\n            this.name = name;\n            this.client = client;\n            this.latch = latch;\n        }\n\n        public String getName() {\n            return name;\n        }\n\n        public void setName(String name) {\n            this.name = name;\n        }\n\n        public void run() {\n            InterProcessMutex lock = new InterProcessMutex(client, \"/test_group\");\n            try {\n                System.out.println(\"------\" + this.name + \"---------等待获取锁。--------\");\n                if (lock.acquire(120, TimeUnit.SECONDS)) {\n                    try {\n                        System.out.println(\"----------\" + this.name + \"获得资源----------\");\n                        System.out.println(\"----------\" + this.name + \"正在处理资源----------\");\n                        Thread.sleep(10 * 1000);\n                        System.out.println(\"----------\" + this.name + \"资源使用完毕----------\");\n                        latch.countDown();\n                    } finally {\n                        lock.release();\n                        System.out.println(\"----------\" + this.name + \"释放----------\");\n                    }\n                }\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n        }\n    }\n}\n运行结果：\n客户端启动。。。。\n------client1---------等待获取锁。--------\n------client2---------等待获取锁。--------\n------client0---------等待获取锁。--------\n------client4---------等待获取锁。--------\n------client3---------等待获取锁。--------\n----------client1获得资源----------\n----------client1正在处理资源----------\n----------client1资源使用完毕----------\n----------client1释放----------\n----------client3获得资源----------\n----------client3正在处理资源----------\n----------client3资源使用完毕----------\n----------client3释放----------\n----------client0获得资源----------\n----------client0正在处理资源----------\n----------client0资源使用完毕----------\n----------client0释放----------\n----------client4获得资源----------\n----------client4正在处理资源----------\n----------client4资源使用完毕----------\n----------client4释放----------\n----------client2获得资源----------\n----------client2正在处理资源----------\n----------client2资源使用完毕----------\n所有任务执行完毕\n参考文档：\n\n\nhttp://blog.csdn.net/xiao_jun_0820/article/details/19110387\n\n\n", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>Curator Zookeeper分布式锁 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/6112141.html\">Curator Zookeeper分布式锁</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><h1 id=\"curator-zookeeper分布式锁\">Curator Zookeeper分布式锁</h1>\n<h2 id=\"pom.xml中添加如下配置\">pom.xml中添加如下配置</h2>\n<pre><code>&lt;!-- https://mvnrepository.com/artifact/org.apache.curator/curator-recipes --&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;org.apache.curator&lt;/groupId&gt;\n  &lt;artifactId&gt;curator-recipes&lt;/artifactId&gt;\n  &lt;version&gt;2.10.0&lt;/version&gt;\n&lt;/dependency&gt;</code></pre>\n<h2 id=\"zookeeper配置\">zookeeper配置</h2>\n<p>下载zookeeper并解压至<code>D:\\java\\zookeeper-3.4.6</code>：</p>\n<pre><code>http://www.eu.apache.org/dist/zookeeper/zookeeper-3.4.6/zookeeper-3.4.6.tar.gz</code></pre>\n<p>zookeeper配置文件：</p>\n<p><code>zoo-1.cfg</code></p>\n<pre><code># The number of milliseconds of each tick\ntickTime=2000\n# The number of ticks that the initial\n# synchronization phase can take\ninitLimit=10\n# The number of ticks that can pass between\n# sending a request and getting an acknowledgement\nsyncLimit=5\n# the directory where the snapshot is stored.\n# do not use /tmp for storage, /tmp here is just\n# example sakes.\ndataDir=D:/java/zookeeper-3.4.6/data/1\n#日志位置\ndataLogDir=D:/java/zookeeper-3.4.6/log/1\n# the port at which the clients will connect\nclientPort=2181\n# the maximum number of client connections.\n# increase this if you need to handle more clients\n#maxClientCnxns=60\n#\n# Be sure to read the maintenance section of the\n# administrator guide before turning on autopurge.\n#\n# http:/zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_maintenance\n#\n# The number of snapshots to retain in dataDir\n#autopurge.snapRetainCount=3\n# Purge task interval in hours\n# Set to \"0\" to disable auto purge feature\n#autopurge.purgeInterval=1\nserver.1=localhost:2887:3887\nserver.2=localhost:2888:3888\nserver.3=localhost:2889:3889</code></pre>\n<p><code>zoo-2.cfg</code>和<code>zoo-3.cfg</code>修改如下配置并创建相应的目录<br>\n修改clientPort：</p>\n<pre><code>zoo-1.cfg：clientPort=2181\nzoo-2.cfg：clientPort=2182\nzoo-3.cfg：clientPort=2183</code></pre>\n<p>创建目录：</p>\n<pre><code>zoo-1.cfg：D:/java/zookeeper-3.4.6/data/1\nzoo-2.cfg：D:/java/zookeeper-3.4.6/data/2\nzoo-3.cfg：D:/java/zookeeper-3.4.6/data/3</code></pre>\n<p>分别创建文件：<code>myid</code>，内容分别为各自的id：1、2和3</p>\n<pre><code>D:/java/zookeeper-3.4.6/data/1/myid：1\nD:/java/zookeeper-3.4.6/data/2/myid：2\nD:/java/zookeeper-3.4.6/data/3/myid：3</code></pre>\n<p>分别自动各个zookeeper实例</p>\n<h2 id=\"代码测试\">代码测试</h2>\n<pre><code>import org.apache.curator.RetryPolicy;\nimport org.apache.curator.framework.CuratorFramework;\nimport org.apache.curator.framework.CuratorFrameworkFactory;\nimport org.apache.curator.framework.recipes.locks.InterProcessMutex;\nimport org.apache.curator.retry.ExponentialBackoffRetry;\n\nimport java.util.concurrent.CountDownLatch;\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\nimport java.util.concurrent.TimeUnit;\n\npublic class CuratorLockTest {\n    public static void main(String[] args) throws InterruptedException {\n        CountDownLatch latch = new CountDownLatch(5);\n        String zookeeperConnectionString = \"localhost:2181,localhost:2182,localhost:2183\";\n        RetryPolicy retryPolicy = new ExponentialBackoffRetry(1000, 3);\n        CuratorFramework client = CuratorFrameworkFactory.newClient(\n                zookeeperConnectionString, retryPolicy);\n        client.start();\n        System.out.println(\"客户端启动。。。。\");\n        ExecutorService exec = Executors.newCachedThreadPool();\n        for (int i = 0; i &lt; 5; i++) {\n            exec.submit(new MyLock(\"client\" + i, client, latch));\n        }\n        exec.shutdown();\n        latch.await();\n        System.out.println(\"所有任务执行完毕\");\n        client.close();\n        System.out.println(\"客户端关闭。。。。\");\n    }\n\n    static class MyLock implements Runnable {\n        private String name;\n        private CuratorFramework client;\n        private CountDownLatch latch;\n\n        public MyLock(String name, CuratorFramework client, CountDownLatch latch) {\n            this.name = name;\n            this.client = client;\n            this.latch = latch;\n        }\n\n        public String getName() {\n            return name;\n        }\n\n        public void setName(String name) {\n            this.name = name;\n        }\n\n        public void run() {\n            InterProcessMutex lock = new InterProcessMutex(client, \"/test_group\");\n            try {\n                System.out.println(\"------\" + this.name + \"---------等待获取锁。--------\");\n                if (lock.acquire(120, TimeUnit.SECONDS)) {\n                    try {\n                        System.out.println(\"----------\" + this.name + \"获得资源----------\");\n                        System.out.println(\"----------\" + this.name + \"正在处理资源----------\");\n                        Thread.sleep(10 * 1000);\n                        System.out.println(\"----------\" + this.name + \"资源使用完毕----------\");\n                        latch.countDown();\n                    } finally {\n                        lock.release();\n                        System.out.println(\"----------\" + this.name + \"释放----------\");\n                    }\n                }\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n        }\n    }\n}</code></pre>\n<p>运行结果：</p>\n<pre><code>客户端启动。。。。\n------client1---------等待获取锁。--------\n------client2---------等待获取锁。--------\n------client0---------等待获取锁。--------\n------client4---------等待获取锁。--------\n------client3---------等待获取锁。--------\n----------client1获得资源----------\n----------client1正在处理资源----------\n----------client1资源使用完毕----------\n----------client1释放----------\n----------client3获得资源----------\n----------client3正在处理资源----------\n----------client3资源使用完毕----------\n----------client3释放----------\n----------client0获得资源----------\n----------client0正在处理资源----------\n----------client0资源使用完毕----------\n----------client0释放----------\n----------client4获得资源----------\n----------client4正在处理资源----------\n----------client4资源使用完毕----------\n----------client4释放----------\n----------client2获得资源----------\n----------client2正在处理资源----------\n----------client2资源使用完毕----------\n所有任务执行完毕</code></pre>\n<p>参考文档：</p>\n<blockquote>\n<ul>\n<li><a href=\"http://blog.csdn.net/xiao_jun_0820/article/details/19110387\" class=\"uri\">http://blog.csdn.net/xiao_jun_0820/article/details/19110387</a></li>\n</ul>\n</blockquote>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2016-11-29 08:33</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=6112141\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(6112141);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=6112141,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2016/11/29 8:33:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/6112141.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=2", "desc": "摘要: Curator Zookeeper分布式锁 pom.xml中添加如下配置 zookeeper配置 下载zookeeper并解压至 ： zookeeper配置文件： 和`zoo 3.cfg`修改如下配置并创建相应的目录 修改clientPort： 创建目录： 分别创建文件： ，内容分别为各自的id：1"}
{"title": "解决mysql Table ‘xxx’ is marked as crashed and should be repaired的问题。", "content": "解决mysql Table ‘xxx’ is marked as crashed and should be repaired的问题。\n某个表在进行数据插入和更新时突然出现Table ‘xxx’ is marked as crashed and should be repaired这个异常，随后整个表无法查询，表数据全部丢失。\n解决办法：\n切换至mysql bin目录\n./myisamchk -c -r 数据库表MYI文件的路径\n例如：./myisamchk -c -r /home/mysql/var/data/aaaa.MYI\n如果还不行，就-f 强制修复。\n", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>解决mysql Table ‘xxx’ is marked as crashed and should be repaired的问题。 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/6062074.html\">解决mysql Table ‘xxx’ is marked as crashed and should be repaired的问题。</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><h1 id=\"解决mysql-table-xxx-is-marked-as-crashed-and-should-be-repaired的问题\">解决mysql Table ‘xxx’ is marked as crashed and should be repaired的问题。</h1>\n<p>某个表在进行数据插入和更新时突然出现<code>Table ‘xxx’ is marked as crashed and should be repaired</code>这个异常，随后整个表无法查询，表数据全部丢失。</p>\n<p>解决办法：</p>\n<p><strong>切换至mysql <code>bin</code>目录</strong></p>\n<pre><code>./myisamchk -c -r 数据库表MYI文件的路径</code></pre>\n<p>例如：<code>./myisamchk -c -r /home/mysql/var/data/aaaa.MYI</code></p>\n<p>如果还不行，就-f 强制修复。</p>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2016-11-14 15:28</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=6062074\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(6062074);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=6062074,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2016/11/14 15:28:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/6062074.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=2", "desc": "摘要: 解决mysql Table ‘xxx’ is marked as crashed and should be repaired的问题。 某个表在进行数据插入和更新时突然出现 这个异常，随后整个表无法查询，表数据全部丢失。 解决办法： 切换至mysql 目录 例如： 如果还不行，就 f 强制修复。"}
{"title": "Redis 3.0 Cluster集群配置", "content": "Redis 3.0 Cluster集群配置\n安装环境依赖\n安装gcc：yum install gcc\n安装zlib：yum install zib\n安装ruby：yum install ruby\n安装rubygems：yum install rubygems\n安装ruby的redis驱动：gem install redis\n安装redis\n参考：http://www.cnblogs.com/rwxwsblog/p/5285732.html\n修改配置文件\nvi 6379.conf\nport=6379\npidfile /var/run/redis_6379.pid\nlogfile /var/log/redis_6379.log\ndaemonize=yes\ncluster-enabled yes\ncluster-config-file nodes-6379.conf\ncluster-node-timeout 15000\nappendonly yes\ndir /var/lib/redis/6379\n复制相应的配置文件并按上述配置文件修改相应的配置（注意端口和路径）\ncp 6379.conf 6380.conf\ncp 6379.conf 6381.conf\ncp 6379.conf 6382.conf\ncp 6379.conf 6383.conf\ncp 6379.conf 6384.conf\ncp 6379.conf 6385.conf\n依次修改相应的配置文件6380.conf、6381.conf、6382.conf、6383.conf、6384.conf、6385.conf\n如：vi 6380.conf\n批量替换端口:%s/6379/6380/g并保存\n创建数据文件目录\nmkdir -p /var/lib/redis/6380 /var/lib/redis/6381 /var/lib/redis/6382 /var/lib/redis/6383 /var/lib/redis/6384 /var/lib/redis/6385\n创建集群\n\n\n安装并配置完后6379端口的redis实例需要重启，否则会报错\n创建前需要分别启动redis实例\n\n\ncp redis-3.0.7/src/redis-trib.rb /usr/local/bin/\nredis-trib.rb create --replicas 1  127.0.0.1:6379 127.0.0.1:6380 127.0.0.1:6381 127.0.0.1:6382 127.0.0.1:6383 127.0.0.1:6384 127.0.0.1:6385\n创建集群实例及异常情况\n[root@cas ~]# redis-trib.rb create --replicas 1  127.0.0.1:6379 127.0.0.1:6380 127.0.0.1:6381 127.0.0.1:6382 127.0.0.1:6383 127.0.0.1:6384 127.0.0.1:6385\n>>> Creating cluster\n[ERR] Node 127.0.0.1:6379 is not configured as a cluster node.\n[root@cas ~]# ps -ef|grep redis\nroot     22342     1  0 10:29 ?        00:00:03 /usr/local/bin/redis-server *:6379\nroot     22456     1  0 10:51 ?        00:00:00 redis-server *:6380 [cluster]\nroot     22460     1  0 10:51 ?        00:00:00 redis-server *:6381 [cluster]\nroot     22464     1  0 10:52 ?        00:00:00 redis-server *:6382 [cluster]\nroot     22470     1  0 10:52 ?        00:00:00 redis-server *:6383 [cluster]\nroot     22474     1  0 10:52 ?        00:00:00 redis-server *:6384 [cluster]\nroot     22478     1  0 10:52 ?        00:00:00 redis-server *:6385 [cluster]\nroot     23530 22364  0 10:58 pts/1    00:00:00 grep --color=auto redis\n[root@cas ~]# kill 22342\n[root@cas ~]# redis-server /etc/redis/6379.conf \n[root@cas ~]# ps -ef|grep redis\nroot     22456     1  0 10:51 ?        00:00:00 redis-server *:6380 [cluster]\nroot     22460     1  0 10:51 ?        00:00:00 redis-server *:6381 [cluster]\nroot     22464     1  0 10:52 ?        00:00:00 redis-server *:6382 [cluster]\nroot     22470     1  0 10:52 ?        00:00:00 redis-server *:6383 [cluster]\nroot     22474     1  0 10:52 ?        00:00:00 redis-server *:6384 [cluster]\nroot     22478     1  0 10:52 ?        00:00:00 redis-server *:6385 [cluster]\nroot     23534     1  0 10:59 ?        00:00:05 redis-server *:6379 [cluster]\nroot     23532 22364  0 10:59 pts/1    00:00:00 grep --color=auto redis\n[root@cas ~]# redis-trib.rb create --replicas 1  127.0.0.1:6379 127.0.0.1:6380 127.0.0.1:6381 127.0.0.1:6382 127.0.0.1:6383 127.0.0.1:6384 127.0.0.1:6385\n>>> Creating cluster\n>>> Performing hash slots allocation on 7 nodes...\nUsing 3 masters:\n127.0.0.1:6379\n127.0.0.1:6380\n127.0.0.1:6381\nAdding replica 127.0.0.1:6382 to 127.0.0.1:6379\nAdding replica 127.0.0.1:6383 to 127.0.0.1:6380\nAdding replica 127.0.0.1:6384 to 127.0.0.1:6381\nAdding replica 127.0.0.1:6385 to 127.0.0.1:6379\nM: 477a3dad67b2a3ff8bd70e3b3c8a6112eab081e9 127.0.0.1:6379\n   slots:0-5460 (5461 slots) master\nM: c8b630395c21c10edaf7644bd691ec06f73b9403 127.0.0.1:6380\n   slots:5461-10922 (5462 slots) master\nM: 0d9eaa1f846081556ceedf41d92939b9f142b698 127.0.0.1:6381\n   slots:10923-16383 (5461 slots) master\nS: 124283594652936b01287e0c7fda5b9b8b6e15ad 127.0.0.1:6382\n   replicates 477a3dad67b2a3ff8bd70e3b3c8a6112eab081e9\nS: febaa9b89d0589e36bc7fd66d14173042e2158ed 127.0.0.1:6383\n   replicates c8b630395c21c10edaf7644bd691ec06f73b9403\nS: 402c2e5d1f9284b09098f43cd9f14821fc7be8cf 127.0.0.1:6384\n   replicates 0d9eaa1f846081556ceedf41d92939b9f142b698\nS: 51af4cfa2ab1b144cc72058175442ff15808a912 127.0.0.1:6385\n   replicates 477a3dad67b2a3ff8bd70e3b3c8a6112eab081e9\nCan I set the above configuration? (type 'yes' to accept): yes\n>>> Nodes configuration updated\n>>> Assign a different config epoch to each node\n>>> Sending CLUSTER MEET messages to join the cluster\nWaiting for the cluster to join....\n>>> Performing Cluster Check (using node 127.0.0.1:6379)\nM: 477a3dad67b2a3ff8bd70e3b3c8a6112eab081e9 127.0.0.1:6379\n   slots:0-5460 (5461 slots) master\nM: c8b630395c21c10edaf7644bd691ec06f73b9403 127.0.0.1:6380\n   slots:5461-10922 (5462 slots) master\nM: 0d9eaa1f846081556ceedf41d92939b9f142b698 127.0.0.1:6381\n   slots:10923-16383 (5461 slots) master\nM: 124283594652936b01287e0c7fda5b9b8b6e15ad 127.0.0.1:6382\n   slots: (0 slots) master\n   replicates 477a3dad67b2a3ff8bd70e3b3c8a6112eab081e9\nM: febaa9b89d0589e36bc7fd66d14173042e2158ed 127.0.0.1:6383\n   slots: (0 slots) master\n   replicates c8b630395c21c10edaf7644bd691ec06f73b9403\nM: 402c2e5d1f9284b09098f43cd9f14821fc7be8cf 127.0.0.1:6384\n   slots: (0 slots) master\n   replicates 0d9eaa1f846081556ceedf41d92939b9f142b698\nM: 51af4cfa2ab1b144cc72058175442ff15808a912 127.0.0.1:6385\n   slots: (0 slots) master\n   replicates 477a3dad67b2a3ff8bd70e3b3c8a6112eab081e9\n[OK] All nodes agree about slots configuration.\n>>> Check for open slots...\n>>> Check slots coverage...\n[OK] All 16384 slots covered.\n检查redis集群的健康状况\n[root@cas ~]# redis-trib.rb check 127.0.0.1:6379\n>>> Performing Cluster Check (using node 127.0.0.1:6379)\nM: 477a3dad67b2a3ff8bd70e3b3c8a6112eab081e9 127.0.0.1:6379\n   slots:0-5460 (5461 slots) master\n   2 additional replica(s)\nS: 402c2e5d1f9284b09098f43cd9f14821fc7be8cf 127.0.0.1:6384\n   slots: (0 slots) slave\n   replicates 0d9eaa1f846081556ceedf41d92939b9f142b698\nM: c8b630395c21c10edaf7644bd691ec06f73b9403 127.0.0.1:6380\n   slots:5461-10922 (5462 slots) master\n   1 additional replica(s)\nM: 0d9eaa1f846081556ceedf41d92939b9f142b698 127.0.0.1:6381\n   slots:10923-16383 (5461 slots) master\n   1 additional replica(s)\nS: 124283594652936b01287e0c7fda5b9b8b6e15ad 127.0.0.1:6382\n   slots: (0 slots) slave\n   replicates 477a3dad67b2a3ff8bd70e3b3c8a6112eab081e9\nS: febaa9b89d0589e36bc7fd66d14173042e2158ed 127.0.0.1:6383\n   slots: (0 slots) slave\n   replicates c8b630395c21c10edaf7644bd691ec06f73b9403\nS: 51af4cfa2ab1b144cc72058175442ff15808a912 127.0.0.1:6385\n   slots: (0 slots) slave\n   replicates 477a3dad67b2a3ff8bd70e3b3c8a6112eab081e9\n[OK] All nodes agree about slots configuration.\n>>> Check for open slots...\n>>> Check slots coverage...\n[OK] All 16384 slots covered.\n管理cluster\n添加节点\nadd-node的使用方法为new_host:new_port existing_host:existing_port，前面是新添加的节点信息，后面是已存在的节点信息\nredis-trib.rb add-node 192.168.3.61:6379 192.168.3.88:6379\n数据分片及删除节点\n参考：http://blog.sina.com.cn/s/blog_75ad98f30102w6po.html\n参考文档：\n\n\nhttp://blog.sina.com.cn/s/blog_75ad98f30102w6po.html\nhttp://jingyan.baidu.com/article/922554465f7e19851648f4d4.html\nhttp://www.cnblogs.com/wuxl360/p/5920330.html\n\n\n", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>Redis 3.0 Cluster集群配置 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/6030606.html\">Redis 3.0 Cluster集群配置</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\" class=\"cnblogs-markdown\"><h1 id=\"redis-3.0-cluster集群配置\">Redis 3.0 Cluster集群配置</h1>\n<h2 id=\"安装环境依赖\">安装环境依赖</h2>\n<p>安装gcc：yum install gcc<br>\n安装zlib：yum install zib<br>\n安装ruby：yum install ruby<br>\n安装rubygems：yum install rubygems<br>\n安装ruby的redis驱动：gem install redis</p>\n<h2 id=\"安装redis\">安装redis</h2>\n<p>参考：<a href=\"http://www.cnblogs.com/rwxwsblog/p/5285732.html\" class=\"uri\">http://www.cnblogs.com/rwxwsblog/p/5285732.html</a></p>\n<h2 id=\"修改配置文件\">修改配置文件</h2>\n<p><code>vi 6379.conf</code></p>\n<pre><code>port=6379\npidfile /var/run/redis_6379.pid\nlogfile /var/log/redis_6379.log\ndaemonize=yes\ncluster-enabled yes\ncluster-config-file nodes-6379.conf\ncluster-node-timeout 15000\nappendonly yes\ndir /var/lib/redis/6379</code></pre>\n<p><font color=\"red\">复制相应的配置文件并按上述配置文件修改相应的配置（注意端口和路径）</font></p>\n<pre><code>cp 6379.conf 6380.conf\ncp 6379.conf 6381.conf\ncp 6379.conf 6382.conf\ncp 6379.conf 6383.conf\ncp 6379.conf 6384.conf\ncp 6379.conf 6385.conf</code></pre>\n<p>依次修改相应的配置文件<code>6380.conf</code>、<code>6381.conf</code>、<code>6382.conf</code>、<code>6383.conf</code>、<code>6384.conf</code>、<code>6385.conf</code></p>\n<p>如：vi 6380.conf</p>\n<p>批量替换端口<code>:%s/6379/6380/g</code>并保存</p>\n<p>创建数据文件目录</p>\n<p><code>mkdir -p /var/lib/redis/6380 /var/lib/redis/6381 /var/lib/redis/6382 /var/lib/redis/6383 /var/lib/redis/6384 /var/lib/redis/6385</code></p>\n<h2 id=\"创建集群\">创建集群</h2>\n<blockquote>\n<ul>\n<li>安装并配置完后6379端口的redis实例需要重启，否则会报错</li>\n<li>创建前需要分别启动redis实例</li>\n</ul>\n</blockquote>\n<p><code>cp redis-3.0.7/src/redis-trib.rb /usr/local/bin/</code></p>\n<p><code>redis-trib.rb create --replicas 1  127.0.0.1:6379 127.0.0.1:6380 127.0.0.1:6381 127.0.0.1:6382 127.0.0.1:6383 127.0.0.1:6384 127.0.0.1:6385</code></p>\n<p>创建集群实例及异常情况</p>\n<pre><code>[root@cas ~]# redis-trib.rb create --replicas 1  127.0.0.1:6379 127.0.0.1:6380 127.0.0.1:6381 127.0.0.1:6382 127.0.0.1:6383 127.0.0.1:6384 127.0.0.1:6385\n&gt;&gt;&gt; Creating cluster\n[ERR] Node 127.0.0.1:6379 is not configured as a cluster node.\n[root@cas ~]# ps -ef|grep redis\nroot     22342     1  0 10:29 ?        00:00:03 /usr/local/bin/redis-server *:6379\nroot     22456     1  0 10:51 ?        00:00:00 redis-server *:6380 [cluster]\nroot     22460     1  0 10:51 ?        00:00:00 redis-server *:6381 [cluster]\nroot     22464     1  0 10:52 ?        00:00:00 redis-server *:6382 [cluster]\nroot     22470     1  0 10:52 ?        00:00:00 redis-server *:6383 [cluster]\nroot     22474     1  0 10:52 ?        00:00:00 redis-server *:6384 [cluster]\nroot     22478     1  0 10:52 ?        00:00:00 redis-server *:6385 [cluster]\nroot     23530 22364  0 10:58 pts/1    00:00:00 grep --color=auto redis\n[root@cas ~]# kill 22342\n[root@cas ~]# redis-server /etc/redis/6379.conf \n[root@cas ~]# ps -ef|grep redis\nroot     22456     1  0 10:51 ?        00:00:00 redis-server *:6380 [cluster]\nroot     22460     1  0 10:51 ?        00:00:00 redis-server *:6381 [cluster]\nroot     22464     1  0 10:52 ?        00:00:00 redis-server *:6382 [cluster]\nroot     22470     1  0 10:52 ?        00:00:00 redis-server *:6383 [cluster]\nroot     22474     1  0 10:52 ?        00:00:00 redis-server *:6384 [cluster]\nroot     22478     1  0 10:52 ?        00:00:00 redis-server *:6385 [cluster]\nroot     23534     1  0 10:59 ?        00:00:05 redis-server *:6379 [cluster]\nroot     23532 22364  0 10:59 pts/1    00:00:00 grep --color=auto redis\n[root@cas ~]# redis-trib.rb create --replicas 1  127.0.0.1:6379 127.0.0.1:6380 127.0.0.1:6381 127.0.0.1:6382 127.0.0.1:6383 127.0.0.1:6384 127.0.0.1:6385\n&gt;&gt;&gt; Creating cluster\n&gt;&gt;&gt; Performing hash slots allocation on 7 nodes...\nUsing 3 masters:\n127.0.0.1:6379\n127.0.0.1:6380\n127.0.0.1:6381\nAdding replica 127.0.0.1:6382 to 127.0.0.1:6379\nAdding replica 127.0.0.1:6383 to 127.0.0.1:6380\nAdding replica 127.0.0.1:6384 to 127.0.0.1:6381\nAdding replica 127.0.0.1:6385 to 127.0.0.1:6379\nM: 477a3dad67b2a3ff8bd70e3b3c8a6112eab081e9 127.0.0.1:6379\n   slots:0-5460 (5461 slots) master\nM: c8b630395c21c10edaf7644bd691ec06f73b9403 127.0.0.1:6380\n   slots:5461-10922 (5462 slots) master\nM: 0d9eaa1f846081556ceedf41d92939b9f142b698 127.0.0.1:6381\n   slots:10923-16383 (5461 slots) master\nS: 124283594652936b01287e0c7fda5b9b8b6e15ad 127.0.0.1:6382\n   replicates 477a3dad67b2a3ff8bd70e3b3c8a6112eab081e9\nS: febaa9b89d0589e36bc7fd66d14173042e2158ed 127.0.0.1:6383\n   replicates c8b630395c21c10edaf7644bd691ec06f73b9403\nS: 402c2e5d1f9284b09098f43cd9f14821fc7be8cf 127.0.0.1:6384\n   replicates 0d9eaa1f846081556ceedf41d92939b9f142b698\nS: 51af4cfa2ab1b144cc72058175442ff15808a912 127.0.0.1:6385\n   replicates 477a3dad67b2a3ff8bd70e3b3c8a6112eab081e9\nCan I set the above configuration? (type 'yes' to accept): yes\n&gt;&gt;&gt; Nodes configuration updated\n&gt;&gt;&gt; Assign a different config epoch to each node\n&gt;&gt;&gt; Sending CLUSTER MEET messages to join the cluster\nWaiting for the cluster to join....\n&gt;&gt;&gt; Performing Cluster Check (using node 127.0.0.1:6379)\nM: 477a3dad67b2a3ff8bd70e3b3c8a6112eab081e9 127.0.0.1:6379\n   slots:0-5460 (5461 slots) master\nM: c8b630395c21c10edaf7644bd691ec06f73b9403 127.0.0.1:6380\n   slots:5461-10922 (5462 slots) master\nM: 0d9eaa1f846081556ceedf41d92939b9f142b698 127.0.0.1:6381\n   slots:10923-16383 (5461 slots) master\nM: 124283594652936b01287e0c7fda5b9b8b6e15ad 127.0.0.1:6382\n   slots: (0 slots) master\n   replicates 477a3dad67b2a3ff8bd70e3b3c8a6112eab081e9\nM: febaa9b89d0589e36bc7fd66d14173042e2158ed 127.0.0.1:6383\n   slots: (0 slots) master\n   replicates c8b630395c21c10edaf7644bd691ec06f73b9403\nM: 402c2e5d1f9284b09098f43cd9f14821fc7be8cf 127.0.0.1:6384\n   slots: (0 slots) master\n   replicates 0d9eaa1f846081556ceedf41d92939b9f142b698\nM: 51af4cfa2ab1b144cc72058175442ff15808a912 127.0.0.1:6385\n   slots: (0 slots) master\n   replicates 477a3dad67b2a3ff8bd70e3b3c8a6112eab081e9\n[OK] All nodes agree about slots configuration.\n&gt;&gt;&gt; Check for open slots...\n&gt;&gt;&gt; Check slots coverage...\n[OK] All 16384 slots covered.</code></pre>\n<h2 id=\"检查redis集群的健康状况\">检查redis集群的健康状况</h2>\n<pre><code>[root@cas ~]# redis-trib.rb check 127.0.0.1:6379\n&gt;&gt;&gt; Performing Cluster Check (using node 127.0.0.1:6379)\nM: 477a3dad67b2a3ff8bd70e3b3c8a6112eab081e9 127.0.0.1:6379\n   slots:0-5460 (5461 slots) master\n   2 additional replica(s)\nS: 402c2e5d1f9284b09098f43cd9f14821fc7be8cf 127.0.0.1:6384\n   slots: (0 slots) slave\n   replicates 0d9eaa1f846081556ceedf41d92939b9f142b698\nM: c8b630395c21c10edaf7644bd691ec06f73b9403 127.0.0.1:6380\n   slots:5461-10922 (5462 slots) master\n   1 additional replica(s)\nM: 0d9eaa1f846081556ceedf41d92939b9f142b698 127.0.0.1:6381\n   slots:10923-16383 (5461 slots) master\n   1 additional replica(s)\nS: 124283594652936b01287e0c7fda5b9b8b6e15ad 127.0.0.1:6382\n   slots: (0 slots) slave\n   replicates 477a3dad67b2a3ff8bd70e3b3c8a6112eab081e9\nS: febaa9b89d0589e36bc7fd66d14173042e2158ed 127.0.0.1:6383\n   slots: (0 slots) slave\n   replicates c8b630395c21c10edaf7644bd691ec06f73b9403\nS: 51af4cfa2ab1b144cc72058175442ff15808a912 127.0.0.1:6385\n   slots: (0 slots) slave\n   replicates 477a3dad67b2a3ff8bd70e3b3c8a6112eab081e9\n[OK] All nodes agree about slots configuration.\n&gt;&gt;&gt; Check for open slots...\n&gt;&gt;&gt; Check slots coverage...\n[OK] All 16384 slots covered.</code></pre>\n<h2 id=\"管理cluster\">管理cluster</h2>\n<h3 id=\"添加节点\">添加节点</h3>\n<pre><code>add-node的使用方法为new_host:new_port existing_host:existing_port，前面是新添加的节点信息，后面是已存在的节点信息</code></pre>\n<pre><code>redis-trib.rb add-node 192.168.3.61:6379 192.168.3.88:6379</code></pre>\n<h3 id=\"数据分片及删除节点\">数据分片及删除节点</h3>\n<p>参考：<a href=\"http://blog.sina.com.cn/s/blog_75ad98f30102w6po.html\" class=\"uri\">http://blog.sina.com.cn/s/blog_75ad98f30102w6po.html</a></p>\n<p>参考文档：</p>\n<blockquote>\n<ul>\n<li><a href=\"http://blog.sina.com.cn/s/blog_75ad98f30102w6po.html\" class=\"uri\">http://blog.sina.com.cn/s/blog_75ad98f30102w6po.html</a></li>\n<li><a href=\"http://jingyan.baidu.com/article/922554465f7e19851648f4d4.html\" class=\"uri\">http://jingyan.baidu.com/article/922554465f7e19851648f4d4.html</a></li>\n<li><a href=\"http://www.cnblogs.com/wuxl360/p/5920330.html\" class=\"uri\">http://www.cnblogs.com/wuxl360/p/5920330.html</a></li>\n</ul>\n</blockquote>\n</div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2016-11-10 11:39</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=6030606\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(6030606);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script src=\"//common.cnblogs.com/highlight/9.1.0/highlight.min.js?id=20160127\"></script><script>markdown_highlight();</script><script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=6030606,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2016/11/10 11:39:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/6030606.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=2", "desc": "摘要: Redis 3.0 Cluster集群配置 安装环境依赖 安装gcc：yum install gcc 安装zlib：yum install zib 安装ruby：yum install ruby 安装rubygems：yum install rubygems 安装ruby的redis驱动：gem i"}
{"title": "php将对象数组转成普通数组", "content": "　　最近在用ThinkPHP开发一个京东服务市场的应用，然而京东服务市场接口返回的数据是个对象数组。然而需要一个个属性取出来放到数组里面然后再利用ThinkPHP的addAll或者add方法写入数据库。然而每次返回的字段有几十个，每次这么拼接都要崩溃了。果然还是那句话，当你感到无法忍受的时候你就会想办法改变。于是想了下，如果有个函数传个对象数组进去可以自动转成普通数组就好了。因而万能的互联网搜索又来了。百度了一通。。。果然有前辈已经处理过了，在此记录一下。\r\n /**\t * [std_class_object_to_array 将对象转成数组]\t * @param  [stdclass] $stdclassobject [对象]\t * @return [array]                 [数组]\t */\tfunction std_class_object_to_array($stdclassobject)\t{\t    　　$_array = is_object($stdclassobject) ? get_object_vars($stdclassobject) : $stdclassobject;\r\n\t    　　foreach ($_array as $key => $value) {\t        　　　　$value = (is_array($value) || is_object($value)) ? std_class_object_to_array($value) : $value;\t        　　　　$array[$key] = $value;\t    　　}\r\n\t    　　return $array;\t}\r\n就这样，对象数组就优雅地转成了普通的数组。动动脑子，代码量下来了，功能也优雅地就实现了。一举两得，何乐而不为呢？", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>php将对象数组转成普通数组 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4491003.html\">php将对象数组转成普通数组</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>　　最近在用ThinkPHP开发一个京东服务市场的应用，然而京东服务市场接口返回的数据是个对象数组。然而需要一个个属性取出来放到数组里面然后再利用ThinkPHP的addAll或者add方法写入数据库。然而每次返回的字段有几十个，每次这么拼接都要崩溃了。果然还是那句话，当你感到无法忍受的时候你就会想办法改变。于是想了下，如果有个函数传个对象数组进去可以自动转成普通数组就好了。因而万能的互联网搜索又来了。百度了一通。。。果然有前辈已经处理过了，在此记录一下。</p>\r\n<p style=\"margin-left: 30px;\"><span style=\"background-color: #ffff99;\"> /**</span><br><span style=\"background-color: #ffff99;\">\t * [std_class_object_to_array 将对象转成数组]</span><br><span style=\"background-color: #ffff99;\">\t * @param  [stdclass] $stdclassobject [对象]</span><br><span style=\"background-color: #ffff99;\">\t * @return [array]                 [数组]</span><br><span style=\"background-color: #ffff99;\">\t */</span><br><span style=\"background-color: #ffff99;\">\tfunction std_class_object_to_array($stdclassobject)</span><br><span style=\"background-color: #ffff99;\">\t{</span><br><span style=\"background-color: #ffff99;\">\t    　　$_array = is_object($stdclassobject) ? get_object_vars($stdclassobject) : $stdclassobject;</span></p>\r\n<p style=\"margin-left: 30px;\"><span style=\"background-color: #ffff99;\">\t    　　foreach ($_array as $key =&gt; $value) {</span><br><span style=\"background-color: #ffff99;\">\t        　　　　$value = (is_array($value) || is_object($value)) ? std_class_object_to_array($value) : $value;</span><br><span style=\"background-color: #ffff99;\">\t        　　　　$array[$key] = $value;</span><br><span style=\"background-color: #ffff99;\">\t    　　}</span></p>\r\n<p style=\"margin-left: 30px;\"><span style=\"background-color: #ffff99;\">\t    　　return $array;</span><br><span style=\"background-color: #ffff99;\">\t}</span></p>\r\n<p style=\"margin-left: 30px;\">就这样，对象数组就优雅地转成了普通的数组。动动脑子，代码量下来了，功能也优雅地就实现了。一举两得，何乐而不为呢？</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-09 20:24</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4491003\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4491003);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4491003,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/9 20:24:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4491003.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=21", "desc": "摘要: 最近在用ThinkPHP开发一个京东服务市场的应用，然而京东服务市场接口返回的数据是个对象数组。然而需要一个个属性取出来放到数组里面然后再利用ThinkPHP的addAll或者add方法写入数据库。然而每次返回的字段有几十个，每次这么拼接都要崩溃了。果然还是那句话，当你感到无法忍受的时候你就会想..."}
{"title": "【转】AWK 简明教程", "content": "　　本文转自：http://coolshell.cn/articles/9070.html\r\n有一些网友看了前两天的《Linux下应该知道的技巧》希望我能教教他们用awk和sed，所以，出现了这篇文章。我估计这些80后的年轻朋友可能对awk/sed这类上古神器有点陌生了，所以需要我这个老家伙来炒炒冷饭。况且，AWK是贝尔实验室1977年搞出来的文本出现神器，今年是蛇年，是AWK的本命年，而且年纪和我相仿，所以非常有必要为他写篇文章。\r\n之所以叫AWK是因为其取了三位创始人 Alfred Aho，Peter Weinberger, 和 Brian Kernighan 的Family Name的首字符。要学AWK，就得提一提AWK的一本相当经典的书《The AWK Programming Language》，它在豆瓣上的评分是9.4分！在亚马逊上居然卖1022.30元。\r\n我在这里的教程并不想面面俱到，本文和我之前的Go语言简介一样，全是示例，基本无废话。\r\n我只想达到两个目的：\r\n1）你可以在乘坐公交地铁上下班，或是在坐马桶拉大便时读完（保证是一泡大便的工夫）。\r\n2）我只想让这篇博文像一个火辣的脱衣舞女挑起你的兴趣，然后还要你自己去下工夫去撸。\r\n废话少说，我们开始脱吧（注：这里只是topless）。\r\n起步上台\r\n我从netstat命令中提取了如下信息作为用例：\r\n \r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n11\r\n12\r\n13\r\n14\r\n15\r\n16\r\n17\r\n18\r\n19\r\n20\r\n\r\n\r\n\r\n$ cat netstat.txt\r\nProto Recv-Q Send-Q Local-Address          Foreign-Address             State\r\ntcp        0      0 0.0.0.0:3306           0.0.0.0:*                   LISTEN\r\ntcp        0      0 0.0.0.0:80             0.0.0.0:*                   LISTEN\r\ntcp        0      0 127.0.0.1:9000         0.0.0.0:*                   LISTEN\r\ntcp        0      0 coolshell.cn:80        124.205.5.146:18245         TIME_WAIT\r\ntcp        0      0 coolshell.cn:80        61.140.101.185:37538        FIN_WAIT2\r\ntcp        0      0 coolshell.cn:80        110.194.134.189:1032        ESTABLISHED\r\ntcp        0      0 coolshell.cn:80        123.169.124.111:49809       ESTABLISHED\r\ntcp        0      0 coolshell.cn:80        116.234.127.77:11502        FIN_WAIT2\r\ntcp        0      0 coolshell.cn:80        123.169.124.111:49829       ESTABLISHED\r\ntcp        0      0 coolshell.cn:80        183.60.215.36:36970         TIME_WAIT\r\ntcp        0   4166 coolshell.cn:80        61.148.242.38:30901         ESTABLISHED\r\ntcp        0      1 coolshell.cn:80        124.152.181.209:26825       FIN_WAIT1\r\ntcp        0      0 coolshell.cn:80        110.194.134.189:4796        ESTABLISHED\r\ntcp        0      0 coolshell.cn:80        183.60.212.163:51082        TIME_WAIT\r\ntcp        0      1 coolshell.cn:80        208.115.113.92:50601        LAST_ACK\r\ntcp        0      0 coolshell.cn:80        123.169.124.111:49840       ESTABLISHED\r\ntcp        0      0 coolshell.cn:80        117.136.20.85:50025         FIN_WAIT2\r\ntcp        0      0 :::22                  :::*                        LISTEN\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n下面是最简单最常用的awk示例，其输出第1列和第4例，\r\n\r\n其中单引号中的被大括号括着的就是awk的语句，注意，其只能被单引号包含。\r\n其中的$1..$n表示第几例。注：$0表示整个行。\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n11\r\n12\r\n13\r\n14\r\n15\r\n16\r\n17\r\n18\r\n19\r\n20\r\n\r\n\r\n\r\n$ awk '{print $1, $4}' netstat.txt\r\nProto Local-Address\r\ntcp 0.0.0.0:3306\r\ntcp 0.0.0.0:80\r\ntcp 127.0.0.1:9000\r\ntcp coolshell.cn:80\r\ntcp coolshell.cn:80\r\ntcp coolshell.cn:80\r\ntcp coolshell.cn:80\r\ntcp coolshell.cn:80\r\ntcp coolshell.cn:80\r\ntcp coolshell.cn:80\r\ntcp coolshell.cn:80\r\ntcp coolshell.cn:80\r\ntcp coolshell.cn:80\r\ntcp coolshell.cn:80\r\ntcp coolshell.cn:80\r\ntcp coolshell.cn:80\r\ntcp coolshell.cn:80\r\ntcp :::22\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n我们再来看看awk的格式化输出，和C语言的printf没什么两样：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n11\r\n12\r\n13\r\n14\r\n15\r\n16\r\n17\r\n18\r\n19\r\n20\r\n\r\n\r\n\r\n$ awk '{printf \"%-8s %-8s %-8s %-18s %-22s %-15s\\n\",$1,$2,$3,$4,$5,$6}' netstat.txt\r\nProto    Recv-Q   Send-Q   Local-Address      Foreign-Address        State\r\ntcp      0        0        0.0.0.0:3306       0.0.0.0:*              LISTEN\r\ntcp      0        0        0.0.0.0:80         0.0.0.0:*              LISTEN\r\ntcp      0        0        127.0.0.1:9000     0.0.0.0:*              LISTEN\r\ntcp      0        0        coolshell.cn:80    124.205.5.146:18245    TIME_WAIT\r\ntcp      0        0        coolshell.cn:80    61.140.101.185:37538   FIN_WAIT2\r\ntcp      0        0        coolshell.cn:80    110.194.134.189:1032   ESTABLISHED\r\ntcp      0        0        coolshell.cn:80    123.169.124.111:49809  ESTABLISHED\r\ntcp      0        0        coolshell.cn:80    116.234.127.77:11502   FIN_WAIT2\r\ntcp      0        0        coolshell.cn:80    123.169.124.111:49829  ESTABLISHED\r\ntcp      0        0        coolshell.cn:80    183.60.215.36:36970    TIME_WAIT\r\ntcp      0        4166     coolshell.cn:80    61.148.242.38:30901    ESTABLISHED\r\ntcp      0        1        coolshell.cn:80    124.152.181.209:26825  FIN_WAIT1\r\ntcp      0        0        coolshell.cn:80    110.194.134.189:4796   ESTABLISHED\r\ntcp      0        0        coolshell.cn:80    183.60.212.163:51082   TIME_WAIT\r\ntcp      0        1        coolshell.cn:80    208.115.113.92:50601   LAST_ACK\r\ntcp      0        0        coolshell.cn:80    123.169.124.111:49840  ESTABLISHED\r\ntcp      0        0        coolshell.cn:80    117.136.20.85:50025    FIN_WAIT2\r\ntcp      0        0        :::22              :::*                   LISTEN\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n脱掉外套\r\n过滤记录\r\n我们再来看看如何过滤记录（下面过滤条件为：第三列的值为0 && 第6列的值为LISTEN）\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n\r\n\r\n\r\n$ awk '$3==0 && $6==\"LISTEN\" ' netstat.txt\r\ntcp        0      0 0.0.0.0:3306               0.0.0.0:*              LISTEN\r\ntcp        0      0 0.0.0.0:80                 0.0.0.0:*              LISTEN\r\ntcp        0      0 127.0.0.1:9000             0.0.0.0:*              LISTEN\r\ntcp        0      0 :::22                      :::*                   LISTEN\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n其中的“==”为比较运算符。其他比较运算符：!=, >, <, >=, <=\r\n我们来看看各种过滤记录的方式：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n\r\n\r\n\r\n$ awk ' $3>0 {print $0}' netstat.txt\r\nProto Recv-Q Send-Q Local-Address          Foreign-Address             State\r\ntcp        0   4166 coolshell.cn:80        61.148.242.38:30901         ESTABLISHED\r\ntcp        0      1 coolshell.cn:80        124.152.181.209:26825       FIN_WAIT1\r\ntcp        0      1 coolshell.cn:80        208.115.113.92:50601        LAST_ACK\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n如果我们需要表头的话，我们可以引入内建变量NR：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n\r\n\r\n\r\n$ awk '$3==0 && $6==\"LISTEN\" || NR==1 ' netstat.txt\r\nProto Recv-Q Send-Q Local-Address          Foreign-Address             State\r\ntcp        0      0 0.0.0.0:3306           0.0.0.0:*                   LISTEN\r\ntcp        0      0 0.0.0.0:80             0.0.0.0:*                   LISTEN\r\ntcp        0      0 127.0.0.1:9000         0.0.0.0:*                   LISTEN\r\ntcp        0      0 :::22                  :::*                        LISTEN\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n再加上格式化输出：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n\r\n\r\n\r\n$ awk '$3==0 && $6==\"LISTEN\" || NR==1 {printf \"%-20s %-20s %s\\n\",$4,$5,$6}' netstat.txt\r\nLocal-Address        Foreign-Address      State\r\n0.0.0.0:3306         0.0.0.0:*            LISTEN\r\n0.0.0.0:80           0.0.0.0:*            LISTEN\r\n127.0.0.1:9000       0.0.0.0:*            LISTEN\r\n:::22                :::*                 LISTEN\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n内建变量\r\n说到了内建变量，我们可以来看看awk的一些内建变量：\r\n\r\n\r\n\r\n$0\r\n当前记录（这个变量中存放着整个行的内容）\r\n\r\n\r\n$1~$n\r\n当前记录的第n个字段，字段间由FS分隔\r\n\r\n\r\nFS\r\n输入字段分隔符 默认是空格或Tab\r\n\r\n\r\nNF\r\n当前记录中的字段个数，就是有多少列\r\n\r\n\r\nNR\r\n已经读出的记录数，就是行号，从1开始，如果有多个文件话，这个值也是不断累加中。\r\n\r\n\r\nFNR\r\n当前记录数，与NR不同的是，这个值会是各个文件自己的行号\r\n\r\n\r\nRS\r\n输入的记录分隔符， 默认为换行符\r\n\r\n\r\nOFS\r\n输出字段分隔符， 默认也是空格\r\n\r\n\r\nORS\r\n输出的记录分隔符，默认为换行符\r\n\r\n\r\nFILENAME\r\n当前输入文件的名字\r\n\r\n\r\n\r\n怎么使用呢，比如：我们如果要输出行号：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n\r\n\r\n\r\n$ awk '$3==0 && $6==\"ESTABLISHED\" || NR==1 {printf \"%02s %s %-20s %-20s %s\\n\",NR, FNR, $4,$5,$6}' netstat.txt\r\n01 1 Local-Address        Foreign-Address      State\r\n07 7 coolshell.cn:80      110.194.134.189:1032 ESTABLISHED\r\n08 8 coolshell.cn:80      123.169.124.111:49809 ESTABLISHED\r\n10 10 coolshell.cn:80      123.169.124.111:49829 ESTABLISHED\r\n14 14 coolshell.cn:80      110.194.134.189:4796 ESTABLISHED\r\n17 17 coolshell.cn:80      123.169.124.111:49840 ESTABLISHED\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n指定分隔符\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n\r\n\r\n\r\n$  awk  'BEGIN{FS=\":\"} {print $1,$3,$6}' /etc/passwd\r\nroot 0 /root\r\nbin 1 /bin\r\ndaemon 2 /sbin\r\nadm 3 /var/adm\r\nlp 4 /var/spool/lpd\r\nsync 5 /sbin\r\nshutdown 6 /sbin\r\nhalt 7 /sbin\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n上面的命令也等价于：（-F的意思就是指定分隔符）\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n\r\n\r\n\r\n$ awk  -F: '{print $1,$3,$6}' /etc/passwd\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n注：如果你要指定多个分隔符，你可以这样来：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n\r\n\r\n\r\nawk -F '[;:]'\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n再来看一个以\\t作为分隔符输出的例子（下面使用了/etc/passwd文件，这个文件是以:分隔的）：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n\r\n\r\n\r\n$ awk  -F: '{print $1,$3,$6}' OFS=\"\\t\" /etc/passwd\r\nroot    0       /root\r\nbin     1       /bin\r\ndaemon  2       /sbin\r\nadm     3       /var/adm\r\nlp      4       /var/spool/lpd\r\nsync    5       /sbin\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n脱掉衬衫\r\n字符串匹配\r\n我们再来看几个字符串匹配的示例：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n11\r\n12\r\n13\r\n14\r\n15\r\n16\r\n\r\n\r\n\r\n$ awk '$6 ~ /FIN/ || NR==1 {print NR,$4,$5,$6}' OFS=\"\\t\" netstat.txt\r\n1       Local-Address   Foreign-Address State\r\n6       coolshell.cn:80 61.140.101.185:37538    FIN_WAIT2\r\n9       coolshell.cn:80 116.234.127.77:11502    FIN_WAIT2\r\n13      coolshell.cn:80 124.152.181.209:26825   FIN_WAIT1\r\n18      coolshell.cn:80 117.136.20.85:50025     FIN_WAIT2\r\n \r\n$ $ awk '$6 ~ /WAIT/ || NR==1 {print NR,$4,$5,$6}' OFS=\"\\t\" netstat.txt\r\n1       Local-Address   Foreign-Address State\r\n5       coolshell.cn:80 124.205.5.146:18245     TIME_WAIT\r\n6       coolshell.cn:80 61.140.101.185:37538    FIN_WAIT2\r\n9       coolshell.cn:80 116.234.127.77:11502    FIN_WAIT2\r\n11      coolshell.cn:80 183.60.215.36:36970     TIME_WAIT\r\n13      coolshell.cn:80 124.152.181.209:26825   FIN_WAIT1\r\n15      coolshell.cn:80 183.60.212.163:51082    TIME_WAIT\r\n18      coolshell.cn:80 117.136.20.85:50025     FIN_WAIT2\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n上面的第一个示例匹配FIN状态， 第二个示例匹配WAIT字样的状态。其实 ~ 表示模式开始。/ /中是模式。这就是一个正则表达式的匹配。\r\n其实awk可以像grep一样的去匹配第一行，就像这样：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n\r\n\r\n\r\n$ awk '/LISTEN/' netstat.txt\r\ntcp        0      0 0.0.0.0:3306            0.0.0.0:*               LISTEN\r\ntcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN\r\ntcp        0      0 127.0.0.1:9000          0.0.0.0:*               LISTEN\r\ntcp        0      0 :::22                   :::*                    LISTEN\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n我们可以使用 “/FIN|TIME/” 来匹配 FIN 或者 TIME :\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n\r\n\r\n\r\n$ awk '$6 ~ /FIN|TIME/ || NR==1 {print NR,$4,$5,$6}' OFS=\"\\t\" netstat.txt\r\n1       Local-Address   Foreign-Address State\r\n5       coolshell.cn:80 124.205.5.146:18245     TIME_WAIT\r\n6       coolshell.cn:80 61.140.101.185:37538    FIN_WAIT2\r\n9       coolshell.cn:80 116.234.127.77:11502    FIN_WAIT2\r\n11      coolshell.cn:80 183.60.215.36:36970     TIME_WAIT\r\n13      coolshell.cn:80 124.152.181.209:26825   FIN_WAIT1\r\n15      coolshell.cn:80 183.60.212.163:51082    TIME_WAIT\r\n18      coolshell.cn:80 117.136.20.85:50025     FIN_WAIT2\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n再来看看模式取反的例子：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n11\r\n12\r\n13\r\n\r\n\r\n\r\n$ awk '$6 !~ /WAIT/ || NR==1 {print NR,$4,$5,$6}' OFS=\"\\t\" netstat.txt\r\n1       Local-Address   Foreign-Address State\r\n2       0.0.0.0:3306    0.0.0.0:*       LISTEN\r\n3       0.0.0.0:80      0.0.0.0:*       LISTEN\r\n4       127.0.0.1:9000  0.0.0.0:*       LISTEN\r\n7       coolshell.cn:80 110.194.134.189:1032    ESTABLISHED\r\n8       coolshell.cn:80 123.169.124.111:49809   ESTABLISHED\r\n10      coolshell.cn:80 123.169.124.111:49829   ESTABLISHED\r\n12      coolshell.cn:80 61.148.242.38:30901     ESTABLISHED\r\n14      coolshell.cn:80 110.194.134.189:4796    ESTABLISHED\r\n16      coolshell.cn:80 208.115.113.92:50601    LAST_ACK\r\n17      coolshell.cn:80 123.169.124.111:49840   ESTABLISHED\r\n19      :::22   :::*    LISTEN\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n或是：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n\r\n\r\n\r\nawk '!/WAIT/' netstat.txt\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n折分文件\r\nawk拆分文件很简单，使用重定向就好了。下面这个例子，是按第6例分隔文件，相当的简单（其中的NR!=1表示不处理表头）。\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n11\r\n12\r\n13\r\n14\r\n15\r\n16\r\n17\r\n18\r\n19\r\n20\r\n21\r\n22\r\n23\r\n24\r\n25\r\n26\r\n27\r\n28\r\n29\r\n30\r\n31\r\n32\r\n33\r\n34\r\n\r\n\r\n\r\n$ awk 'NR!=1{print > $6}' netstat.txt\r\n \r\n$ ls\r\nESTABLISHED  FIN_WAIT1  FIN_WAIT2  LAST_ACK  LISTEN  netstat.txt  TIME_WAIT\r\n \r\n$ cat ESTABLISHED\r\ntcp        0      0 coolshell.cn:80        110.194.134.189:1032        ESTABLISHED\r\ntcp        0      0 coolshell.cn:80        123.169.124.111:49809       ESTABLISHED\r\ntcp        0      0 coolshell.cn:80        123.169.124.111:49829       ESTABLISHED\r\ntcp        0   4166 coolshell.cn:80        61.148.242.38:30901         ESTABLISHED\r\ntcp        0      0 coolshell.cn:80        110.194.134.189:4796        ESTABLISHED\r\ntcp        0      0 coolshell.cn:80        123.169.124.111:49840       ESTABLISHED\r\n \r\n$ cat FIN_WAIT1\r\ntcp        0      1 coolshell.cn:80        124.152.181.209:26825       FIN_WAIT1\r\n \r\n$ cat FIN_WAIT2\r\ntcp        0      0 coolshell.cn:80        61.140.101.185:37538        FIN_WAIT2\r\ntcp        0      0 coolshell.cn:80        116.234.127.77:11502        FIN_WAIT2\r\ntcp        0      0 coolshell.cn:80        117.136.20.85:50025         FIN_WAIT2\r\n \r\n$ cat LAST_ACK\r\ntcp        0      1 coolshell.cn:80        208.115.113.92:50601        LAST_ACK\r\n \r\n$ cat LISTEN\r\ntcp        0      0 0.0.0.0:3306           0.0.0.0:*                   LISTEN\r\ntcp        0      0 0.0.0.0:80             0.0.0.0:*                   LISTEN\r\ntcp        0      0 127.0.0.1:9000         0.0.0.0:*                   LISTEN\r\ntcp        0      0 :::22                  :::*                        LISTEN\r\n \r\n$ cat TIME_WAIT\r\ntcp        0      0 coolshell.cn:80        124.205.5.146:18245         TIME_WAIT\r\ntcp        0      0 coolshell.cn:80        183.60.215.36:36970         TIME_WAIT\r\ntcp        0      0 coolshell.cn:80        183.60.212.163:51082        TIME_WAIT\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n你也可以把指定的列输出到文件：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n\r\n\r\n\r\nawk 'NR!=1{print $4,$5 > $6}' netstat.txt\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n再复杂一点：（注意其中的if-else-if语句，可见awk其实是个脚本解释器）\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n11\r\n12\r\n13\r\n14\r\n15\r\n16\r\n17\r\n18\r\n19\r\n20\r\n21\r\n22\r\n23\r\n24\r\n25\r\n26\r\n27\r\n28\r\n29\r\n30\r\n\r\n\r\n\r\n$ awk 'NR!=1{if($6 ~ /TIME|ESTABLISHED/) print > \"1.txt\";\r\nelse if($6 ~ /LISTEN/) print > \"2.txt\";\r\nelse print > \"3.txt\" }' netstat.txt\r\n \r\n$ ls ?.txt\r\n1.txt  2.txt  3.txt\r\n \r\n$ cat 1.txt\r\ntcp        0      0 coolshell.cn:80        124.205.5.146:18245         TIME_WAIT\r\ntcp        0      0 coolshell.cn:80        110.194.134.189:1032        ESTABLISHED\r\ntcp        0      0 coolshell.cn:80        123.169.124.111:49809       ESTABLISHED\r\ntcp        0      0 coolshell.cn:80        123.169.124.111:49829       ESTABLISHED\r\ntcp        0      0 coolshell.cn:80        183.60.215.36:36970         TIME_WAIT\r\ntcp        0   4166 coolshell.cn:80        61.148.242.38:30901         ESTABLISHED\r\ntcp        0      0 coolshell.cn:80        110.194.134.189:4796        ESTABLISHED\r\ntcp        0      0 coolshell.cn:80        183.60.212.163:51082        TIME_WAIT\r\ntcp        0      0 coolshell.cn:80        123.169.124.111:49840       ESTABLISHED\r\n \r\n$ cat 2.txt\r\ntcp        0      0 0.0.0.0:3306           0.0.0.0:*                   LISTEN\r\ntcp        0      0 0.0.0.0:80             0.0.0.0:*                   LISTEN\r\ntcp        0      0 127.0.0.1:9000         0.0.0.0:*                   LISTEN\r\ntcp        0      0 :::22                  :::*                        LISTEN\r\n \r\n$ cat 3.txt\r\ntcp        0      0 coolshell.cn:80        61.140.101.185:37538        FIN_WAIT2\r\ntcp        0      0 coolshell.cn:80        116.234.127.77:11502        FIN_WAIT2\r\ntcp        0      1 coolshell.cn:80        124.152.181.209:26825       FIN_WAIT1\r\ntcp        0      1 coolshell.cn:80        208.115.113.92:50601        LAST_ACK\r\ntcp        0      0 coolshell.cn:80        117.136.20.85:50025         FIN_WAIT2\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n统计\r\n下面的命令计算所有的C文件，CPP文件和H文件的文件大小总和。\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n\r\n\r\n\r\n$ ls -l  *.cpp *.c *.h | awk '{sum+=$5} END {print sum}'\r\n2511401\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n我们再来看一个统计各个connection状态的用法：（我们可以看到一些编程的影子了，大家都是程序员我就不解释了。注意其中的数组的用法）\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n\r\n\r\n\r\n$ awk 'NR!=1{a[$6]++;} END {for (i in a) print i \", \" a[i];}' netstat.txt\r\nTIME_WAIT, 3\r\nFIN_WAIT1, 1\r\nESTABLISHED, 6\r\nFIN_WAIT2, 3\r\nLAST_ACK, 1\r\nLISTEN, 4\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n再来看看统计每个用户的进程的占了多少内存（注：sum的RSS那一列）\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n\r\n\r\n\r\n$ ps aux | awk 'NR!=1{a[$1]+=$6;} END { for(i in a) print i \", \" a[i]\"KB\";}'\r\ndbus, 540KB\r\nmysql, 99928KB\r\nwww, 3264924KB\r\nroot, 63644KB\r\nhchen, 6020KB\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n脱掉内衣\r\nawk脚本\r\n在上面我们可以看到一个END关键字。END的意思是“处理完所有的行的标识”，即然说到了END就有必要介绍一下BEGIN，这两个关键字意味着执行前和执行后的意思，语法如下：\r\n\r\nBEGIN{ 这里面放的是执行前的语句 }\r\nEND {这里面放的是处理完所有的行后要执行的语句 }\r\n{这里面放的是处理每一行时要执行的语句}\r\n\r\n为了说清楚这个事，我们来看看下面的示例：\r\n假设有这么一个文件（学生成绩表）：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n\r\n\r\n\r\n$ cat score.txt\r\nMarry   2143 78 84 77\r\nJack    2321 66 78 45\r\nTom     2122 48 77 71\r\nMike    2537 87 97 95\r\nBob     2415 40 57 62\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n我们的awk脚本如下（我没有写有命令行上是因为命令行上不易读，另外也在介绍另一种用法）：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n11\r\n12\r\n13\r\n14\r\n15\r\n16\r\n17\r\n18\r\n19\r\n20\r\n21\r\n22\r\n23\r\n24\r\n\r\n\r\n\r\n$ cat cal.awk\r\n#!/bin/awk -f\r\n#运行前\r\nBEGIN {\r\n    math = 0\r\n    english = 0\r\n    computer = 0\r\n \r\n    printf \"NAME    NO.   MATH  ENGLISH  COMPUTER   TOTAL\\n\"\r\n    printf \"---------------------------------------------\\n\"\r\n}\r\n#运行中\r\n{\r\n    math+=$3\r\n    english+=$4\r\n    computer+=$5\r\n    printf \"%-6s %-6s %4d %8d %8d %8d\\n\", $1, $2, $3,$4,$5, $3+$4+$5\r\n}\r\n#运行后\r\nEND {\r\n    printf \"---------------------------------------------\\n\"\r\n    printf \"  TOTAL:%10d %8d %8d \\n\", math, english, computer\r\n    printf \"AVERAGE:%10.2f %8.2f %8.2f\\n\", math/NR, english/NR, computer/NR\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n我们来看一下执行结果：（也可以这样运行 ./cal.awk score.txt）\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n11\r\n\r\n\r\n\r\n$ awk -f cal.awk score.txt\r\nNAME    NO.   MATH  ENGLISH  COMPUTER   TOTAL\r\n---------------------------------------------\r\nMarry  2143     78       84       77      239\r\nJack   2321     66       78       45      189\r\nTom    2122     48       77       71      196\r\nMike   2537     87       97       95      279\r\nBob    2415     40       57       62      159\r\n---------------------------------------------\r\n  TOTAL:       319      393      350\r\nAVERAGE:     63.80    78.60    70.00\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n环境变量\r\n即然说到了脚本，我们来看看怎么和环境变量交互：（使用-v参数和ENVIRON，使用ENVIRON的环境变量需要export）\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n11\r\n12\r\n13\r\n14\r\n\r\n\r\n\r\n$ x=5\r\n \r\n$ y=10\r\n$ export y\r\n \r\n$ echo $x $y\r\n5 10\r\n \r\n$ awk -v val=$x '{print $1, $2, $3, $4+val, $5+ENVIRON[\"y\"]}' OFS=\"\\t\" score.txt\r\nMarry   2143    78      89      87\r\nJack    2321    66      83      55\r\nTom     2122    48      82      81\r\nMike    2537    87      102     105\r\nBob     2415    40      62      72\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n几个花活\r\n最后，我们再来看几个小例子：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n\r\n\r\n\r\n#从file文件中找出长度大于80的行\r\nawk 'length>80' file\r\n \r\n#按连接数查看客户端IP\r\nnetstat -ntu | awk '{print $5}' | cut -d: -f1 | sort | uniq -c | sort -nr\r\n \r\n#打印99乘法表\r\nseq 9 | sed 'H;g' | awk -v RS='' '{for(i=1;i<=NF;i++)printf(\"%dx%d=%d%s\", i, NR, i*NR, i==NR?\"\\n\":\"\\t\")}'\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n自己撸吧\r\n关于其中的一些知识点可以参看gawk的手册：\r\n\r\n内建变量，参看：http://www.gnu.org/software/gawk/manual/gawk.html#Built_002din-Variables\r\n流控方面，参看：http://www.gnu.org/software/gawk/manual/gawk.html#Statements\r\n内建函数，参看：http://www.gnu.org/software/gawk/manual/gawk.html#Built_002din\r\n正则表达式，参看：http://www.gnu.org/software/gawk/manual/gawk.html#Regexp\r\n\r\n（全文完）", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>【转】AWK 简明教程 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4503493.html\">【转】AWK 简明教程</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>　　本文转自：http://coolshell.cn/articles/9070.html</p>\r\n<p>有一些网友看了前两天的《<a title=\"应该知道的Linux技巧\" href=\"http://coolshell.cn/articles/8883.html\" target=\"_blank\">Linux下应该知道的技巧</a>》希望我能教教他们用awk和sed，所以，出现了这篇文章。我估计这些80后的年轻朋友可能对awk/sed这类上古神器有点陌生了，所以需要我这个老家伙来炒炒冷饭。<strong>况且，AWK是贝尔实验室1977年搞出来的文本出现神器，今年是蛇年，是AWK的本命年，而且年纪和我相仿，所以非常有必要为他写篇文章</strong>。</p>\r\n<p>之所以叫AWK是因为其取了三位创始人 <a title=\"Alfred Aho\" href=\"http://en.wikipedia.org/wiki/Alfred_Aho\">Alfred Aho</a>，<a title=\"Peter J. Weinberger\" href=\"http://en.wikipedia.org/wiki/Peter_J._Weinberger\">Peter Weinberger</a>, 和 <a title=\"Brian Kernighan\" href=\"http://en.wikipedia.org/wiki/Brian_Kernighan\">Brian Kernighan</a> 的Family Name的首字符。要学AWK，就得提一提AWK的一本相当经典的书《<a href=\"http://plan9.bell-labs.com/cm/cs/awkbook/\" rel=\"nofollow\">The AWK Programming Language</a>》，它在<a href=\"http://book.douban.com/subject/1876898/\" target=\"_blank\">豆瓣上的评分</a>是9.4分！在<a href=\"http://www.amazon.cn/mn/detailApp/?asin=020107981X\" target=\"_blank\">亚马逊上居然卖1022.30元</a>。</p>\r\n<p>我在这里的教程并不想面面俱到，本文和我之前的<a title=\"Go 语言简介（上）— 语法\" href=\"http://coolshell.cn/articles/8460.html\" target=\"_blank\">Go语言简介</a>一样，全是示例，基本无废话。</p>\r\n<p><strong>我只想达到两个目的：</strong></p>\r\n<p><strong>1）你可以在乘坐公交地铁上下班，或是在坐马桶拉大便时读完（保证是一泡大便的工夫）。</strong></p>\r\n<p><strong>2）我只想让这篇博文像一个火辣的脱衣舞女挑起你的兴趣，然后还要你自己去下工夫去撸。</strong></p>\r\n<p>废话少说，我们开始脱吧（注：这里只是topless）。</p>\r\n<h4>起步上台</h4>\r\n<p>我从netstat命令中提取了如下信息作为用例：</p>\r\n<p> </p>\r\n<div>\r\n<div id=\"highlighter_865158\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n<div class=\"line number10 index9 alt1\">10</div>\r\n<div class=\"line number11 index10 alt2\">11</div>\r\n<div class=\"line number12 index11 alt1\">12</div>\r\n<div class=\"line number13 index12 alt2\">13</div>\r\n<div class=\"line number14 index13 alt1\">14</div>\r\n<div class=\"line number15 index14 alt2\">15</div>\r\n<div class=\"line number16 index15 alt1\">16</div>\r\n<div class=\"line number17 index16 alt2\">17</div>\r\n<div class=\"line number18 index17 alt1\">18</div>\r\n<div class=\"line number19 index18 alt2\">19</div>\r\n<div class=\"line number20 index19 alt1\">20</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">cat</code> <code class=\"bash functions\">netstat</code><code class=\"bash plain\">.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">Proto Recv-Q Send-Q Local-Address          Foreign-Address             State</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">tcp        0      0 0.0.0.0:3306           0.0.0.0:*                   LISTEN</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">tcp        0      0 0.0.0.0:80             0.0.0.0:*                   LISTEN</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">tcp        0      0 127.0.0.1:9000         0.0.0.0:*                   LISTEN</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        124.205.5.146:18245         TIME_WAIT</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        61.140.101.185:37538        FIN_WAIT2</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        110.194.134.189:1032        ESTABLISHED</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        123.169.124.111:49809       ESTABLISHED</code></div>\r\n<div class=\"line number10 index9 alt1\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        116.234.127.77:11502        FIN_WAIT2</code></div>\r\n<div class=\"line number11 index10 alt2\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        123.169.124.111:49829       ESTABLISHED</code></div>\r\n<div class=\"line number12 index11 alt1\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        183.60.215.36:36970         TIME_WAIT</code></div>\r\n<div class=\"line number13 index12 alt2\"><code class=\"bash plain\">tcp        0   4166 coolshell.cn:80        61.148.242.38:30901         ESTABLISHED</code></div>\r\n<div class=\"line number14 index13 alt1\"><code class=\"bash plain\">tcp        0      1 coolshell.cn:80        124.152.181.209:26825       FIN_WAIT1</code></div>\r\n<div class=\"line number15 index14 alt2\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        110.194.134.189:4796        ESTABLISHED</code></div>\r\n<div class=\"line number16 index15 alt1\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        183.60.212.163:51082        TIME_WAIT</code></div>\r\n<div class=\"line number17 index16 alt2\"><code class=\"bash plain\">tcp        0      1 coolshell.cn:80        208.115.113.92:50601        LAST_ACK</code></div>\r\n<div class=\"line number18 index17 alt1\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        123.169.124.111:49840       ESTABLISHED</code></div>\r\n<div class=\"line number19 index18 alt2\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        117.136.20.85:50025         FIN_WAIT2</code></div>\r\n<div class=\"line number20 index19 alt1\"><code class=\"bash plain\">tcp        0      0 :::22                  :::*                        LISTEN</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>下面是最简单最常用的awk示例，其输出第1列和第4例，</p>\r\n<ul>\r\n<li>其中单引号中的被大括号括着的就是awk的语句，注意，其只能被单引号包含。</li>\r\n<li>其中的$1..$n表示第几例。注：$0表示整个行。</li>\r\n</ul>\r\n<div>\r\n<div id=\"highlighter_747475\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n<div class=\"line number10 index9 alt1\">10</div>\r\n<div class=\"line number11 index10 alt2\">11</div>\r\n<div class=\"line number12 index11 alt1\">12</div>\r\n<div class=\"line number13 index12 alt2\">13</div>\r\n<div class=\"line number14 index13 alt1\">14</div>\r\n<div class=\"line number15 index14 alt2\">15</div>\r\n<div class=\"line number16 index15 alt1\">16</div>\r\n<div class=\"line number17 index16 alt2\">17</div>\r\n<div class=\"line number18 index17 alt1\">18</div>\r\n<div class=\"line number19 index18 alt2\">19</div>\r\n<div class=\"line number20 index19 alt1\">20</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">awk</code> <code class=\"bash string\">'{print $1, $4}'</code> <code class=\"bash functions\">netstat</code><code class=\"bash plain\">.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">Proto Local-Address</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">tcp 0.0.0.0:3306</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">tcp 0.0.0.0:80</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">tcp 127.0.0.1:9000</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">tcp coolshell.cn:80</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash plain\">tcp coolshell.cn:80</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">tcp coolshell.cn:80</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash plain\">tcp coolshell.cn:80</code></div>\r\n<div class=\"line number10 index9 alt1\"><code class=\"bash plain\">tcp coolshell.cn:80</code></div>\r\n<div class=\"line number11 index10 alt2\"><code class=\"bash plain\">tcp coolshell.cn:80</code></div>\r\n<div class=\"line number12 index11 alt1\"><code class=\"bash plain\">tcp coolshell.cn:80</code></div>\r\n<div class=\"line number13 index12 alt2\"><code class=\"bash plain\">tcp coolshell.cn:80</code></div>\r\n<div class=\"line number14 index13 alt1\"><code class=\"bash plain\">tcp coolshell.cn:80</code></div>\r\n<div class=\"line number15 index14 alt2\"><code class=\"bash plain\">tcp coolshell.cn:80</code></div>\r\n<div class=\"line number16 index15 alt1\"><code class=\"bash plain\">tcp coolshell.cn:80</code></div>\r\n<div class=\"line number17 index16 alt2\"><code class=\"bash plain\">tcp coolshell.cn:80</code></div>\r\n<div class=\"line number18 index17 alt1\"><code class=\"bash plain\">tcp coolshell.cn:80</code></div>\r\n<div class=\"line number19 index18 alt2\"><code class=\"bash plain\">tcp coolshell.cn:80</code></div>\r\n<div class=\"line number20 index19 alt1\"><code class=\"bash plain\">tcp :::22</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>我们再来看看awk的格式化输出，和C语言的printf没什么两样：</p>\r\n<div>\r\n<div id=\"highlighter_68761\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n<div class=\"line number10 index9 alt1\">10</div>\r\n<div class=\"line number11 index10 alt2\">11</div>\r\n<div class=\"line number12 index11 alt1\">12</div>\r\n<div class=\"line number13 index12 alt2\">13</div>\r\n<div class=\"line number14 index13 alt1\">14</div>\r\n<div class=\"line number15 index14 alt2\">15</div>\r\n<div class=\"line number16 index15 alt1\">16</div>\r\n<div class=\"line number17 index16 alt2\">17</div>\r\n<div class=\"line number18 index17 alt1\">18</div>\r\n<div class=\"line number19 index18 alt2\">19</div>\r\n<div class=\"line number20 index19 alt1\">20</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">awk</code> <code class=\"bash string\">'{printf \"%-8s %-8s %-8s %-18s %-22s %-15s\\n\",$1,$2,$3,$4,$5,$6}'</code> <code class=\"bash functions\">netstat</code><code class=\"bash plain\">.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">Proto    Recv-Q   Send-Q   Local-Address      Foreign-Address        State</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">tcp      0        0        0.0.0.0:3306       0.0.0.0:*              LISTEN</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">tcp      0        0        0.0.0.0:80         0.0.0.0:*              LISTEN</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">tcp      0        0        127.0.0.1:9000     0.0.0.0:*              LISTEN</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">tcp      0        0        coolshell.cn:80    124.205.5.146:18245    TIME_WAIT</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash plain\">tcp      0        0        coolshell.cn:80    61.140.101.185:37538   FIN_WAIT2</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">tcp      0        0        coolshell.cn:80    110.194.134.189:1032   ESTABLISHED</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash plain\">tcp      0        0        coolshell.cn:80    123.169.124.111:49809  ESTABLISHED</code></div>\r\n<div class=\"line number10 index9 alt1\"><code class=\"bash plain\">tcp      0        0        coolshell.cn:80    116.234.127.77:11502   FIN_WAIT2</code></div>\r\n<div class=\"line number11 index10 alt2\"><code class=\"bash plain\">tcp      0        0        coolshell.cn:80    123.169.124.111:49829  ESTABLISHED</code></div>\r\n<div class=\"line number12 index11 alt1\"><code class=\"bash plain\">tcp      0        0        coolshell.cn:80    183.60.215.36:36970    TIME_WAIT</code></div>\r\n<div class=\"line number13 index12 alt2\"><code class=\"bash plain\">tcp      0        4166     coolshell.cn:80    61.148.242.38:30901    ESTABLISHED</code></div>\r\n<div class=\"line number14 index13 alt1\"><code class=\"bash plain\">tcp      0        1        coolshell.cn:80    124.152.181.209:26825  FIN_WAIT1</code></div>\r\n<div class=\"line number15 index14 alt2\"><code class=\"bash plain\">tcp      0        0        coolshell.cn:80    110.194.134.189:4796   ESTABLISHED</code></div>\r\n<div class=\"line number16 index15 alt1\"><code class=\"bash plain\">tcp      0        0        coolshell.cn:80    183.60.212.163:51082   TIME_WAIT</code></div>\r\n<div class=\"line number17 index16 alt2\"><code class=\"bash plain\">tcp      0        1        coolshell.cn:80    208.115.113.92:50601   LAST_ACK</code></div>\r\n<div class=\"line number18 index17 alt1\"><code class=\"bash plain\">tcp      0        0        coolshell.cn:80    123.169.124.111:49840  ESTABLISHED</code></div>\r\n<div class=\"line number19 index18 alt2\"><code class=\"bash plain\">tcp      0        0        coolshell.cn:80    117.136.20.85:50025    FIN_WAIT2</code></div>\r\n<div class=\"line number20 index19 alt1\"><code class=\"bash plain\">tcp      0        0        :::22              :::*                   LISTEN</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<h4>脱掉外套</h4>\r\n<h5>过滤记录</h5>\r\n<p>我们再来看看如何过滤记录（下面过滤条件为：第三列的值为0 &amp;&amp; 第6列的值为LISTEN）</p>\r\n<div>\r\n<div id=\"highlighter_878193\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">awk</code> <code class=\"bash string\">'$3==0 &amp;&amp; $6==\"LISTEN\" '</code> <code class=\"bash functions\">netstat</code><code class=\"bash plain\">.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">tcp        0      0 0.0.0.0:3306               0.0.0.0:*              LISTEN</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">tcp        0      0 0.0.0.0:80                 0.0.0.0:*              LISTEN</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">tcp        0      0 127.0.0.1:9000             0.0.0.0:*              LISTEN</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">tcp        0      0 :::22                      :::*                   LISTEN</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>其中的“==”为比较运算符。其他比较运算符：!=, &gt;, &lt;, &gt;=, &lt;=</p>\r\n<p>我们来看看各种过滤记录的方式：</p>\r\n<div>\r\n<div id=\"highlighter_768145\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">awk</code> <code class=\"bash string\">' $3&gt;0 {print $0}'</code> <code class=\"bash functions\">netstat</code><code class=\"bash plain\">.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">Proto Recv-Q Send-Q Local-Address          Foreign-Address             State</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">tcp        0   4166 coolshell.cn:80        61.148.242.38:30901         ESTABLISHED</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">tcp        0      1 coolshell.cn:80        124.152.181.209:26825       FIN_WAIT1</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">tcp        0      1 coolshell.cn:80        208.115.113.92:50601        LAST_ACK</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>如果我们需要表头的话，我们可以引入内建变量NR：</p>\r\n<div>\r\n<div id=\"highlighter_854481\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">awk</code> <code class=\"bash string\">'$3==0 &amp;&amp; $6==\"LISTEN\" || NR==1 '</code> <code class=\"bash functions\">netstat</code><code class=\"bash plain\">.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">Proto Recv-Q Send-Q Local-Address          Foreign-Address             State</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">tcp        0      0 0.0.0.0:3306           0.0.0.0:*                   LISTEN</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">tcp        0      0 0.0.0.0:80             0.0.0.0:*                   LISTEN</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">tcp        0      0 127.0.0.1:9000         0.0.0.0:*                   LISTEN</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">tcp        0      0 :::22                  :::*                        LISTEN</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>再加上格式化输出：</p>\r\n<div>\r\n<div id=\"highlighter_430358\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">awk</code> <code class=\"bash string\">'$3==0 &amp;&amp; $6==\"LISTEN\" || NR==1 {printf \"%-20s %-20s %s\\n\",$4,$5,$6}'</code> <code class=\"bash functions\">netstat</code><code class=\"bash plain\">.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">Local-Address        Foreign-Address      State</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">0.0.0.0:3306         0.0.0.0:*            LISTEN</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">0.0.0.0:80           0.0.0.0:*            LISTEN</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">127.0.0.1:9000       0.0.0.0:*            LISTEN</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">:::22                :::*                 LISTEN</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<h5><strong>内建变量</strong></h5>\r\n<p>说到了内建变量，我们可以来看看awk的一些内建变量：</p>\r\n<table border=\"0\" cellspacing=\"1\" cellpadding=\"4\">\r\n<tbody>\r\n<tr>\r\n<td bgcolor=\"#ffffff\">$0</td>\r\n<td bgcolor=\"#ffffff\">当前记录（这个变量中存放着整个行的内容）</td>\r\n</tr>\r\n<tr>\r\n<td bgcolor=\"#ffffff\">$1~$n</td>\r\n<td bgcolor=\"#ffffff\">当前记录的第n个字段，字段间由FS分隔</td>\r\n</tr>\r\n<tr>\r\n<td bgcolor=\"#ffffff\">FS</td>\r\n<td bgcolor=\"#ffffff\">输入字段分隔符 默认是空格或Tab</td>\r\n</tr>\r\n<tr>\r\n<td bgcolor=\"#ffffff\">NF</td>\r\n<td bgcolor=\"#ffffff\">当前记录中的字段个数，就是有多少列</td>\r\n</tr>\r\n<tr>\r\n<td bgcolor=\"#ffffff\">NR</td>\r\n<td bgcolor=\"#ffffff\">已经读出的记录数，就是行号，从1开始，如果有多个文件话，这个值也是不断累加中。</td>\r\n</tr>\r\n<tr>\r\n<td bgcolor=\"#ffffff\">FNR</td>\r\n<td bgcolor=\"#ffffff\">当前记录数，与NR不同的是，这个值会是各个文件自己的行号</td>\r\n</tr>\r\n<tr>\r\n<td bgcolor=\"#ffffff\">RS</td>\r\n<td bgcolor=\"#ffffff\">输入的记录分隔符， 默认为换行符</td>\r\n</tr>\r\n<tr>\r\n<td bgcolor=\"#ffffff\">OFS</td>\r\n<td bgcolor=\"#ffffff\">输出字段分隔符， 默认也是空格</td>\r\n</tr>\r\n<tr>\r\n<td bgcolor=\"#ffffff\">ORS</td>\r\n<td bgcolor=\"#ffffff\">输出的记录分隔符，默认为换行符</td>\r\n</tr>\r\n<tr>\r\n<td bgcolor=\"#ffffff\">FILENAME</td>\r\n<td bgcolor=\"#ffffff\">当前输入文件的名字</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>怎么使用呢，比如：我们如果要输出行号：</p>\r\n<div>\r\n<div id=\"highlighter_330690\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">awk</code> <code class=\"bash string\">'$3==0 &amp;&amp; $6==\"ESTABLISHED\" || NR==1 {printf \"%02s %s %-20s %-20s %s\\n\",NR, FNR, $4,$5,$6}'</code> <code class=\"bash functions\">netstat</code><code class=\"bash plain\">.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">01 1 Local-Address        Foreign-Address      State</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">07 7 coolshell.cn:80      110.194.134.189:1032 ESTABLISHED</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">08 8 coolshell.cn:80      123.169.124.111:49809 ESTABLISHED</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">10 10 coolshell.cn:80      123.169.124.111:49829 ESTABLISHED</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">14 14 coolshell.cn:80      110.194.134.189:4796 ESTABLISHED</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash plain\">17 17 coolshell.cn:80      123.169.124.111:49840 ESTABLISHED</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<h5><strong>指定分隔符</strong></h5>\r\n<div>\r\n<div id=\"highlighter_431632\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$  </code><code class=\"bash functions\">awk</code>  <code class=\"bash string\">'BEGIN{FS=\":\"} {print $1,$3,$6}'</code> <code class=\"bash plain\">/etc/passwd</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">root 0 </code><code class=\"bash plain\">/root</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">bin 1 </code><code class=\"bash plain\">/bin</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">daemon 2 </code><code class=\"bash plain\">/sbin</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">adm 3 </code><code class=\"bash plain\">/var/adm</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">lp 4 </code><code class=\"bash plain\">/var/spool/lpd</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash functions\">sync</code> <code class=\"bash plain\">5 </code><code class=\"bash plain\">/sbin</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash functions\">shutdown</code> <code class=\"bash plain\">6 </code><code class=\"bash plain\">/sbin</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash plain\">halt 7 </code><code class=\"bash plain\">/sbin</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>上面的命令也等价于：（-F的意思就是指定分隔符）</p>\r\n<div>\r\n<div id=\"highlighter_296340\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">awk</code>  <code class=\"bash plain\">-F: </code><code class=\"bash string\">'{print $1,$3,$6}'</code> <code class=\"bash plain\">/etc/passwd</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>注：如果你要指定多个分隔符，你可以这样来：</p>\r\n<div>\r\n<div id=\"highlighter_870834\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash functions\">awk</code> <code class=\"bash plain\">-F </code><code class=\"bash string\">'[;:]'</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>再来看一个以\\t作为分隔符输出的例子（下面使用了/etc/passwd文件，这个文件是以:分隔的）：</p>\r\n<div>\r\n<div id=\"highlighter_949746\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">awk</code>  <code class=\"bash plain\">-F: </code><code class=\"bash string\">'{print $1,$3,$6}'</code> <code class=\"bash plain\">OFS=</code><code class=\"bash string\">\"\\t\"</code> <code class=\"bash plain\">/etc/passwd</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">root    0       </code><code class=\"bash plain\">/root</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">bin     1       </code><code class=\"bash plain\">/bin</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">daemon  2       </code><code class=\"bash plain\">/sbin</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">adm     3       </code><code class=\"bash plain\">/var/adm</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">lp      4       </code><code class=\"bash plain\">/var/spool/lpd</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash functions\">sync</code>    <code class=\"bash plain\">5       </code><code class=\"bash plain\">/sbin</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<h4>脱掉衬衫</h4>\r\n<h5>字符串匹配</h5>\r\n<p>我们再来看几个字符串匹配的示例：</p>\r\n<div>\r\n<div id=\"highlighter_7578\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1 highlighted\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n<div class=\"line number10 index9 alt1\">10</div>\r\n<div class=\"line number11 index10 alt2\">11</div>\r\n<div class=\"line number12 index11 alt1\">12</div>\r\n<div class=\"line number13 index12 alt2\">13</div>\r\n<div class=\"line number14 index13 alt1\">14</div>\r\n<div class=\"line number15 index14 alt2\">15</div>\r\n<div class=\"line number16 index15 alt1\">16</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">awk</code> <code class=\"bash string\">'$6 ~ /FIN/ || NR==1 {print NR,$4,$5,$6}'</code> <code class=\"bash plain\">OFS=</code><code class=\"bash string\">\"\\t\"</code> <code class=\"bash functions\">netstat</code><code class=\"bash plain\">.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">1       Local-Address   Foreign-Address State</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">6       coolshell.cn:80 61.140.101.185:37538    FIN_WAIT2</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">9       coolshell.cn:80 116.234.127.77:11502    FIN_WAIT2</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">13      coolshell.cn:80 124.152.181.209:26825   FIN_WAIT1</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">18      coolshell.cn:80 117.136.20.85:50025     FIN_WAIT2</code></div>\r\n<div class=\"line number7 index6 alt2\"> </div>\r\n<div class=\"line number8 index7 alt1 highlighted\"><code class=\"bash plain\">$ $ </code><code class=\"bash functions\">awk</code> <code class=\"bash string\">'$6 ~ /WAIT/ || NR==1 {print NR,$4,$5,$6}'</code> <code class=\"bash plain\">OFS=</code><code class=\"bash string\">\"\\t\"</code> <code class=\"bash functions\">netstat</code><code class=\"bash plain\">.txt</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash plain\">1       Local-Address   Foreign-Address State</code></div>\r\n<div class=\"line number10 index9 alt1\"><code class=\"bash plain\">5       coolshell.cn:80 124.205.5.146:18245     TIME_WAIT</code></div>\r\n<div class=\"line number11 index10 alt2\"><code class=\"bash plain\">6       coolshell.cn:80 61.140.101.185:37538    FIN_WAIT2</code></div>\r\n<div class=\"line number12 index11 alt1\"><code class=\"bash plain\">9       coolshell.cn:80 116.234.127.77:11502    FIN_WAIT2</code></div>\r\n<div class=\"line number13 index12 alt2\"><code class=\"bash plain\">11      coolshell.cn:80 183.60.215.36:36970     TIME_WAIT</code></div>\r\n<div class=\"line number14 index13 alt1\"><code class=\"bash plain\">13      coolshell.cn:80 124.152.181.209:26825   FIN_WAIT1</code></div>\r\n<div class=\"line number15 index14 alt2\"><code class=\"bash plain\">15      coolshell.cn:80 183.60.212.163:51082    TIME_WAIT</code></div>\r\n<div class=\"line number16 index15 alt1\"><code class=\"bash plain\">18      coolshell.cn:80 117.136.20.85:50025     FIN_WAIT2</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>上面的第一个示例匹配FIN状态， 第二个示例匹配WAIT字样的状态。其实 ~ 表示模式开始。/ /中是模式。这就是一个正则表达式的匹配。</p>\r\n<p>其实awk可以像grep一样的去匹配第一行，就像这样：</p>\r\n<div>\r\n<div id=\"highlighter_718821\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">awk</code> <code class=\"bash string\">'/LISTEN/'</code> <code class=\"bash functions\">netstat</code><code class=\"bash plain\">.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">tcp        0      0 0.0.0.0:3306            0.0.0.0:*               LISTEN</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">tcp        0      0 127.0.0.1:9000          0.0.0.0:*               LISTEN</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">tcp        0      0 :::22                   :::*                    LISTEN</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>我们可以使用 “/FIN|TIME/” 来匹配 FIN 或者 TIME :</p>\r\n<div>\r\n<div id=\"highlighter_165047\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">awk</code> <code class=\"bash string\">'$6 ~ /FIN|TIME/ || NR==1 {print NR,$4,$5,$6}'</code> <code class=\"bash plain\">OFS=</code><code class=\"bash string\">\"\\t\"</code> <code class=\"bash functions\">netstat</code><code class=\"bash plain\">.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">1       Local-Address   Foreign-Address State</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">5       coolshell.cn:80 124.205.5.146:18245     TIME_WAIT</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">6       coolshell.cn:80 61.140.101.185:37538    FIN_WAIT2</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">9       coolshell.cn:80 116.234.127.77:11502    FIN_WAIT2</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">11      coolshell.cn:80 183.60.215.36:36970     TIME_WAIT</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash plain\">13      coolshell.cn:80 124.152.181.209:26825   FIN_WAIT1</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">15      coolshell.cn:80 183.60.212.163:51082    TIME_WAIT</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash plain\">18      coolshell.cn:80 117.136.20.85:50025     FIN_WAIT2</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>再来看看模式取反的例子：</p>\r\n<div>\r\n<div id=\"highlighter_852055\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n<div class=\"line number10 index9 alt1\">10</div>\r\n<div class=\"line number11 index10 alt2\">11</div>\r\n<div class=\"line number12 index11 alt1\">12</div>\r\n<div class=\"line number13 index12 alt2\">13</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">awk</code> <code class=\"bash string\">'$6 !~ /WAIT/ || NR==1 {print NR,$4,$5,$6}'</code> <code class=\"bash plain\">OFS=</code><code class=\"bash string\">\"\\t\"</code> <code class=\"bash functions\">netstat</code><code class=\"bash plain\">.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">1       Local-Address   Foreign-Address State</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">2       0.0.0.0:3306    0.0.0.0:*       LISTEN</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">3       0.0.0.0:80      0.0.0.0:*       LISTEN</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">4       127.0.0.1:9000  0.0.0.0:*       LISTEN</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">7       coolshell.cn:80 110.194.134.189:1032    ESTABLISHED</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash plain\">8       coolshell.cn:80 123.169.124.111:49809   ESTABLISHED</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">10      coolshell.cn:80 123.169.124.111:49829   ESTABLISHED</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash plain\">12      coolshell.cn:80 61.148.242.38:30901     ESTABLISHED</code></div>\r\n<div class=\"line number10 index9 alt1\"><code class=\"bash plain\">14      coolshell.cn:80 110.194.134.189:4796    ESTABLISHED</code></div>\r\n<div class=\"line number11 index10 alt2\"><code class=\"bash plain\">16      coolshell.cn:80 208.115.113.92:50601    LAST_ACK</code></div>\r\n<div class=\"line number12 index11 alt1\"><code class=\"bash plain\">17      coolshell.cn:80 123.169.124.111:49840   ESTABLISHED</code></div>\r\n<div class=\"line number13 index12 alt2\"><code class=\"bash plain\">19      :::22   :::*    LISTEN</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>或是：</p>\r\n<div>\r\n<div id=\"highlighter_520992\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash functions\">awk</code> <code class=\"bash string\">'!/WAIT/'</code> <code class=\"bash functions\">netstat</code><code class=\"bash plain\">.txt</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p><strong>折分文件</strong></p>\r\n<p>awk拆分文件很简单，使用重定向就好了。下面这个例子，是按第6例分隔文件，相当的简单（其中的NR!=1表示不处理表头）。</p>\r\n<div>\r\n<div id=\"highlighter_518863\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n<div class=\"line number10 index9 alt1\">10</div>\r\n<div class=\"line number11 index10 alt2\">11</div>\r\n<div class=\"line number12 index11 alt1\">12</div>\r\n<div class=\"line number13 index12 alt2\">13</div>\r\n<div class=\"line number14 index13 alt1\">14</div>\r\n<div class=\"line number15 index14 alt2\">15</div>\r\n<div class=\"line number16 index15 alt1\">16</div>\r\n<div class=\"line number17 index16 alt2\">17</div>\r\n<div class=\"line number18 index17 alt1\">18</div>\r\n<div class=\"line number19 index18 alt2\">19</div>\r\n<div class=\"line number20 index19 alt1\">20</div>\r\n<div class=\"line number21 index20 alt2\">21</div>\r\n<div class=\"line number22 index21 alt1\">22</div>\r\n<div class=\"line number23 index22 alt2\">23</div>\r\n<div class=\"line number24 index23 alt1\">24</div>\r\n<div class=\"line number25 index24 alt2\">25</div>\r\n<div class=\"line number26 index25 alt1\">26</div>\r\n<div class=\"line number27 index26 alt2\">27</div>\r\n<div class=\"line number28 index27 alt1\">28</div>\r\n<div class=\"line number29 index28 alt2\">29</div>\r\n<div class=\"line number30 index29 alt1\">30</div>\r\n<div class=\"line number31 index30 alt2\">31</div>\r\n<div class=\"line number32 index31 alt1\">32</div>\r\n<div class=\"line number33 index32 alt2\">33</div>\r\n<div class=\"line number34 index33 alt1\">34</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">awk</code> <code class=\"bash string\">'NR!=1{print &gt; $6}'</code> <code class=\"bash functions\">netstat</code><code class=\"bash plain\">.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"> </div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">ls</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">ESTABLISHED  FIN_WAIT1  FIN_WAIT2  LAST_ACK  LISTEN  </code><code class=\"bash functions\">netstat</code><code class=\"bash plain\">.txt  TIME_WAIT</code></div>\r\n<div class=\"line number5 index4 alt2\"> </div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">cat</code> <code class=\"bash plain\">ESTABLISHED</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        110.194.134.189:1032        ESTABLISHED</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        123.169.124.111:49809       ESTABLISHED</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        123.169.124.111:49829       ESTABLISHED</code></div>\r\n<div class=\"line number10 index9 alt1\"><code class=\"bash plain\">tcp        0   4166 coolshell.cn:80        61.148.242.38:30901         ESTABLISHED</code></div>\r\n<div class=\"line number11 index10 alt2\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        110.194.134.189:4796        ESTABLISHED</code></div>\r\n<div class=\"line number12 index11 alt1\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        123.169.124.111:49840       ESTABLISHED</code></div>\r\n<div class=\"line number13 index12 alt2\"> </div>\r\n<div class=\"line number14 index13 alt1\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">cat</code> <code class=\"bash plain\">FIN_WAIT1</code></div>\r\n<div class=\"line number15 index14 alt2\"><code class=\"bash plain\">tcp        0      1 coolshell.cn:80        124.152.181.209:26825       FIN_WAIT1</code></div>\r\n<div class=\"line number16 index15 alt1\"> </div>\r\n<div class=\"line number17 index16 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">cat</code> <code class=\"bash plain\">FIN_WAIT2</code></div>\r\n<div class=\"line number18 index17 alt1\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        61.140.101.185:37538        FIN_WAIT2</code></div>\r\n<div class=\"line number19 index18 alt2\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        116.234.127.77:11502        FIN_WAIT2</code></div>\r\n<div class=\"line number20 index19 alt1\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        117.136.20.85:50025         FIN_WAIT2</code></div>\r\n<div class=\"line number21 index20 alt2\"> </div>\r\n<div class=\"line number22 index21 alt1\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">cat</code> <code class=\"bash plain\">LAST_ACK</code></div>\r\n<div class=\"line number23 index22 alt2\"><code class=\"bash plain\">tcp        0      1 coolshell.cn:80        208.115.113.92:50601        LAST_ACK</code></div>\r\n<div class=\"line number24 index23 alt1\"> </div>\r\n<div class=\"line number25 index24 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">cat</code> <code class=\"bash plain\">LISTEN</code></div>\r\n<div class=\"line number26 index25 alt1\"><code class=\"bash plain\">tcp        0      0 0.0.0.0:3306           0.0.0.0:*                   LISTEN</code></div>\r\n<div class=\"line number27 index26 alt2\"><code class=\"bash plain\">tcp        0      0 0.0.0.0:80             0.0.0.0:*                   LISTEN</code></div>\r\n<div class=\"line number28 index27 alt1\"><code class=\"bash plain\">tcp        0      0 127.0.0.1:9000         0.0.0.0:*                   LISTEN</code></div>\r\n<div class=\"line number29 index28 alt2\"><code class=\"bash plain\">tcp        0      0 :::22                  :::*                        LISTEN</code></div>\r\n<div class=\"line number30 index29 alt1\"> </div>\r\n<div class=\"line number31 index30 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">cat</code> <code class=\"bash plain\">TIME_WAIT</code></div>\r\n<div class=\"line number32 index31 alt1\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        124.205.5.146:18245         TIME_WAIT</code></div>\r\n<div class=\"line number33 index32 alt2\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        183.60.215.36:36970         TIME_WAIT</code></div>\r\n<div class=\"line number34 index33 alt1\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        183.60.212.163:51082        TIME_WAIT</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>你也可以把指定的列输出到文件：</p>\r\n<div>\r\n<div id=\"highlighter_186670\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash functions\">awk</code> <code class=\"bash string\">'NR!=1{print $4,$5 &gt; $6}'</code> <code class=\"bash functions\">netstat</code><code class=\"bash plain\">.txt</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>再复杂一点：（注意其中的if-else-if语句，可见awk其实是个脚本解释器）</p>\r\n<div>\r\n<div id=\"highlighter_636374\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n<div class=\"line number2 index1 alt1 highlighted\">2</div>\r\n<div class=\"line number3 index2 alt2 highlighted\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n<div class=\"line number10 index9 alt1\">10</div>\r\n<div class=\"line number11 index10 alt2\">11</div>\r\n<div class=\"line number12 index11 alt1\">12</div>\r\n<div class=\"line number13 index12 alt2\">13</div>\r\n<div class=\"line number14 index13 alt1\">14</div>\r\n<div class=\"line number15 index14 alt2\">15</div>\r\n<div class=\"line number16 index15 alt1\">16</div>\r\n<div class=\"line number17 index16 alt2\">17</div>\r\n<div class=\"line number18 index17 alt1\">18</div>\r\n<div class=\"line number19 index18 alt2\">19</div>\r\n<div class=\"line number20 index19 alt1\">20</div>\r\n<div class=\"line number21 index20 alt2\">21</div>\r\n<div class=\"line number22 index21 alt1\">22</div>\r\n<div class=\"line number23 index22 alt2\">23</div>\r\n<div class=\"line number24 index23 alt1\">24</div>\r\n<div class=\"line number25 index24 alt2\">25</div>\r\n<div class=\"line number26 index25 alt1\">26</div>\r\n<div class=\"line number27 index26 alt2\">27</div>\r\n<div class=\"line number28 index27 alt1\">28</div>\r\n<div class=\"line number29 index28 alt2\">29</div>\r\n<div class=\"line number30 index29 alt1\">30</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">awk</code> <code class=\"bash plain\">'NR!=1{</code><code class=\"bash keyword\">if</code><code class=\"bash plain\">($6 ~ </code><code class=\"bash plain\">/TIME</code><code class=\"bash plain\">|ESTABLISHED/) print &gt; </code><code class=\"bash string\">\"1.txt\"</code><code class=\"bash plain\">;</code></div>\r\n<div class=\"line number2 index1 alt1 highlighted\"><code class=\"bash keyword\">else</code> <code class=\"bash keyword\">if</code><code class=\"bash plain\">($6 ~ </code><code class=\"bash plain\">/LISTEN/</code><code class=\"bash plain\">) print &gt; </code><code class=\"bash string\">\"2.txt\"</code><code class=\"bash plain\">;</code></div>\r\n<div class=\"line number3 index2 alt2 highlighted\"><code class=\"bash keyword\">else</code> <code class=\"bash plain\">print &gt; </code><code class=\"bash string\">\"3.txt\"</code> <code class=\"bash plain\">}' </code><code class=\"bash functions\">netstat</code><code class=\"bash plain\">.txt</code></div>\r\n<div class=\"line number4 index3 alt1\"> </div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">ls</code> <code class=\"bash plain\">?.txt</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">1.txt  2.txt  3.txt</code></div>\r\n<div class=\"line number7 index6 alt2\"> </div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">cat</code> <code class=\"bash plain\">1.txt</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        124.205.5.146:18245         TIME_WAIT</code></div>\r\n<div class=\"line number10 index9 alt1\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        110.194.134.189:1032        ESTABLISHED</code></div>\r\n<div class=\"line number11 index10 alt2\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        123.169.124.111:49809       ESTABLISHED</code></div>\r\n<div class=\"line number12 index11 alt1\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        123.169.124.111:49829       ESTABLISHED</code></div>\r\n<div class=\"line number13 index12 alt2\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        183.60.215.36:36970         TIME_WAIT</code></div>\r\n<div class=\"line number14 index13 alt1\"><code class=\"bash plain\">tcp        0   4166 coolshell.cn:80        61.148.242.38:30901         ESTABLISHED</code></div>\r\n<div class=\"line number15 index14 alt2\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        110.194.134.189:4796        ESTABLISHED</code></div>\r\n<div class=\"line number16 index15 alt1\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        183.60.212.163:51082        TIME_WAIT</code></div>\r\n<div class=\"line number17 index16 alt2\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        123.169.124.111:49840       ESTABLISHED</code></div>\r\n<div class=\"line number18 index17 alt1\"> </div>\r\n<div class=\"line number19 index18 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">cat</code> <code class=\"bash plain\">2.txt</code></div>\r\n<div class=\"line number20 index19 alt1\"><code class=\"bash plain\">tcp        0      0 0.0.0.0:3306           0.0.0.0:*                   LISTEN</code></div>\r\n<div class=\"line number21 index20 alt2\"><code class=\"bash plain\">tcp        0      0 0.0.0.0:80             0.0.0.0:*                   LISTEN</code></div>\r\n<div class=\"line number22 index21 alt1\"><code class=\"bash plain\">tcp        0      0 127.0.0.1:9000         0.0.0.0:*                   LISTEN</code></div>\r\n<div class=\"line number23 index22 alt2\"><code class=\"bash plain\">tcp        0      0 :::22                  :::*                        LISTEN</code></div>\r\n<div class=\"line number24 index23 alt1\"> </div>\r\n<div class=\"line number25 index24 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">cat</code> <code class=\"bash plain\">3.txt</code></div>\r\n<div class=\"line number26 index25 alt1\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        61.140.101.185:37538        FIN_WAIT2</code></div>\r\n<div class=\"line number27 index26 alt2\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        116.234.127.77:11502        FIN_WAIT2</code></div>\r\n<div class=\"line number28 index27 alt1\"><code class=\"bash plain\">tcp        0      1 coolshell.cn:80        124.152.181.209:26825       FIN_WAIT1</code></div>\r\n<div class=\"line number29 index28 alt2\"><code class=\"bash plain\">tcp        0      1 coolshell.cn:80        208.115.113.92:50601        LAST_ACK</code></div>\r\n<div class=\"line number30 index29 alt1\"><code class=\"bash plain\">tcp        0      0 coolshell.cn:80        117.136.20.85:50025         FIN_WAIT2</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<h5>统计</h5>\r\n<p>下面的命令计算所有的C文件，CPP文件和H文件的文件大小总和。</p>\r\n<div>\r\n<div id=\"highlighter_762753\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">ls</code> <code class=\"bash plain\">-l  *.cpp *.c *.h | </code><code class=\"bash functions\">awk</code> <code class=\"bash string\">'{sum+=$5} END {print sum}'</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">2511401</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>我们再来看一个统计各个connection状态的用法：（我们可以看到一些编程的影子了，大家都是程序员我就不解释了。注意其中的数组的用法）</p>\r\n<div>\r\n<div id=\"highlighter_396900\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">awk</code> <code class=\"bash string\">'NR!=1{a[$6]++;} END {for (i in a) print i \", \" a[i];}'</code> <code class=\"bash functions\">netstat</code><code class=\"bash plain\">.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">TIME_WAIT, 3</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">FIN_WAIT1, 1</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">ESTABLISHED, 6</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">FIN_WAIT2, 3</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">LAST_ACK, 1</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash plain\">LISTEN, 4</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>再来看看统计每个用户的进程的占了多少内存（注：sum的RSS那一列）</p>\r\n<div>\r\n<div id=\"highlighter_251258\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">ps</code> <code class=\"bash plain\">aux | </code><code class=\"bash functions\">awk</code> <code class=\"bash string\">'NR!=1{a[$1]+=$6;} END { for(i in a) print i \", \" a[i]\"KB\";}'</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">dbus, 540KB</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">mysql, 99928KB</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">www, 3264924KB</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">root, 63644KB</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">hchen, 6020KB</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<h4>脱掉内衣</h4>\r\n<h5>awk脚本</h5>\r\n<p>在上面我们可以看到一个END关键字。END的意思是“处理完所有的行的标识”，即然说到了END就有必要介绍一下BEGIN，这两个关键字意味着执行前和执行后的意思，语法如下：</p>\r\n<ul>\r\n<li>BEGIN{ 这里面放的是执行前的语句 }</li>\r\n<li>END {这里面放的是处理完所有的行后要执行的语句 }</li>\r\n<li>{这里面放的是处理每一行时要执行的语句}</li>\r\n</ul>\r\n<p>为了说清楚这个事，我们来看看下面的示例：</p>\r\n<p>假设有这么一个文件（学生成绩表）：</p>\r\n<div>\r\n<div id=\"highlighter_168705\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">cat</code> <code class=\"bash plain\">score.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">Marry   2143 78 84 77</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">Jack    2321 66 78 45</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">Tom     2122 48 77 71</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">Mike    2537 87 97 95</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">Bob     2415 40 57 62</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>我们的awk脚本如下（我没有写有命令行上是因为命令行上不易读，另外也在介绍另一种用法）：</p>\r\n<div>\r\n<div id=\"highlighter_751256\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n<div class=\"line number10 index9 alt1\">10</div>\r\n<div class=\"line number11 index10 alt2\">11</div>\r\n<div class=\"line number12 index11 alt1\">12</div>\r\n<div class=\"line number13 index12 alt2\">13</div>\r\n<div class=\"line number14 index13 alt1\">14</div>\r\n<div class=\"line number15 index14 alt2\">15</div>\r\n<div class=\"line number16 index15 alt1\">16</div>\r\n<div class=\"line number17 index16 alt2\">17</div>\r\n<div class=\"line number18 index17 alt1\">18</div>\r\n<div class=\"line number19 index18 alt2\">19</div>\r\n<div class=\"line number20 index19 alt1\">20</div>\r\n<div class=\"line number21 index20 alt2\">21</div>\r\n<div class=\"line number22 index21 alt1\">22</div>\r\n<div class=\"line number23 index22 alt2\">23</div>\r\n<div class=\"line number24 index23 alt1\">24</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">cat</code> <code class=\"bash functions\">cal</code><code class=\"bash plain\">.</code><code class=\"bash functions\">awk</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash preprocessor bold\">#!/bin/awk -f</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash comments\">#运行前</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">BEGIN {</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash spaces\">    </code><code class=\"bash plain\">math = 0</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash spaces\">    </code><code class=\"bash plain\">english = 0</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash spaces\">    </code><code class=\"bash plain\">computer = 0</code></div>\r\n<div class=\"line number8 index7 alt1\"> </div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash spaces\">    </code><code class=\"bash functions\">printf</code> <code class=\"bash string\">\"NAME    NO.   MATH  ENGLISH  COMPUTER   TOTAL\\n\"</code></div>\r\n<div class=\"line number10 index9 alt1\"><code class=\"bash spaces\">    </code><code class=\"bash functions\">printf</code> <code class=\"bash string\">\"---------------------------------------------\\n\"</code></div>\r\n<div class=\"line number11 index10 alt2\"><code class=\"bash plain\">}</code></div>\r\n<div class=\"line number12 index11 alt1\"><code class=\"bash comments\">#运行中</code></div>\r\n<div class=\"line number13 index12 alt2\"><code class=\"bash plain\">{</code></div>\r\n<div class=\"line number14 index13 alt1\"><code class=\"bash spaces\">    </code><code class=\"bash plain\">math+=$3</code></div>\r\n<div class=\"line number15 index14 alt2\"><code class=\"bash spaces\">    </code><code class=\"bash plain\">english+=$4</code></div>\r\n<div class=\"line number16 index15 alt1\"><code class=\"bash spaces\">    </code><code class=\"bash plain\">computer+=$5</code></div>\r\n<div class=\"line number17 index16 alt2\"><code class=\"bash spaces\">    </code><code class=\"bash functions\">printf</code> <code class=\"bash string\">\"%-6s %-6s %4d %8d %8d %8d\\n\"</code><code class=\"bash plain\">, $1, $2, $3,$4,$5, $3+$4+$5</code></div>\r\n<div class=\"line number18 index17 alt1\"><code class=\"bash plain\">}</code></div>\r\n<div class=\"line number19 index18 alt2\"><code class=\"bash comments\">#运行后</code></div>\r\n<div class=\"line number20 index19 alt1\"><code class=\"bash plain\">END {</code></div>\r\n<div class=\"line number21 index20 alt2\"><code class=\"bash spaces\">    </code><code class=\"bash functions\">printf</code> <code class=\"bash string\">\"---------------------------------------------\\n\"</code></div>\r\n<div class=\"line number22 index21 alt1\"><code class=\"bash spaces\">    </code><code class=\"bash functions\">printf</code> <code class=\"bash string\">\"  TOTAL:%10d %8d %8d \\n\"</code><code class=\"bash plain\">, math, english, computer</code></div>\r\n<div class=\"line number23 index22 alt2\"><code class=\"bash spaces\">    </code><code class=\"bash functions\">printf</code> <code class=\"bash string\">\"AVERAGE:%10.2f %8.2f %8.2f\\n\"</code><code class=\"bash plain\">, math</code><code class=\"bash plain\">/NR</code><code class=\"bash plain\">, english</code><code class=\"bash plain\">/NR</code><code class=\"bash plain\">, computer</code><code class=\"bash plain\">/NR</code></div>\r\n<div class=\"line number24 index23 alt1\"><code class=\"bash plain\">}</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>我们来看一下执行结果：（也可以这样运行 ./cal.awk score.txt）</p>\r\n<div>\r\n<div id=\"highlighter_105913\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n<div class=\"line number10 index9 alt1\">10</div>\r\n<div class=\"line number11 index10 alt2\">11</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">awk</code> <code class=\"bash plain\">-f </code><code class=\"bash functions\">cal</code><code class=\"bash plain\">.</code><code class=\"bash functions\">awk</code> <code class=\"bash plain\">score.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">NAME    NO.   MATH  ENGLISH  COMPUTER   TOTAL</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">---------------------------------------------</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">Marry  2143     78       84       77      239</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">Jack   2321     66       78       45      189</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">Tom    2122     48       77       71      196</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash plain\">Mike   2537     87       97       95      279</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">Bob    2415     40       57       62      159</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash plain\">---------------------------------------------</code></div>\r\n<div class=\"line number10 index9 alt1\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">TOTAL:       319      393      350</code></div>\r\n<div class=\"line number11 index10 alt2\"><code class=\"bash plain\">AVERAGE:     63.80    78.60    70.00</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<h5>环境变量</h5>\r\n<p>即然说到了脚本，我们来看看怎么和环境变量交互：（使用-v参数和ENVIRON，使用ENVIRON的环境变量需要export）</p>\r\n<div>\r\n<div id=\"highlighter_786606\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2 highlighted\">9</div>\r\n<div class=\"line number10 index9 alt1\">10</div>\r\n<div class=\"line number11 index10 alt2\">11</div>\r\n<div class=\"line number12 index11 alt1\">12</div>\r\n<div class=\"line number13 index12 alt2\">13</div>\r\n<div class=\"line number14 index13 alt1\">14</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ x=5</code></div>\r\n<div class=\"line number2 index1 alt1\"> </div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">$ y=10</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">export</code> <code class=\"bash plain\">y</code></div>\r\n<div class=\"line number5 index4 alt2\"> </div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">echo</code> <code class=\"bash plain\">$x $y</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash plain\">5 10</code></div>\r\n<div class=\"line number8 index7 alt1\"> </div>\r\n<div class=\"line number9 index8 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">awk</code> <code class=\"bash plain\">-</code><code class=\"bash functions\">v</code> <code class=\"bash plain\">val=$x </code><code class=\"bash string\">'{print $1, $2, $3, $4+val, $5+ENVIRON[\"y\"]}'</code> <code class=\"bash plain\">OFS=</code><code class=\"bash string\">\"\\t\"</code> <code class=\"bash plain\">score.txt</code></div>\r\n<div class=\"line number10 index9 alt1\"><code class=\"bash plain\">Marry   2143    78      89      87</code></div>\r\n<div class=\"line number11 index10 alt2\"><code class=\"bash plain\">Jack    2321    66      83      55</code></div>\r\n<div class=\"line number12 index11 alt1\"><code class=\"bash plain\">Tom     2122    48      82      81</code></div>\r\n<div class=\"line number13 index12 alt2\"><code class=\"bash plain\">Mike    2537    87      102     105</code></div>\r\n<div class=\"line number14 index13 alt1\"><code class=\"bash plain\">Bob     2415    40      62      72</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<h4>几个花活</h4>\r\n<p>最后，我们再来看几个小例子：</p>\r\n<div>\r\n<div id=\"highlighter_532341\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash comments\">#从file文件中找出长度大于80的行</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash functions\">awk</code> <code class=\"bash string\">'length&gt;80'</code> <code class=\"bash functions\">file</code></div>\r\n<div class=\"line number3 index2 alt2\"> </div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash comments\">#按连接数查看客户端IP</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash functions\">netstat</code> <code class=\"bash plain\">-ntu | </code><code class=\"bash functions\">awk</code> <code class=\"bash string\">'{print $5}'</code> <code class=\"bash plain\">| </code><code class=\"bash functions\">cut</code> <code class=\"bash plain\">-d: -f1 | </code><code class=\"bash functions\">sort</code> <code class=\"bash plain\">| </code><code class=\"bash functions\">uniq</code> <code class=\"bash plain\">-c | </code><code class=\"bash functions\">sort</code> <code class=\"bash plain\">-nr</code></div>\r\n<div class=\"line number6 index5 alt1\"> </div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash comments\">#打印99乘法表</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash functions\">seq</code> <code class=\"bash plain\">9 | </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'H;g'</code> <code class=\"bash plain\">| </code><code class=\"bash functions\">awk</code> <code class=\"bash plain\">-</code><code class=\"bash functions\">v</code> <code class=\"bash plain\">RS=</code><code class=\"bash string\">''</code> <code class=\"bash string\">'{for(i=1;i&lt;=NF;i++)printf(\"%dx%d=%d%s\", i, NR, i*NR, i==NR?\"\\n\":\"\\t\")}'</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<h4>自己撸吧</h4>\r\n<p>关于其中的一些知识点可以参看<a href=\"http://www.gnu.org/software/gawk/manual/gawk.html\" target=\"_blank\">gawk的手册</a>：</p>\r\n<ul>\r\n<li>内建变量，参看：<a href=\"http://www.gnu.org/software/gawk/manual/gawk.html#Built_002din-Variables\" target=\"_blank\">http://www.gnu.org/software/gawk/manual/gawk.html#Built_002din-Variables</a></li>\r\n<li>流控方面，参看：<a href=\"http://www.gnu.org/software/gawk/manual/gawk.html#Statements\" target=\"_blank\">http://www.gnu.org/software/gawk/manual/gawk.html#Statements</a></li>\r\n<li>内建函数，参看：<a href=\"http://www.gnu.org/software/gawk/manual/gawk.html#Built_002din\" target=\"_blank\">http://www.gnu.org/software/gawk/manual/gawk.html#Built_002din</a></li>\r\n<li>正则表达式，参看：<a href=\"http://www.gnu.org/software/gawk/manual/gawk.html#Regexp\" target=\"_blank\">http://www.gnu.org/software/gawk/manual/gawk.html#Regexp</a></li>\r\n</ul>\r\n<p>（全文完）</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-14 15:35</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4503493\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4503493);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4503493,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/14 15:35:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4503493.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=21", "desc": "摘要: 本文转自：http://coolshell.cn/articles/9070.html有一些网友看了前两天的《Linux下应该知道的技巧》希望我能教教他们用awk和sed，所以，出现了这篇文章。我估计这些80后的年轻朋友可能对awk/sed这类上古神器有点陌生了，所以需要我这个老家伙来炒炒冷饭。..."}
{"title": "我常用的那些linux命令", "content": "我常用的那些linux命令\r\n　　用linux也有些年头了，说来也忏愧，说是有些年头了，其实也还是个不长进的主。记得第一次接触linux是boss跟我说的怎么操作，什么编辑模式，按i，a，o进入编辑模式。在一个黑乎乎的窗口下不知道怎么胡乱编辑一通。那时的我说来也真是初生牛犊不怕虎呀，对linux一窍不通居然可以找到工作。想想除了那份势必找份工作养活自己而被就业的心是如此的强大呀！在这个互联网信息泛滥的时代，我写的这些东西势必已经有前辈已经写过了。在此重复与其是分享，倒不如说是自己的笔记本，仅此而已。一篇随着时间推移而不断更新的文章。\r\n\r\n安装软件：源码安装（./configure、make、make test、make install、make uninstall）、yum 安装、rpm安装\r\nLinux压缩和解压汇总\r\nvi vim\r\nfind\r\nps：查看进程\r\n\r\n　　　　ps -ef|grep mysql\r\n\r\ngrep\r\ncrontab\r\nchown：更改用户、用户组\r\n\r\n　　　　chown -R www:www /www\r\n\r\nchmod：更改文件权限\r\n\r\n　　　　chmod +x /www\r\n\r\nchkconfig\r\nservice：重启服务\r\n\r\n　　　　service httpd restart 重启\r\n　　　　service httpd start 启动\r\n　　　　service httpd stop 停止\r\n\r\nln：建立链接\r\nlocate：查看文件位置\r\n\r\n　　　　locate 文件名\r\n\r\nwhereis：查看文件位置\r\n\r\n　　　　whereis 文件名\r\n\r\nsed\r\n\r\n同时替换多个值（同时替换[和]）\r\n\r\n#保存到新文件\r\nsed \"s/\\[\\|\\]//g\" tencent.json >tencent2.json\r\n#直接修改源文件\r\nsed -i \"s/\\[\\|\\]//g\" tencent.json\r\n\r\n\r\nawk\r\niptables\r\nldd 这个命令可以知道你的一个可执行文件所使用了动态链接库。如：ldd /usr/bin/java，则为查看java以来的动态链接库\r\n\r\nlsof 可以列出打开了的文件。\r\n\r\nsplit 将一个大文件分割成若干个小文件\r\nuname -a ，uname -r ， cat /proc/version 三个命令均可查看内核版本\r\n\r\n\r\n[root@bogon ~]# uname -a\r\nLinux bogon 2.6.32-71.el6.i686 #1 SMP Fri Nov 12 04:17:17 GMT 2010 i686 i686 i386 GNU/Linux\r\n[root@bogon ~]# uname -r\r\n2.6.32-71.el6.i686\r\n[root@bogon ~]# cat /proc/version\r\nLinux version 2.6.32-71.el6.i686 (mockbuild@c6b5.bsys.dev.centos.org) (gcc version 4.4.4 20100726 (Red Hat 4.4.4-13) (GCC) ) #1 SMP Fri Nov 12 04:17:17 GMT 2010\r\n[root@bogon ~]# \r\n\r\n\r\n查看磁盘剩余空间\r\n\r\ndf -k -->显示为字节df -h -->显示为具体单位。\r\n查看系统指定挂载点文件的大小df -lh /var\r\n查看指定目录下每个文件夹的大小du -sh /var/www/*\r\n\r\n查看环境变量：env\r\nshell脚本日志输出设置\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n>/dev/null &\r\n\r\n此种方式下错误日志仍然会输出到屏幕。\r\n\r\n>/dev/null 2>/dev/null &\r\n\r\n此种方式下所有日志都不输出到屏幕\r\n\r\n\r\n 查看文件\r\n\r\ncat 文件名：文件内容一次性显示\r\ntail [-行数|-f] 文件名：“-行数”，从文件末尾往前显示指定行数；如tail -100 文件名，表示输出文件末尾100行。“-f”，检测文件是否更新，将更新的内容输出。直到退出该命令为止\r\nhead 行数：从文件头部开始获取指定行数\r\nmore 文件名：分页输出显示内容\r\n\r\n带目录结构复制\r\n\r\n\r\ncp -rfP source target\r\n\r\n ", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>我常用的那些linux命令 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4502348.html\">我常用的那些linux命令</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>我常用的那些linux命令</p>\r\n<p>　　用linux也有些年头了，说来也忏愧，说是有些年头了，其实也还是个不长进的主。记得第一次接触linux是boss跟我说的怎么操作，什么编辑模式，按i，a，o进入编辑模式。在一个黑乎乎的窗口下不知道怎么胡乱编辑一通。那时的我说来也真是初生牛犊不怕虎呀，对linux一窍不通居然可以找到工作。想想除了那份势必找份工作养活自己而被就业的心是如此的强大呀！在这个互联网信息泛滥的时代，我写的这些东西势必已经有前辈已经写过了。在此重复与其是分享，倒不如说是自己的笔记本，仅此而已。一篇随着时间推移而不断更新的文章。</p>\r\n<ul>\r\n<li><strong>安装软件：源码安装（./configure、make、make test、make install、make uninstall）、yum 安装、rpm安装</strong></li>\r\n<li><strong><a class=\"titlelink\" href=\"http://www.cnblogs.com/rwxwsblog/p/4505934.html\" target=\"_blank\">Linux压缩和解压汇总</a></strong></li>\r\n<li><a title=\"vi命令\" href=\"http://www.cnblogs.com/rwxwsblog/p/4502807.html\" target=\"_blank\"><strong>vi vim</strong></a></li>\r\n<li><a href=\"http://www.cnblogs.com/rwxwsblog/p/4505949.html\" target=\"_blank\"><strong>find</strong></a></li>\r\n<li><strong>ps：查看进程</strong></li>\r\n</ul>\r\n<p>　　　　ps -ef|grep mysql</p>\r\n<ul>\r\n<li><a href=\"http://www.cnblogs.com/rwxwsblog/p/4507576.html\" target=\"_blank\"><strong>grep</strong></a></li>\r\n<li><a href=\"http://www.cnblogs.com/rwxwsblog/p/4505574.html\" target=\"_blank\"><strong>crontab</strong></a></li>\r\n<li><strong>chown：更改用户、用户组</strong></li>\r\n</ul>\r\n<p>　　　　chown -R www:www /www</p>\r\n<ul>\r\n<li><strong>chmod：更改文件权限</strong></li>\r\n</ul>\r\n<p>　　　　chmod +x /www</p>\r\n<ul>\r\n<li>chkconfig</li>\r\n<li><strong>service：重启服务</strong></li>\r\n</ul>\r\n<p>　　　　service httpd restart 重启</p>\r\n<p>　　　　service httpd start 启动</p>\r\n<p>　　　　service httpd stop 停止</p>\r\n<ul>\r\n<li><strong>ln：建立链接</strong></li>\r\n<li><strong>locate：查看文件位置</strong></li>\r\n</ul>\r\n<p>　　　　locate 文件名</p>\r\n<ul>\r\n<li><strong>whereis：查看文件位置</strong></li>\r\n</ul>\r\n<p>　　　　whereis 文件名</p>\r\n<ul>\r\n<li><a href=\"http://www.cnblogs.com/rwxwsblog/p/4501599.html\" target=\"_blank\">sed</a></li>\r\n</ul>\r\n<p style=\"margin-left: 30px;\">同时替换多个值（同时替换[和]）</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #000000;\">#保存到新文件\r\n</span><span style=\"color: #0000ff;\">sed</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">s/\\[\\|\\]//g</span><span style=\"color: #800000;\">\"</span> tencent.json &gt;<span style=\"color: #000000;\">tencent2.json\r\n#直接修改源文件\r\n</span><span style=\"color: #0000ff;\">sed</span> -i <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">s/\\[\\|\\]//g</span><span style=\"color: #800000;\">\"</span> tencent.json</pre>\r\n</div>\r\n<ul>\r\n<li><a href=\"http://www.cnblogs.com/rwxwsblog/p/4503493.html\" target=\"_blank\">awk</a></li>\r\n<li>iptables</li>\r\n<li><strong>ldd </strong>这个命令可以知道你的一个可执行文件所使用了动态链接库。如：ldd /usr/bin/java，则为查看java以来的动态链接库</li>\r\n<li>\r\n<p><strong>lsof </strong>可以列出打开了的文件。</p>\r\n</li>\r\n<li><strong>split</strong> 将一个大文件分割成若干个小文件</li>\r\n<li><strong>uname -a ，uname -r ， cat /proc/version</strong> 三个命令均可查看内核版本</li>\r\n</ul>\r\n<div class=\"cnblogs_code\">\r\n<pre>[root@bogon ~]# <span style=\"color: #0000ff;\">uname</span> -<span style=\"color: #000000;\">a\r\nLinux bogon </span><span style=\"color: #800080;\">2.6</span>.<span style=\"color: #800080;\">32</span>-<span style=\"color: #800080;\">71</span>.el6.i686 #<span style=\"color: #800080;\">1</span> SMP Fri Nov <span style=\"color: #800080;\">12</span> <span style=\"color: #800080;\">04</span>:<span style=\"color: #800080;\">17</span>:<span style=\"color: #800080;\">17</span> GMT <span style=\"color: #800080;\">2010</span> i686 i686 i386 GNU/<span style=\"color: #000000;\">Linux\r\n[root@bogon </span>~]# <span style=\"color: #0000ff;\">uname</span> -<span style=\"color: #000000;\">r\r\n</span><span style=\"color: #800080;\">2.6</span>.<span style=\"color: #800080;\">32</span>-<span style=\"color: #800080;\">71</span><span style=\"color: #000000;\">.el6.i686\r\n[root@bogon </span>~]# <span style=\"color: #0000ff;\">cat</span> /proc/<span style=\"color: #000000;\">version\r\nLinux version </span><span style=\"color: #800080;\">2.6</span>.<span style=\"color: #800080;\">32</span>-<span style=\"color: #800080;\">71</span>.el6.i686 (mockbuild@c6b5.bsys.dev.centos.org) (<span style=\"color: #0000ff;\">gcc</span> version <span style=\"color: #800080;\">4.4</span>.<span style=\"color: #800080;\">4</span> <span style=\"color: #800080;\">20100726</span> (Red Hat <span style=\"color: #800080;\">4.4</span>.<span style=\"color: #800080;\">4</span>-<span style=\"color: #800080;\">13</span>) (GCC) ) #<span style=\"color: #800080;\">1</span> SMP Fri Nov <span style=\"color: #800080;\">12</span> <span style=\"color: #800080;\">04</span>:<span style=\"color: #800080;\">17</span>:<span style=\"color: #800080;\">17</span> GMT <span style=\"color: #800080;\">2010</span><span style=\"color: #000000;\">\r\n[root@bogon </span>~]# </pre>\r\n</div>\r\n<ul>\r\n<li>查看磁盘剩余空间</li>\r\n</ul>\r\n<p>df -k --&gt;显示为字节<br>df -h --&gt;显示为具体单位。</p>\r\n<p><br>查看系统指定挂载点文件的大小<br>df -lh /var</p>\r\n<p>查看指定目录下每个文件夹的大小<br>du -sh /var/www/*</p>\r\n<ul>\r\n<li>查看环境变量：env</li>\r\n<li>shell脚本日志输出设置</li>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n</ul>\r\n<div class=\"cnblogs_code\">\r\n<pre>&gt;/dev/<span style=\"color: #0000ff;\">null</span> &amp;<span style=\"color: #000000;\">\r\n\r\n此种方式下错误日志仍然会输出到屏幕。\r\n\r\n</span>&gt;/dev/<span style=\"color: #0000ff;\">null</span> <span style=\"color: #800080;\">2</span>&gt;/dev/<span style=\"color: #0000ff;\">null</span> &amp;<span style=\"color: #000000;\">\r\n\r\n此种方式下所有日志都不输出到屏幕</span></pre>\r\n</div>\r\n<ul>\r\n<li> 查看文件</li>\r\n</ul>\r\n<p>cat 文件名：文件内容一次性显示</p>\r\n<p>tail [-行数|-f] 文件名：“-行数”，从文件末尾往前显示指定行数；如tail -100 文件名，表示输出文件末尾100行。“-f”，检测文件是否更新，将更新的内容输出。直到退出该命令为止</p>\r\n<p>head 行数：从文件头部开始获取指定行数</p>\r\n<p>more 文件名：分页输出显示内容</p>\r\n<ul>\r\n<li>带目录结构复制</li>\r\n</ul>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">cp</span> -rfP source target</pre>\r\n</div>\r\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-14 11:29</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4502348\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4502348);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4502348,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/14 11:29:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4502348.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=21", "desc": "摘要: 我常用的那些linux命令 用linux也有些年头了，说来也忏愧，说是有些年头了，其实也还是个不长进的主。记得第一次接触linux是boss跟我说的怎么操作，什么编辑模式，按i，a，o进入编辑模式。在一个黑乎乎的窗口下不知道怎么胡乱编辑一通。那时的我说来也真是初生牛犊不怕虎呀，对linux一窍不通居"}
{"title": "我常用的Vi命令", "content": "　　Vi对于linux的重要性和受欢迎的程度在此一律不表。此刻互联网上不少介绍vi的文章和博客，相信写得比我好的也不在少数。然而为什么我依然写这样一篇文章呢？我对linux知识和了解也都来自于互联网，很难想象在没有互联网的情况下我能不能学会这些最基本的操作。其实用linux也有些年头了，但基本也就停留在小白的阶段。常常抱着够用就行的心态，因而学懂那几行常用的命令后也就再没有深入地了解了。常听人说起，写和讲是为了更好地学。由于各种原因，也有段时间没用vi了。当用起的时候常常会有个印象但又不确定，因而常常GG也就少不了了。与其GG，不如自己记录起来偶尔翻翻。与其说是一篇文章倒不如说是我的私人笔记，文章全然凭自己的理解，写得不明白或者有误的地方也请指出。在我对Vi没有彻底熟烂于心之前，这都是一篇尚未完成的文章。\r\nvi 创建并编辑文件\r\n\r\nvi test.txt\r\n\r\n\r\n i 、a 、o 命令\r\n\r\n按i、a或者o进入编辑模式\r\n然后输入\r\nthis is a test file!\r\n\r\nesc 退出编辑模式\r\n\r\n按键盘又上角的“esc”键退出编辑模式\r\n\r\n yy 复制和p粘贴\r\n\r\n现在复制上面的行并粘贴，输入“yy”复制，然后输入“p”完成粘贴\r\nthis is a test file!this is a test file!this is a test file!this is a test file!\r\n\r\nset:number（set:num）显示行号和set:nonumber（set:nonum）取消行号：\r\n\r\n\r\n\r\n\r\n 1 this is a test file!      2 this is a test file!      3 this is a test file!      4 this is a test file!\r\n\r\n:number，\r\n\r\n\r\n\r\n\r\n将光标移到指定行号\r\n\r\n【 /需要查找的内容】 查找字符串，首次查找后输入“n”即可循环查找字符串\r\n\r\n\r\n\r\n\r\n输入“/test”即可查找test这个字符串了，按“n”即可查找下一个想匹配的字符串\r\n\r\n x 删除光标后的字符，X 删除光标前的字符（与 x 的用法一致）， dd 删除行\r\n\r\n\r\n\r\n\r\nx可删除光标后面的字符，5x表示删除光标后的5个字符。同理dd可删除光标所在行，5dd则是删除光标后的5行（包含光标所在行）\r\n\r\nr 替换光标处的字符，R替换光标所到指出的字符，直到按下ESC键为止\r\n u 撤销上一次编辑的内容\r\n\r\n\r\n\r\n\r\nundo上一次改变。\r\n\r\n U 撤销当前行编辑的内容\r\n\r\n\r\n\r\n\r\nundo当前行所有的改变。\r\n\r\n Ctrl + R  恢复撤销的内容\r\n\r\n\r\n\r\n\r\nredo被undo了的改变。\r\n\r\n ^ 将光标移到行首和 $ 将光标移到行尾\r\n gg 回到文档开始的地方\r\n\r\n\r\n\r\n\r\n\r\nCtrl+f\r\n\r\n\r\n\r\n\r\n向前翻屏\r\n\r\nCtrl+b\r\n\r\n\r\n\r\n\r\n向后翻屏\r\n\r\nCtrl+d\r\n\r\n\r\n\r\n\r\n向前翻半屏\r\n\r\nCtrl+u\r\n\r\n\r\n\r\n\r\n向后翻半屏\r\n\r\n保存退出： :x 或 :wq 保存并退出，输入： :q! 不保存退出，:w filename 指定filename保存并退出。\r\n查看文件的十六进制： :%!xxd，与 od  -t x1 filename 的效果一致\r\n\r\n\r\n\r\n\r\n批量替换内容\r\n　　:%s/原有内容/新内容/g", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>我常用的Vi命令 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4502807.html\">我常用的Vi命令</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>　　Vi对于linux的重要性和受欢迎的程度在此一律不表。此刻互联网上不少介绍vi的文章和博客，相信写得比我好的也不在少数。然而为什么我依然写这样一篇文章呢？我对linux知识和了解也都来自于互联网，很难想象在没有互联网的情况下我能不能学会这些最基本的操作。其实用linux也有些年头了，但基本也就停留在小白的阶段。常常抱着够用就行的心态，因而学懂那几行常用的命令后也就再没有深入地了解了。常听人说起，写和讲是为了更好地学。由于各种原因，也有段时间没用vi了。当用起的时候常常会有个印象但又不确定，因而常常GG也就少不了了。与其GG，不如自己记录起来偶尔翻翻。与其说是一篇文章倒不如说是我的私人笔记，文章全然凭自己的理解，写得不明白或者有误的地方也请指出。在我对Vi没有彻底熟烂于心之前，这都是一篇尚未完成的文章。</p>\r\n<p>vi 创建并编辑文件</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">vi</span> test.txt</pre>\r\n</div>\r\n<ul>\r\n<li><span style=\"line-height: 1.5;\"> i 、a 、o 命令</span></li>\r\n</ul>\r\n<p><span style=\"line-height: 1.5;\">按i、a或者o进入编辑模式</span></p>\r\n<p>然后输入</p>\r\n<p>this is a test file!</p>\r\n<ul>\r\n<li>esc 退出编辑模式</li>\r\n</ul>\r\n<p><span style=\"color: #ff0000;\"><strong>按键盘又上角的“esc”键退出编辑模式</strong></span></p>\r\n<ul>\r\n<li> yy 复制和p粘贴</li>\r\n</ul>\r\n<p>现在复制上面的行并粘贴，输入“yy”复制，然后输入“p”完成粘贴</p>\r\n<p>this is a test file!<br>this is a test file!<br>this is a test file!<br>this is a test file!</p>\r\n<ul>\r\n<li>set:number（set:num）显示行号和set:nonumber（set:nonum）取消行号：</li>\r\n\r\n\r\n\r\n</ul>\r\n<p> 1 this is a test file!<br>      2 this is a test file!<br>      3 this is a test file!<br>      4 this is a test file!</p>\r\n<ul>\r\n<li>:number，</li>\r\n\r\n\r\n\r\n</ul>\r\n<p>将光标移到指定行号</p>\r\n<ul>\r\n<li>【 /需要查找的内容】 查找字符串，首次查找后输入“n”即可循环查找字符串</li>\r\n\r\n\r\n\r\n</ul>\r\n<p>输入“/test”即可查找test这个字符串了，按“n”即可查找下一个想匹配的字符串</p>\r\n<ul>\r\n<li> x 删除光标后的字符，X 删除光标前的字符（与 x 的用法一致）， dd 删除行</li>\r\n\r\n\r\n\r\n</ul>\r\n<p>x可删除光标后面的字符，5x表示删除光标后的5个字符。同理dd可删除光标所在行，5dd则是删除光标后的5行（包含光标所在行）</p>\r\n<ul>\r\n<li>r 替换光标处的字符，R替换光标所到指出的字符，直到按下ESC键为止</li>\r\n<li> u 撤销上一次编辑的内容</li>\r\n\r\n\r\n\r\n</ul>\r\n<p>undo上一次改变。</p>\r\n<ul>\r\n<li> U 撤销当前行编辑的内容</li>\r\n\r\n\r\n\r\n</ul>\r\n<p>undo当前行所有的改变。</p>\r\n<ul>\r\n<li> Ctrl + R  恢复撤销的内容</li>\r\n\r\n\r\n\r\n</ul>\r\n<p>redo被undo了的改变。</p>\r\n<ul>\r\n<li> ^ 将光标移到行首和 $ 将光标移到行尾</li>\r\n<li> gg 回到文档开始的地方</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li>Ctrl+f</li>\r\n\r\n\r\n\r\n</ul>\r\n<p align=\"left\">向前翻屏</p>\r\n<ul>\r\n<li>Ctrl+b</li>\r\n\r\n\r\n\r\n</ul>\r\n<p align=\"left\">向后翻屏</p>\r\n<ul>\r\n<li>Ctrl+d</li>\r\n\r\n\r\n\r\n</ul>\r\n<p align=\"left\">向前翻半屏</p>\r\n<ul>\r\n<li>Ctrl+u</li>\r\n\r\n\r\n\r\n</ul>\r\n<p align=\"left\">向后翻半屏</p>\r\n<ul>\r\n<li>保存退出：<span style=\"line-height: 1.5;\"> :x 或 :wq 保存并退出，输入： :q! 不保存退出，:w filename 指定filename保存并退出。</span></li>\r\n<li><span style=\"line-height: 1.5;\">查看文件的十六进制： :%!xxd，与 od  -t x1 filename 的效果一致</span></li>\r\n\r\n\r\n\r\n</ul>\r\n<p><span style=\"line-height: 1.5;\">批量替换内容</span></p>\r\n<p><span style=\"line-height: 1.5;\">　　:%s/原有内容/新内容/g</span></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-14 11:08</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4502807\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4502807);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4502807,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/14 11:08:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4502807.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=21", "desc": "摘要: Vi对于linux的重要性和受欢迎的程度在此一律不表。此刻互联网上不少介绍vi的文章和博客，相信写得比我好的也不在少数。然而为什么我依然写这样一篇文章呢？我对linux知识和了解也都来自于互联网，很难想象在没有互联网的情况下我能不能学会这些最基本的操作。其实用linux也有些年头了，但基本也就停留在"}
{"title": "php在没用xdebug等调试工具的情况下如何让调试内容优雅地展现出来？--php数组格式化", "content": "　　不知道各位猿猿们有没有碰到过类似的情况。装的PHP环境没有xdebug，而又经常用到数组。调试的时候也需要经常查看数组的结构和字段内容，用var_dump打印出来的数组内容总是杂乱无章。实在无法忍受，因而网上找了个格式化数组的方法，分享给大家。也再次感谢可爱的前辈们。\r\n\r\n/**\r\n* [dump_array 将数组内容格式化输出]\r\n* @param array $vars [数组]\r\n* @param string $label [分隔符]\r\n* @param boolean $return [是否返回结果]\r\n* @return [type] [description]\r\n*/\r\nfunction dump_array($vars, $label = '', $return = false) {\r\n　　if (ini_get('html_errors')) {\r\n　　　　$content = \"<pre>\\n\";\r\n　　　　if ($label != '') {\r\n　　　　　　$content .= \"<strong>{$label} :</strong>\\n\";\r\n　　　　}\r\n　　　　$content .= htmlspecialchars(print_r($vars, true));\r\n　　　　$content .= \"\\n</pre>\\n\";\r\n　　} else {\r\n　　　　$content = $label . \" :\\n\" . print_r($vars, true);\r\n　　}\r\n　　if ($return) { return $content; }\r\n　　echo $content;\r\n　　return null;\r\n}\r\n\r\n用上它，打印出来的数组不再是一坨shit了，而是优雅抚媚地展现在你的面前。", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>php在没用xdebug等调试工具的情况下如何让调试内容优雅地展现出来？--php数组格式化 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4490951.html\">php在没用xdebug等调试工具的情况下如何让调试内容优雅地展现出来？--php数组格式化</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>　　不知道各位猿猿们有没有碰到过类似的情况。装的PHP环境没有xdebug，而又经常用到数组。调试的时候也需要经常查看数组的结构和字段内容，用var_dump打印出来的数组内容总是杂乱无章。实在无法忍受，因而网上找了个格式化数组的方法，分享给大家。也再次感谢可爱的前辈们。</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">*\r\n* [dump_array 将数组内容格式化输出]\r\n* @param array $vars [数组]\r\n* @param string $label [分隔符]\r\n* @param boolean $return [是否返回结果]\r\n* @return [type] [description]\r\n</span><span style=\"color: #008000;\">*/</span>\r\n<span style=\"color: #0000ff;\">function</span> dump_array(<span style=\"color: #800080;\">$vars</span>, <span style=\"color: #800080;\">$label</span> = '', <span style=\"color: #800080;\">$return</span> = <span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">) {\r\n　　</span><span style=\"color: #0000ff;\">if</span> (<span style=\"color: #008080;\">ini_get</span>('html_errors'<span style=\"color: #000000;\">)) {\r\n　　　　</span><span style=\"color: #800080;\">$content</span> = \"&lt;pre&gt;\\n\"<span style=\"color: #000000;\">;\r\n　　　　</span><span style=\"color: #0000ff;\">if</span> (<span style=\"color: #800080;\">$label</span> != ''<span style=\"color: #000000;\">) {\r\n　　　　　　</span><span style=\"color: #800080;\">$content</span> .= \"&lt;strong&gt;{<span style=\"color: #800080;\">$label</span>} :&lt;/strong&gt;\\n\"<span style=\"color: #000000;\">;\r\n　　　　}\r\n　　　　</span><span style=\"color: #800080;\">$content</span> .= <span style=\"color: #008080;\">htmlspecialchars</span>(<span style=\"color: #008080;\">print_r</span>(<span style=\"color: #800080;\">$vars</span>, <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">));\r\n　　　　</span><span style=\"color: #800080;\">$content</span> .= \"\\n&lt;/pre&gt;\\n\"<span style=\"color: #000000;\">;\r\n　　} </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\"> {\r\n　　　　</span><span style=\"color: #800080;\">$content</span> = <span style=\"color: #800080;\">$label</span> . \" :\\n\" . <span style=\"color: #008080;\">print_r</span>(<span style=\"color: #800080;\">$vars</span>, <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">);\r\n　　}\r\n　　</span><span style=\"color: #0000ff;\">if</span> (<span style=\"color: #800080;\">$return</span>) { <span style=\"color: #0000ff;\">return</span> <span style=\"color: #800080;\">$content</span><span style=\"color: #000000;\">; }\r\n　　</span><span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800080;\">$content</span><span style=\"color: #000000;\">;\r\n　　</span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">;\r\n}</span></pre>\r\n</div>\r\n<p style=\"margin-left: 30px;\">用上它，打印出来的数组不再是一坨shit了，而是优雅抚媚地展现在你的面前。</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-09 19:47</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4490951\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4490951);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4490951,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/9 19:47:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4490951.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=21", "desc": "摘要: php在没有采用xdebug进行调试的时候，用var_dump打印出来的数组总感觉是一坨坨shit。打印出来数组元素的内容既不美观也看不出数组的结构，再加之代码洁癖的原因。网上找了一下，随之调试的数组内容就优雅地展现在你面前了。不再是一坨坨恶心的shit。"}
{"title": "利用chrome插件批量读取浏览器页面内容并写入数据库", "content": "　　试想一下，如果每天要收集100页网页数据甚至更多。如果采用人工收集会吐血，用程序去收集也就成为一个不二的选择。首先肯定会想到说用java、php、C#等高级语言，但这偏偏又有个登陆和验证码，搞到无所适从。还在为收集web端的数据感到苦恼吗？很高兴，你找对地方了。\r\n　　应用场景：\r\n　　　　1、需要每天大量重复收集web端的数据\r\n　　　　2、web页面数据需要登陆后才能采集\r\n　　　　3、web页面存在翻页\r\n　　解决方案：\r\n　　　　手工登陆，然后采用chrome插件的方式进行收集。当然你会说用selenium等自动化测试的方法进行收集更cool，而且可以每天自动收集，完全的自动化不用人工参与。但是作为chrome的忠实脑残粉，再者只需要前端的js、服务器端的接收文件、数据库就可以完美解决这一问题。再加上部署和操作简单。 脑残粉总有很多理由的嘛。好吧，就算是一种憋屈的曲线救国和实现方式吧。\r\n　　思路：\r\n　　　　\r\n帮助手册：http://open.chrome.360.cn/extension_dev/overview.html\r\n实例：\r\n\r\n抓取某电商后台订单数据\r\n1、创建一个项目文件夹并引入所需文件：如D:\\tool\\chrome_server_plugin\r\n　　jquery-2.1.1.min.js、icon.png\r\n2、创建background.html\r\n\r\n<html><head>\r\n</head></html>\r\n\r\n3、创建配置文件manifest.json文件\r\n\r\n{\r\n\r\n\"name\": \"获取某电商后台订单信息\",\r\n\"version\": \"1.0\",\r\n\"manifest_version\": 2,\r\n\"description\": \"*********获取某电商后台订单信息*********\",\r\n\"browser_action\": {\r\n\"default_icon\": \"icon.png\"\r\n},\r\n\"permissions\": [\r\n\"webNavigation\",\r\n\"tabs\",\r\n\"contextMenus\",\r\n\"http://服务器接受数据url/\"\r\n],\r\n\"background\": {\r\n\"scripts\": [\"eventPage.js\",\"jquery-2.1.1.min.js\"]\r\n},\r\n\"content_scripts\": [\r\n{\r\n\"matches\": [\"http://抓取页面url/*\"],\r\n\"js\": [\"jquery-2.1.1.min.js\", \"contentscript.js\"]\r\n}\r\n]\r\n}\r\n\r\n4、创建前端js文件contentscript.js\r\n\r\nvar totalPage;\r\nvar page = 0;\r\n//注册前台页面监听事件\r\nchrome.extension.onMessage.addListener(\r\n　　function(request, sender, sendResponse) {\r\n　　　　totalPage = $(\"input[name=totalPage]\").val();\r\n　　　　console.log(\"totalPage----------\" + totalPage);\r\n　　　　//console.log(\"msg----------contentscript.js\" + request.greeting);\r\n　　　　getOrderInfo( sendResponse );\r\n　　});\r\n\r\n//获取订单信息\r\nfunction getOrderInfo( sendResponse ){\r\n　　var flag = false;\r\n\r\n　　payMoney = [];//货款金额\r\n　　orderTime = [];//下单时间\r\n　　$(\"tr[class=head] span\").each(function(index){\r\n　　　　spantxt = '';\r\n　　　　spantxt = $(this).text();\r\n　　　　if(spantxt.indexOf('货款金额：') > -1){\r\n　　　　　　money = spantxt.substr(5);\r\n　　　　　　//console.log(index + \"---------payMoney-------货款金额：\" + money);\r\n　　　　　　payMoney.push(money);\r\n　　　　}else if(spantxt.indexOf('下单时间：') > -1){\r\n　　　　　　time = spantxt.substr(5);\r\n　　　　　　//console.log(index + \"---------orderTime-------下单时间：\" + time);\r\n　　　　　　orderTime.push(time);\r\n　　　　}\r\n　　});\r\n\r\npaytype = [];//物流方式\r\nyunfei = [];//运费\r\n$(\"td[class=p-values]\").each(function(index){\r\n　　tdtxt = '';\r\n　　tdtxt = $(this).text();\r\n　　if(tdtxt.indexOf('货到付款') > -1){\r\n　　　　paytype.push('货到付款');\r\n　　}else{\r\n　　　　paytype.push('在线支付');\r\n　　}\r\n\r\n　　yf_index = tdtxt.indexOf('运费:');\r\n　　if(yf_index > -1){\r\n　　　　temp = tdtxt.substr(yf_index);\r\n　　　　temp_yf = temp.substr(3);\r\n　　　　//console.log(index + \"---------yunfei-------\"+ temp +\"===\" + temp_yf);\r\n　　　　yunfei.push(temp_yf);\r\n　　}else{\r\n　　　　yunfei.push(0);\r\n　　}\r\n\r\n　　//console.log(index + \"---------tdtxt-------\" + tdtxt);\r\n});\r\n\r\norderStatus = [];//订单状态\r\nusers = [];//买家账号\r\nremark = [];//备注\r\n$(\"tr[class=content] td[class=t-c]\").each(function(index){\r\n　　tdtxt = '';\r\n　　tdtxt = $(this).text().replace(/[\\r\\n]\\ +/g,\"\");//将回车，换行，空格去掉\r\n　　temp = index % 5;\r\n　　if(1 == temp){\r\n　　　　orderStatus.push(tdtxt);\r\n　　　　//console.log(index + \"---------statu-------\" + tdtxt);\r\n　　}else if(2 == temp){\r\n　　　　users.push(tdtxt);\r\n　　　　//console.log(index + \"---------users-------\" + tdtxt);\r\n　　}else if(3 == temp){\r\n　　　　remark.push(tdtxt);\r\n　　　　//console.log(index + \"---------remark-------\" + tdtxt);\r\n　　}\r\n});\r\n\r\nexpress = [];//快递单号\r\n$(\"tr[class=content] td div[style='text-align: center;']\").each(function(index){\r\n　　tdtxt = '';\r\n　　tdtxt = $(this).text().replace(/[\\r\\n]\\ +/g,\"\");//将回车，换行，空格去掉\r\n　　express.push(tdtxt);\r\n　　//console.log( \"============快递单号=======\" + tdtxt);\r\n});\r\n\r\norderInfo = [];\r\nsplitstr = \"@_@\";\r\n$(\"tr[class=head] a[track=orderinfopagebeta]\").each(function(index){\r\n　　orderid = $(this).text();\r\n　　//console.log(\"---------orderid-------\" + orderid);\r\n　　mycomment = $(\"a[id=comment_\" + orderid + \"]\").attr('style').replace(/[\\r\\n]\\ +/g,\"\");\r\n　　if(\"display: block;\" == mycomment){\r\n　　　　mycomment = '已评价';\r\n　　}else if('display:none;' == mycomment){\r\n　　　　mycomment = '未评价';\r\n　　}\r\n\r\n　　tempshopid = $(\"img[id=remarkFlag_\" + orderid + \"]\").attr('onclick');\r\n　　shopidIndex = tempshopid.indexOf(\",\");\r\n　　shopid = tempshopid.substr(shopidIndex + 1).replace(/[\\)\\;]/g,\"\");\r\n　　//console.log(\"---------shopid-------\" + shopid);\r\n　　orderdesc = shopid + splitstr + orderid + splitstr + mycomment + splitstr + payMoney[index] + splitstr + orderTime[index] + splitstr + paytype[index] + splitstr + yunfei[index] + splitstr + orderStatus[index] + splitstr + users[index] + splitstr + remark[index] + splitstr + express[index];\r\n　　console.log(\"---------orderdesc-------\" + orderdesc);\r\n　　orderInfo.push(orderdesc);\r\n});\r\n\r\n//chrome.extension.sendMessage({\"orderInfo\": orderInfo}, function(response) {});\r\npage = parseInt($(\"a[class=current]\").text());\r\ntotalPage = parseInt($(\"input[name=totalPage]\").val());\r\nconsole.log(page + \"--page-----------totalPage---\" + totalPage);\r\nif(page < totalPage && page < 100){\r\n　　console.log(\"---------next-------\");\r\n　　sendMsg( orderInfo, \"next\" );\r\n　　$('a.next')[1].click();\r\n}else{\r\n　　console.log(\"---------end-------\");\r\n　　sendMsg( orderInfo, \"end\" );\r\n}\r\n//\r\n\r\n}\r\n\r\n//将获取内容传递给后台文件进行处理\r\nfunction sendMsg( msg, cmd){\r\n　　chrome.extension.sendMessage({\"msg\": msg, \"cmd\": cmd}, function(response) {});\r\n}\r\n\r\n5、创建后台处理js文件eventPage.js\r\n\r\nvar flag = false;\r\nvar currentTabId;\r\nchrome.browserAction.onClicked.addListener(function(tab) {\r\n　　counter = 40;\r\n　　console.log('Turning ' + tab.url);\r\n　　flag = true;\r\n　　currentTabId = tab.id;\r\n　　chrome.tabs.getSelected(null, function(tab) {\r\n　　　　sendMsg(tab.id);\r\n　　});\r\n});\r\n\r\n\r\nchrome.webNavigation.onCompleted.addListener(function( tab ){\r\n　　console.log('加载完成***' + tab.tabId );\r\n　　if( flag ){\r\n　　　　sendMsg( tab.tabId );\r\n　　}\r\n});\r\n\r\nchrome.extension.onMessage.addListener(\r\n\r\nfunction(request, sender, sendResponse) {\r\n　　console.log(\"*******evenPage.js***chrome.extension.onMessage.addListener\"); \r\n　　articleData = request;\r\n　　$.ajax({\r\n　　　　url: \"服务器接受数据URL/getOrderinfo.php\",\r\n　　　　cache: false,\r\n　　　　type: \"POST\",\r\n　　　　data: {'orderinfo': request.msg.join(\"#$#\")},\r\n　　　　dataType: \"json\"\r\n　　　　}).done(function(msg) {\r\n　　　　　　console.log('*******************json*************' + msg.sql );\r\n　　　　　　chrome.tabs.sendMessage(currentTabId, {\"cmd\":\"end\"}, \r\n　　　　　　function(response) { \r\n　　　　　　console.log(response); \r\n　});\r\n\r\n}).fail(function(jqXHR, textStatus) {\r\n　　articleData.firstAccess = textStatus;\r\n});\r\n\r\ncmd = request.cmd;\r\nif('end' == cmd){\r\n　　flag = false;//确保不会自动运行\r\n}\r\n\r\n});\r\n\r\nfunction sendSku2Info(colores){\r\n　　chrome.tabs.query(\r\n　　　　{active: true, currentWindow: true}, function(tabs) {\r\n　　　　　　chrome.tabs.sendMessage(tabs[0].id, {\"cmd\":\"ok\", \"sku\": colores}, \r\n　　　　　　function(response) { \r\n　　　　　　　　console.log(response); \r\n　　　　　　});\r\n\r\n　　});\r\n}\r\n\r\nfunction sendMsg( tabid ){\r\n　　console.log(tabid + \"--sendMsg()----eventPage.js\");\r\n　　chrome.tabs.sendMessage(tabid, {greeting: \"start working\"}, function(response) {\r\n　　});\r\n}\r\n\r\n \r\n4、创建服务器接收文件getOrderInfo.php（放在服务器哦，亲！）\r\n\r\n<?php\r\n\r\nheader(\"Content-type:text/html; charset=utf-8\");\r\n//include(\"./includes/global.php\");\r\necho \"***********************\";\r\n$con = mysql_connect(\"localhost\",\"root\",\"root\");\r\necho \"==============\";\r\nif (!$con)\r\n{\r\n　　die('Could not connect: ' . mysql_error());\r\n}\r\nmysql_select_db(\"test\", $con);\r\n//var_dump($_REQUEST);\r\n$orderinfo = $_POST['orderinfo'];\r\n$orderArr = explode('#$#', $orderinfo);\r\nprint_r($orderArr);\r\n$sql_value = array();\r\n$split = \"', '\";\r\nforeach($orderArr as $myorder){\r\n　　$value = explode('@_@', $myorder);\r\n　　echo \"===========\" . $value[10] .\"</br>\";\r\n　　$sql = \"INSERT INTO test(venderId, orderid, pingjia, money, ordertime, paytype, yunfei, orderstatu, user, remark, express) VALUES \";\r\n　　$sql .= \"('\" . $value[0] . $split . $value[1] . $split . $value[2] . $split . $value[3] . $split . $value[4] . $split . $value[5] . $split . $value[6] . $split . 　　　　$value[7] . $split . $value[8] . $split . $value[9] . $split . $value[10] . \"') ON DUPLICATE KEY UPDATE remark = '\" . $value[9] . \"', pingjia = '\" . 　　　　$value[2] . \"', orderstatu = '\" . $value[7] . \"', express = '\" . $value[10] . \"'\";\r\n　　mysql_query($sql);\r\n}\r\nmysql_close($con);\r\n\r\n?>\r\n\r\n5、创建数据库表\r\n\r\nCREATE TABLE `test` (\r\n`id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT 'id',\r\n`venderId` int(10) NOT NULL DEFAULT '0' COMMENT '商家ID',\r\n`orderid` bigint(20) NOT NULL DEFAULT '0' COMMENT '订单ID',\r\n`pingjia` varchar(100) NOT NULL DEFAULT '' COMMENT '订单发出后的状态（是否评价）',\r\n`money` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '订单金额',\r\n`ordertime` varchar(100) NOT NULL DEFAULT '' COMMENT '下单时间',\r\n`paytype` varchar(100) NOT NULL DEFAULT '' COMMENT '付款方式',\r\n`yunfei` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '运费',\r\n`orderstatu` varchar(100) NOT NULL DEFAULT '' COMMENT '订单状态',\r\n`user` varchar(255) NOT NULL DEFAULT '' COMMENT '订单用户',\r\n`remark` varchar(255) NOT NULL DEFAULT '' COMMENT '备注',\r\n`express` varchar(255) NOT NULL DEFAULT '' COMMENT '物流方式和运单号',\r\n`shop_id` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '店铺表ID',\r\n`shop_name` varchar(255) NOT NULL DEFAULT '' COMMENT '店铺名称',\r\n`stattime` int(11) NOT NULL DEFAULT '0' COMMENT '下单年月日',\r\nPRIMARY KEY (`id`),\r\nUNIQUE KEY `orderid` (`orderid`)\r\n) ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT=''\r\n\r\n注意：各文件中红色部分需要手工修改，此外如果修改js文件名，请在manifest.json中修改相应的配置信息即可。\r\n插件加载步骤：\r\n　　\r\n示例代码：https://github.com/jackgitgz/chrome_server_plugin\r\n此示例仅供参考，有理解不到位或错误的还请指出。", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>利用chrome插件批量读取浏览器页面内容并写入数据库 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4490530.html\">利用chrome插件批量读取浏览器页面内容并写入数据库</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>　　试想一下，如果每天要收集100页网页数据甚至更多。如果采用人工收集会吐血，用程序去收集也就成为一个不二的选择。首先肯定会想到说用java、php、C#等高级语言，但这偏偏又有个登陆和验证码，搞到无所适从。还在为收集web端的数据感到苦恼吗？很高兴，你找对地方了。</p>\r\n<p>　　应用场景：</p>\r\n<p>　　　　1、需要每天大量重复收集web端的数据</p>\r\n<p>　　　　2、web页面数据需要登陆后才能采集</p>\r\n<p>　　　　3、web页面存在翻页</p>\r\n<p>　　解决方案：</p>\r\n<p>　　　　手工登陆，然后采用chrome插件的方式进行收集。当然你会说用selenium等自动化测试的方法进行收集更cool，而且可以每天自动收集，完全的自动化不用人工参与。但是作为chrome的忠实脑残粉，再者只需要前端的js、服务器端的接收文件、数据库就可以完美解决这一问题。再加上部署和操作简单。 脑残粉总有很多理由的嘛。好吧，就算是一种憋屈的曲线救国和实现方式吧。</p>\r\n<p>　　思路：</p>\r\n<p>　　　　<img src=\"http://images.cnitblog.com/blog2015/709606/201505/091407449546598.jpg\" alt=\"\"></p>\r\n<p>帮助手册：http://open.chrome.360.cn/extension_dev/overview.html</p>\r\n<p><span style=\"line-height: 1.5;\">实例：</span></p>\r\n<p><img src=\"http://images.cnitblog.com/blog2015/709606/201505/091528407985044.png\" alt=\"\"></p>\r\n<p>抓取某电商后台订单数据</p>\r\n<p>1、创建一个项目文件夹并引入所需文件：如D:\\tool\\chrome_server_plugin</p>\r\n<p>　　jquery-2.1.1.min.js、icon.png</p>\r\n<p>2、创建background.html</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">&lt;</span><span style=\"color: #800000;\">html</span><span style=\"color: #0000ff;\">&gt;&lt;</span><span style=\"color: #800000;\">head</span><span style=\"color: #0000ff;\">&gt;</span>\r\n<span style=\"color: #0000ff;\">&lt;/</span><span style=\"color: #800000;\">head</span><span style=\"color: #0000ff;\">&gt;&lt;/</span><span style=\"color: #800000;\">html</span><span style=\"color: #0000ff;\">&gt;</span></pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">3、创建配置文件manifest.json文件</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #000000;\">{\r\n\r\n\"name\": \"获取某电商后台订单信息\",\r\n\"version\": \"1.0\",\r\n\"manifest_version\": 2,\r\n\"description\": \"*********获取某电商后台订单信息*********\",\r\n\"browser_action\": {\r\n\"default_icon\": \"icon.png\"\r\n},\r\n\"permissions\": [\r\n\"webNavigation\",\r\n\"tabs\",\r\n\"contextMenus\",\r\n\"<span style=\"color: #ff0000;\"><strong>http://服务器接受数据url/</strong></span>\"\r\n],\r\n\"background\": {\r\n\"scripts\": [\"eventPage.js\",\"jquery-2.1.1.min.js\"]\r\n},\r\n\"content_scripts\": [\r\n{\r\n\"matches\": [\"<strong><span style=\"color: #ff0000;\">http://抓取页面url/*</span></strong>\"],\r\n\"js\": [\"jquery-2.1.1.min.js\", \"contentscript.js\"]\r\n}\r\n]\r\n}</span></pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">4、创建前端js文件contentscript.js</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">var</span><span style=\"color: #000000;\"> totalPage;\r\n</span><span style=\"color: #0000ff;\">var</span> page = 0<span style=\"color: #000000;\">;\r\n</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">注册前台页面监听事件</span>\r\n<span style=\"color: #000000;\">chrome.extension.onMessage.addListener(\r\n　　</span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(request, sender, sendResponse) {\r\n　　　　totalPage </span>= $(\"input[name=totalPage]\"<span style=\"color: #000000;\">).val();\r\n　　　　console.log(</span>\"totalPage----------\" +<span style=\"color: #000000;\"> totalPage);\r\n　　　　</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">console.log(\"msg----------contentscript.js\" + request.greeting);</span>\r\n<span style=\"color: #000000;\">　　　　getOrderInfo( sendResponse );\r\n　　});\r\n\r\n</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">获取订单信息</span>\r\n<span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> getOrderInfo( sendResponse ){\r\n　　</span><span style=\"color: #0000ff;\">var</span> flag = <span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">;\r\n\r\n　　payMoney </span>= [];<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">货款金额</span>\r\n　　orderTime = [];<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">下单时间</span>\r\n　　$(\"tr[class=head] span\").each(<span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(index){\r\n　　　　spantxt </span>= ''<span style=\"color: #000000;\">;\r\n　　　　spantxt </span>= $(<span style=\"color: #0000ff;\">this</span><span style=\"color: #000000;\">).text();\r\n　　　　</span><span style=\"color: #0000ff;\">if</span>(spantxt.indexOf('货款金额：') &gt; -1<span style=\"color: #000000;\">){\r\n　　　　　　money </span>= spantxt.substr(5<span style=\"color: #000000;\">);\r\n　　　　　　</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">console.log(index + \"---------payMoney-------货款金额：\" + money);</span>\r\n<span style=\"color: #000000;\">　　　　　　payMoney.push(money);\r\n　　　　}</span><span style=\"color: #0000ff;\">else</span> <span style=\"color: #0000ff;\">if</span>(spantxt.indexOf('下单时间：') &gt; -1<span style=\"color: #000000;\">){\r\n　　　　　　time </span>= spantxt.substr(5<span style=\"color: #000000;\">);\r\n　　　　　　</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">console.log(index + \"---------orderTime-------下单时间：\" + time);</span>\r\n<span style=\"color: #000000;\">　　　　　　orderTime.push(time);\r\n　　　　}\r\n　　});\r\n\r\npaytype </span>= [];<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">物流方式</span>\r\nyunfei = [];<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">运费</span>\r\n$(\"td[class=p-values]\").each(<span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(index){\r\n　　tdtxt </span>= ''<span style=\"color: #000000;\">;\r\n　　tdtxt </span>= $(<span style=\"color: #0000ff;\">this</span><span style=\"color: #000000;\">).text();\r\n　　</span><span style=\"color: #0000ff;\">if</span>(tdtxt.indexOf('货到付款') &gt; -1<span style=\"color: #000000;\">){\r\n　　　　paytype.push(</span>'货到付款'<span style=\"color: #000000;\">);\r\n　　}</span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">{\r\n　　　　paytype.push(</span>'在线支付'<span style=\"color: #000000;\">);\r\n　　}\r\n\r\n　　yf_index </span>= tdtxt.indexOf('运费:'<span style=\"color: #000000;\">);\r\n　　</span><span style=\"color: #0000ff;\">if</span>(yf_index &gt; -1<span style=\"color: #000000;\">){\r\n　　　　temp </span>=<span style=\"color: #000000;\"> tdtxt.substr(yf_index);\r\n　　　　temp_yf </span>= temp.substr(3<span style=\"color: #000000;\">);\r\n　　　　</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">console.log(index + \"---------yunfei-------\"+ temp +\"===\" + temp_yf);</span>\r\n<span style=\"color: #000000;\">　　　　yunfei.push(temp_yf);\r\n　　}</span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">{\r\n　　　　yunfei.push(</span>0<span style=\"color: #000000;\">);\r\n　　}\r\n\r\n　　</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">console.log(index + \"---------tdtxt-------\" + tdtxt);</span>\r\n<span style=\"color: #000000;\">});\r\n\r\norderStatus </span>= [];<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">订单状态</span>\r\nusers = [];<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">买家账号</span>\r\nremark = [];<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">备注</span>\r\n$(\"tr[class=content] td[class=t-c]\").each(<span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(index){\r\n　　tdtxt </span>= ''<span style=\"color: #000000;\">;\r\n　　tdtxt </span>= $(<span style=\"color: #0000ff;\">this</span>).text().replace(/[\\r\\n]\\ +/g,\"\");<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">将回车，换行，空格去掉</span>\r\n　　temp = index % 5<span style=\"color: #000000;\">;\r\n　　</span><span style=\"color: #0000ff;\">if</span>(1 ==<span style=\"color: #000000;\"> temp){\r\n　　　　orderStatus.push(tdtxt);\r\n　　　　</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">console.log(index + \"---------statu-------\" + tdtxt);</span>\r\n　　}<span style=\"color: #0000ff;\">else</span> <span style=\"color: #0000ff;\">if</span>(2 ==<span style=\"color: #000000;\"> temp){\r\n　　　　users.push(tdtxt);\r\n　　　　</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">console.log(index + \"---------users-------\" + tdtxt);</span>\r\n　　}<span style=\"color: #0000ff;\">else</span> <span style=\"color: #0000ff;\">if</span>(3 ==<span style=\"color: #000000;\"> temp){\r\n　　　　remark.push(tdtxt);\r\n　　　　</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">console.log(index + \"---------remark-------\" + tdtxt);</span>\r\n<span style=\"color: #000000;\">　　}\r\n});\r\n\r\nexpress </span>= [];<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">快递单号</span>\r\n$(\"tr[class=content] td div[style='text-align: center;']\").each(<span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(index){\r\n　　tdtxt </span>= ''<span style=\"color: #000000;\">;\r\n　　tdtxt </span>= $(<span style=\"color: #0000ff;\">this</span>).text().replace(/[\\r\\n]\\ +/g,\"\");<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">将回车，换行，空格去掉</span>\r\n<span style=\"color: #000000;\">　　express.push(tdtxt);\r\n　　</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">console.log( \"============快递单号=======\" + tdtxt);</span>\r\n<span style=\"color: #000000;\">});\r\n\r\norderInfo </span>=<span style=\"color: #000000;\"> [];\r\nsplitstr </span>= \"@_@\"<span style=\"color: #000000;\">;\r\n$(</span>\"tr[class=head] a[track=orderinfopagebeta]\").each(<span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(index){\r\n　　orderid </span>= $(<span style=\"color: #0000ff;\">this</span><span style=\"color: #000000;\">).text();\r\n　　</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">console.log(\"---------orderid-------\" + orderid);</span>\r\n　　mycomment = $(\"a[id=comment_\" + orderid + \"]\").attr('style').replace(/[\\r\\n]\\ +/g,\"\"<span style=\"color: #000000;\">);\r\n　　</span><span style=\"color: #0000ff;\">if</span>(\"display: block;\" ==<span style=\"color: #000000;\"> mycomment){\r\n　　　　mycomment </span>= '已评价'<span style=\"color: #000000;\">;\r\n　　}</span><span style=\"color: #0000ff;\">else</span> <span style=\"color: #0000ff;\">if</span>('display:none;' ==<span style=\"color: #000000;\"> mycomment){\r\n　　　　mycomment </span>= '未评价'<span style=\"color: #000000;\">;\r\n　　}\r\n\r\n　　tempshopid </span>= $(\"img[id=remarkFlag_\" + orderid + \"]\").attr('onclick'<span style=\"color: #000000;\">);\r\n　　shopidIndex </span>= tempshopid.indexOf(\",\"<span style=\"color: #000000;\">);\r\n　　shopid </span>= tempshopid.substr(shopidIndex + 1).replace(/[\\)\\;]/g,\"\"<span style=\"color: #000000;\">);\r\n　　</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">console.log(\"---------shopid-------\" + shopid);</span>\r\n　　orderdesc = shopid + splitstr + orderid + splitstr + mycomment + splitstr + payMoney[index] + splitstr + orderTime[index] + splitstr + paytype[index] + splitstr + yunfei[index] + splitstr + orderStatus[index] + splitstr + users[index] + splitstr + remark[index] + splitstr +<span style=\"color: #000000;\"> express[index];\r\n　　console.log(</span>\"---------orderdesc-------\" +<span style=\"color: #000000;\"> orderdesc);\r\n　　orderInfo.push(orderdesc);\r\n});\r\n\r\n</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">chrome.extension.sendMessage({\"orderInfo\": orderInfo}, function(response) {});</span>\r\npage = parseInt($(\"a[class=current]\"<span style=\"color: #000000;\">).text());\r\ntotalPage </span>= parseInt($(\"input[name=totalPage]\"<span style=\"color: #000000;\">).val());\r\nconsole.log(page </span>+ \"--page-----------totalPage---\" +<span style=\"color: #000000;\"> totalPage);\r\n</span><span style=\"color: #0000ff;\">if</span>(page &lt; totalPage &amp;&amp; page &lt; 100<span style=\"color: #000000;\">){\r\n　　console.log(</span>\"---------next-------\"<span style=\"color: #000000;\">);\r\n　　sendMsg( orderInfo, </span>\"next\"<span style=\"color: #000000;\"> );\r\n　　$(</span>'a.next')[1<span style=\"color: #000000;\">].click();\r\n}</span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">{\r\n　　console.log(</span>\"---------end-------\"<span style=\"color: #000000;\">);\r\n　　sendMsg( orderInfo, </span>\"end\"<span style=\"color: #000000;\"> );\r\n}\r\n</span><span style=\"color: #008000;\">//\r\n</span><span style=\"color: #000000;\">\r\n}\r\n\r\n</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">将获取内容传递给后台文件进行处理</span>\r\n<span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> sendMsg( msg, cmd){\r\n　　chrome.extension.sendMessage({</span>\"msg\": msg, \"cmd\": cmd}, <span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(response) {});\r\n}</span></pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">5、创建后台处理js文件eventPage.js</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">var</span> flag = <span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">var</span><span style=\"color: #000000;\"> currentTabId;\r\nchrome.browserAction.onClicked.addListener(</span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(tab) {\r\n　　counter </span>= 40<span style=\"color: #000000;\">;\r\n　　console.log(</span>'Turning ' +<span style=\"color: #000000;\"> tab.url);\r\n　　flag </span>= <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">;\r\n　　currentTabId </span>=<span style=\"color: #000000;\"> tab.id;\r\n　　chrome.tabs.getSelected(</span><span style=\"color: #0000ff;\">null</span>, <span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(tab) {\r\n　　　　sendMsg(tab.id);\r\n　　});\r\n});\r\n\r\n\r\nchrome.webNavigation.onCompleted.addListener(</span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">( tab ){\r\n　　console.log(</span>'加载完成***' +<span style=\"color: #000000;\"> tab.tabId );\r\n　　</span><span style=\"color: #0000ff;\">if</span><span style=\"color: #000000;\">( flag ){\r\n　　　　sendMsg( tab.tabId );\r\n　　}\r\n});\r\n\r\nchrome.extension.onMessage.addListener(\r\n\r\n</span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(request, sender, sendResponse) {\r\n　　console.log(</span>\"*******evenPage.js***chrome.extension.onMessage.addListener\"<span style=\"color: #000000;\">); \r\n　　articleData </span>=<span style=\"color: #000000;\"> request;\r\n　　$.ajax({\r\n　　　　url: </span>\"<span style=\"color: #ff0000;\"><strong>服务器接受数据URL</strong></span>/getOrderinfo.php\"<span style=\"color: #000000;\">,\r\n　　　　cache: </span><span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">,\r\n　　　　type: </span>\"POST\"<span style=\"color: #000000;\">,\r\n　　　　data: {</span>'orderinfo': request.msg.join(\"#$#\"<span style=\"color: #000000;\">)},\r\n　　　　dataType: </span>\"json\"<span style=\"color: #000000;\">\r\n　　　　}).done(</span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(msg) {\r\n　　　　　　console.log(</span>'*******************json*************' +<span style=\"color: #000000;\"> msg.sql );\r\n　　　　　　chrome.tabs.sendMessage(currentTabId, {</span>\"cmd\":\"end\"<span style=\"color: #000000;\">}, \r\n　　　　　　</span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(response) { \r\n　　　　　　console.log(response); \r\n　});\r\n\r\n}).fail(</span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(jqXHR, textStatus) {\r\n　　articleData.firstAccess </span>=<span style=\"color: #000000;\"> textStatus;\r\n});\r\n\r\ncmd </span>=<span style=\"color: #000000;\"> request.cmd;\r\n</span><span style=\"color: #0000ff;\">if</span>('end' ==<span style=\"color: #000000;\"> cmd){\r\n　　flag </span>= <span style=\"color: #0000ff;\">false</span>;<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">确保不会自动运行</span>\r\n<span style=\"color: #000000;\">}\r\n\r\n});\r\n\r\n</span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> sendSku2Info(colores){\r\n　　chrome.tabs.query(\r\n　　　　{active: </span><span style=\"color: #0000ff;\">true</span>, currentWindow: <span style=\"color: #0000ff;\">true</span>}, <span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(tabs) {\r\n　　　　　　chrome.tabs.sendMessage(tabs[</span>0].id, {\"cmd\":\"ok\", \"sku\"<span style=\"color: #000000;\">: colores}, \r\n　　　　　　</span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(response) { \r\n　　　　　　　　console.log(response); \r\n　　　　　　});\r\n\r\n　　});\r\n}\r\n\r\n</span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> sendMsg( tabid ){\r\n　　console.log(tabid </span>+ \"--sendMsg()----eventPage.js\"<span style=\"color: #000000;\">);\r\n　　chrome.tabs.sendMessage(tabid, {greeting: </span>\"start working\"}, <span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(response) {\r\n　　});\r\n}</span></pre>\r\n</div>\r\n<p> </p>\r\n<p><span style=\"background-color: #ffffff;\">4、创建服务器接收文件getOrderInfo.php（放在服务器哦，亲！）</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre>&lt;?<span style=\"color: #000000;\">php\r\n\r\n</span><span style=\"color: #008080;\">header</span>(\"Content-type:text/html; charset=utf-8\"<span style=\"color: #000000;\">);\r\n</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">include(\"./includes/global.php\");</span>\r\n<span style=\"color: #0000ff;\">echo</span> \"***********************\"<span style=\"color: #000000;\">;\r\n</span><span style=\"color: #800080;\">$con</span> = <span style=\"color: #008080;\">mysql_connect</span>(\"localhost\",\"root\",\"root\"<span style=\"color: #000000;\">);\r\n</span><span style=\"color: #0000ff;\">echo</span> \"==============\"<span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">if</span> (!<span style=\"color: #800080;\">$con</span><span style=\"color: #000000;\">)\r\n{\r\n　　</span><span style=\"color: #0000ff;\">die</span>('Could not connect: ' . <span style=\"color: #008080;\">mysql_error</span><span style=\"color: #000000;\">());\r\n}\r\n</span><span style=\"color: #008080;\">mysql_select_db</span>(\"test\", <span style=\"color: #800080;\">$con</span><span style=\"color: #000000;\">);\r\n</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">var_dump($_REQUEST);</span>\r\n<span style=\"color: #800080;\">$orderinfo</span> = <span style=\"color: #800080;\">$_POST</span>['orderinfo'<span style=\"color: #000000;\">];\r\n</span><span style=\"color: #800080;\">$orderArr</span> = <span style=\"color: #008080;\">explode</span>('#$#', <span style=\"color: #800080;\">$orderinfo</span><span style=\"color: #000000;\">);\r\n</span><span style=\"color: #008080;\">print_r</span>(<span style=\"color: #800080;\">$orderArr</span><span style=\"color: #000000;\">);\r\n</span><span style=\"color: #800080;\">$sql_value</span> = <span style=\"color: #0000ff;\">array</span><span style=\"color: #000000;\">();\r\n</span><span style=\"color: #800080;\">$split</span> = \"', '\"<span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">foreach</span>(<span style=\"color: #800080;\">$orderArr</span> <span style=\"color: #0000ff;\">as</span> <span style=\"color: #800080;\">$myorder</span><span style=\"color: #000000;\">){\r\n　　</span><span style=\"color: #800080;\">$value</span> = <span style=\"color: #008080;\">explode</span>('@_@', <span style=\"color: #800080;\">$myorder</span><span style=\"color: #000000;\">);\r\n　　</span><span style=\"color: #0000ff;\">echo</span> \"===========\" . <span style=\"color: #800080;\">$value</span>[10] .\"&lt;/br&gt;\"<span style=\"color: #000000;\">;\r\n　　</span><span style=\"color: #800080;\">$sql</span> = \"INSERT INTO test(venderId, orderid, pingjia, money, ordertime, paytype, yunfei, orderstatu, user, remark, express) VALUES \"<span style=\"color: #000000;\">;\r\n　　</span><span style=\"color: #800080;\">$sql</span> .= \"('\" . <span style=\"color: #800080;\">$value</span>[0] . <span style=\"color: #800080;\">$split</span> . <span style=\"color: #800080;\">$value</span>[1] . <span style=\"color: #800080;\">$split</span> . <span style=\"color: #800080;\">$value</span>[2] . <span style=\"color: #800080;\">$split</span> . <span style=\"color: #800080;\">$value</span>[3] . <span style=\"color: #800080;\">$split</span> . <span style=\"color: #800080;\">$value</span>[4] . <span style=\"color: #800080;\">$split</span> . <span style=\"color: #800080;\">$value</span>[5] . <span style=\"color: #800080;\">$split</span> . <span style=\"color: #800080;\">$value</span>[6] . <span style=\"color: #800080;\">$split</span> . 　　　　<span style=\"color: #800080;\">$value</span>[7] . <span style=\"color: #800080;\">$split</span> . <span style=\"color: #800080;\">$value</span>[8] . <span style=\"color: #800080;\">$split</span> . <span style=\"color: #800080;\">$value</span>[9] . <span style=\"color: #800080;\">$split</span> . <span style=\"color: #800080;\">$value</span>[10] . \"') ON DUPLICATE KEY UPDATE remark = '\" . <span style=\"color: #800080;\">$value</span>[9] . \"', pingjia = '\" . 　　　　<span style=\"color: #800080;\">$value</span>[2] . \"', orderstatu = '\" . <span style=\"color: #800080;\">$value</span>[7] . \"', express = '\" . <span style=\"color: #800080;\">$value</span>[10] . \"'\"<span style=\"color: #000000;\">;\r\n　　</span><span style=\"color: #008080;\">mysql_query</span>(<span style=\"color: #800080;\">$sql</span><span style=\"color: #000000;\">);\r\n}\r\n</span><span style=\"color: #008080;\">mysql_close</span>(<span style=\"color: #800080;\">$con</span><span style=\"color: #000000;\">);\r\n\r\n</span>?&gt;</pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">5、创建数据库表</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">CREATE</span> <span style=\"color: #0000ff;\">TABLE</span><span style=\"color: #000000;\"> `test` (\r\n`id` </span><span style=\"color: #0000ff;\">int</span>(<span style=\"color: #800000; font-weight: bold;\">10</span>) unsigned <span style=\"color: #808080;\">NOT</span> <span style=\"color: #0000ff;\">NULL</span> AUTO_INCREMENT COMMENT <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">id</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,\r\n`venderId` </span><span style=\"color: #0000ff;\">int</span>(<span style=\"color: #800000; font-weight: bold;\">10</span>) <span style=\"color: #808080;\">NOT</span> <span style=\"color: #0000ff;\">NULL</span> <span style=\"color: #0000ff;\">DEFAULT</span> <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">0</span><span style=\"color: #ff0000;\">'</span> COMMENT <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">商家ID</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,\r\n`orderid` </span><span style=\"color: #0000ff;\">bigint</span>(<span style=\"color: #800000; font-weight: bold;\">20</span>) <span style=\"color: #808080;\">NOT</span> <span style=\"color: #0000ff;\">NULL</span> <span style=\"color: #0000ff;\">DEFAULT</span> <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">0</span><span style=\"color: #ff0000;\">'</span> COMMENT <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">订单ID</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,\r\n`pingjia` </span><span style=\"color: #0000ff;\">varchar</span>(<span style=\"color: #800000; font-weight: bold;\">100</span>) <span style=\"color: #808080;\">NOT</span> <span style=\"color: #0000ff;\">NULL</span> <span style=\"color: #0000ff;\">DEFAULT</span> <span style=\"color: #ff0000;\">''</span> COMMENT <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">订单发出后的状态（是否评价）</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,\r\n`</span><span style=\"color: #0000ff;\">money</span>` <span style=\"color: #0000ff;\">decimal</span>(<span style=\"color: #800000; font-weight: bold;\">10</span>,<span style=\"color: #800000; font-weight: bold;\">2</span>) <span style=\"color: #808080;\">NOT</span> <span style=\"color: #0000ff;\">NULL</span> <span style=\"color: #0000ff;\">DEFAULT</span> <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">0.00</span><span style=\"color: #ff0000;\">'</span> COMMENT <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">订单金额</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,\r\n`ordertime` </span><span style=\"color: #0000ff;\">varchar</span>(<span style=\"color: #800000; font-weight: bold;\">100</span>) <span style=\"color: #808080;\">NOT</span> <span style=\"color: #0000ff;\">NULL</span> <span style=\"color: #0000ff;\">DEFAULT</span> <span style=\"color: #ff0000;\">''</span> COMMENT <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">下单时间</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,\r\n`paytype` </span><span style=\"color: #0000ff;\">varchar</span>(<span style=\"color: #800000; font-weight: bold;\">100</span>) <span style=\"color: #808080;\">NOT</span> <span style=\"color: #0000ff;\">NULL</span> <span style=\"color: #0000ff;\">DEFAULT</span> <span style=\"color: #ff0000;\">''</span> COMMENT <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">付款方式</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,\r\n`yunfei` </span><span style=\"color: #0000ff;\">decimal</span>(<span style=\"color: #800000; font-weight: bold;\">10</span>,<span style=\"color: #800000; font-weight: bold;\">2</span>) <span style=\"color: #808080;\">NOT</span> <span style=\"color: #0000ff;\">NULL</span> <span style=\"color: #0000ff;\">DEFAULT</span> <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">0.00</span><span style=\"color: #ff0000;\">'</span> COMMENT <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">运费</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,\r\n`orderstatu` </span><span style=\"color: #0000ff;\">varchar</span>(<span style=\"color: #800000; font-weight: bold;\">100</span>) <span style=\"color: #808080;\">NOT</span> <span style=\"color: #0000ff;\">NULL</span> <span style=\"color: #0000ff;\">DEFAULT</span> <span style=\"color: #ff0000;\">''</span> COMMENT <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">订单状态</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,\r\n`</span><span style=\"color: #ff00ff;\">user</span>` <span style=\"color: #0000ff;\">varchar</span>(<span style=\"color: #800000; font-weight: bold;\">255</span>) <span style=\"color: #808080;\">NOT</span> <span style=\"color: #0000ff;\">NULL</span> <span style=\"color: #0000ff;\">DEFAULT</span> <span style=\"color: #ff0000;\">''</span> COMMENT <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">订单用户</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,\r\n`remark` </span><span style=\"color: #0000ff;\">varchar</span>(<span style=\"color: #800000; font-weight: bold;\">255</span>) <span style=\"color: #808080;\">NOT</span> <span style=\"color: #0000ff;\">NULL</span> <span style=\"color: #0000ff;\">DEFAULT</span> <span style=\"color: #ff0000;\">''</span> COMMENT <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">备注</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,\r\n`express` </span><span style=\"color: #0000ff;\">varchar</span>(<span style=\"color: #800000; font-weight: bold;\">255</span>) <span style=\"color: #808080;\">NOT</span> <span style=\"color: #0000ff;\">NULL</span> <span style=\"color: #0000ff;\">DEFAULT</span> <span style=\"color: #ff0000;\">''</span> COMMENT <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">物流方式和运单号</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,\r\n`shop_id` </span><span style=\"color: #0000ff;\">int</span>(<span style=\"color: #800000; font-weight: bold;\">10</span>) unsigned <span style=\"color: #808080;\">NOT</span> <span style=\"color: #0000ff;\">NULL</span> <span style=\"color: #0000ff;\">DEFAULT</span> <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">0</span><span style=\"color: #ff0000;\">'</span> COMMENT <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">店铺表ID</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,\r\n`shop_name` </span><span style=\"color: #0000ff;\">varchar</span>(<span style=\"color: #800000; font-weight: bold;\">255</span>) <span style=\"color: #808080;\">NOT</span> <span style=\"color: #0000ff;\">NULL</span> <span style=\"color: #0000ff;\">DEFAULT</span> <span style=\"color: #ff0000;\">''</span> COMMENT <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">店铺名称</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,\r\n`stattime` </span><span style=\"color: #0000ff;\">int</span>(<span style=\"color: #800000; font-weight: bold;\">11</span>) <span style=\"color: #808080;\">NOT</span> <span style=\"color: #0000ff;\">NULL</span> <span style=\"color: #0000ff;\">DEFAULT</span> <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">0</span><span style=\"color: #ff0000;\">'</span> COMMENT <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">下单年月日</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,\r\n</span><span style=\"color: #0000ff;\">PRIMARY</span> <span style=\"color: #0000ff;\">KEY</span><span style=\"color: #000000;\"> (`id`),\r\n</span><span style=\"color: #0000ff;\">UNIQUE</span> <span style=\"color: #0000ff;\">KEY</span><span style=\"color: #000000;\"> `orderid` (`orderid`)\r\n) ENGINE</span><span style=\"color: #808080;\">=</span>MyISAM AUTO_INCREMENT<span style=\"color: #808080;\">=</span><span style=\"color: #800000; font-weight: bold;\">1</span> <span style=\"color: #0000ff;\">DEFAULT</span> CHARSET<span style=\"color: #808080;\">=</span>utf8 COMMENT<span style=\"color: #808080;\">=</span><span style=\"color: #ff0000;\">''</span></pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5; background-color: #ffff99;\">注意：各文件中</span><span style=\"color: #ff0000;\"><strong>红色部分</strong></span><span style=\"line-height: 1.5; background-color: #ffff99;\">需要手工修改，此外如果修改js文件名，请在manifest.json中修改相应的配置信息即可。</span></p>\r\n<p><strong>插件加载步骤：</strong></p>\r\n<p><strong>　　<img src=\"http://images.cnitblog.com/blog2015/709606/201505/091549579387436.jpg\" alt=\"\" width=\"942\" height=\"292\"></strong></p>\r\n<p><strong>示例代码：<a title=\"chrome 读取订单插件\" href=\"https://github.com/jackgitgz/chrome_server_plugin\" target=\"_blank\">https://github.com/jackgitgz/chrome_server_plugin</a></strong></p>\r\n<p><span style=\"background-color: #ffffff;\">此示例仅供参考，有理解不到位或错误的还请指出。</span></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-09 15:54</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4490530\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4490530);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4490530,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/9 15:54:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4490530.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=21", "desc": "摘要: 试想一下，如果每天要收集100页网页数据甚至更多。如果采用人工收集会吐血，用程序去收集也就成为一个不二的选择。首先肯定会想到说用java、php、C#等高级语言，但这偏偏又有个登陆和验证码，搞到无所适从。还在为收集web端的数据感到苦恼吗？你找对地方了。"}
{"title": "linux自动定时备份web程序和mysql数据库", "content": "　　前些天受朋友说linux定时备份不知道怎么搞，叫帮忙处理一下。由于这段时间正闲着，所以也就欣然答应。由于朋友对linux不懂也希望我将操作的过程记录下来，也就是越详细越好。所以写得比较$%^&*。本以为半个小时或者一个小时可以搞好，谁不知整整搞了一天。原因在哪呢？这里也顺便吐槽一下，首先问web存放在什么地方？不知，给了个ftp。然后进去一看，各种压缩包，各种目录备份，混乱不堪，为了防止磁盘被撑爆，所以一个个目录确认，哪些目录是要的哪些是不要的，然后一个个删掉。还有mysql数据库，问用的哪个？不知，又是一通的等，一遍遍地确认。好吧，这也都算了。等我搞好了，然后说每天检查一下。谁不知，程序猿最怕发生的事情义无意外地发生了。目录搞错，这不等于万恶的改需求吗？脑子瞬间都是各种@!#$%^&*(!@#$%^^&*()。好吧，不接都已经接了认了吧。好了吐槽至此，不废话入正题。\r\n需求：\r\n　　1、每天定时备份web程序和mysql数据库\r\n　　2、web程序、web日志和mysql数据库备份均保留7天\r\n说明：\r\n　　web目录：/chinasofti/www/bbswebdir\r\n　　web日志目录：/chinasofti/www/bbswebdir/httplogs\r\n　　日志文件名格式：myweb.com-access_log_YYYYMMDD，myweb.com-error_log_YYYYMMDD，如myweb.com-access_log_20150508，myweb.com-error_log_20150508\r\n　　备份脚本存放目录：/chinasofti/wwwbakscript/\r\n　　备份文件存放目录：/chinasofti/wwwbakdir/\r\n　　web备份文件名格式：bbs.myweb.com_YYYYMMDD，如bbs.myweb.com_20150508.tar.gz\r\n　　mysql备份文件格式：数据库名_$(date +%Y%m%d).sql.gz\r\n写在前面：务必注意各个目录的说明，运用是注意修改。完全不改是用不了的。注意各个目录和文件的对应关系。\r\n淡绿色底的为linux命令，淡黄色底的为shell脚本内容，其他的为备注说明。\r\n操作步骤\r\nroot用户登陆后1、切换目录　　cd /chinasofti/wwwbakscript2、创建备份脚本　　vi mywebbak.sh\r\n按i然后输入以下内容\r\n　　#!/bin/bash　　#backup /chinasofti/www/bbswebdir and database\r\n　　###################切换到web目录#################　　cd /chinasofti/www/bbswebdir\r\n　　###################删除web日志#################　　rm -f ./httplogs/myweb.com-access_log_$(date +%Y%m%d --date='7 days ago')　　rm -f ./httplogs/myweb.com-error_log_$(date +%Y%m%d --date='7 days ago')\r\n　　###################删除备份文件#################　　rm -f /chinasofti/wwwbakdir/bbs.myweb.com_$(date +%Y%m%d --date='7 days ago').tar.gz\r\n　　###################备份web程序#################　　tar -zcf /chinasofti/wwwbakdir/bbs.myweb.com_$(date +%Y%m%d).tar.gz ./* ./.[!.]*\r\n　　###################删除备份数据库####################　　rm -f /chinasofti/wwwbakdir/数据库名_$(date +%Y%m%d --date='7 days ago').sql.gz　　###################备份数据库####################　　mysqldump -u数据库账号 -p\"数据库密码\" 数据库 | gzip >/chinasofti/wwwbakdir/数据库名_$(date +%Y%m%d).sql.gz\r\n　　#################导出单个表数据和结构############\r\n　　#mysqldump -u账号 -p 数据库名 表名 > /root/XXXX.sql\r\n添加完成后，按键盘右上角的“esc”键，然后输入英文的冒号加x（:x），回车完成。\r\n注意：红色字体部分为路径（注意修改），品红色部分为文件名（注意修改）。\r\n4、添加可执行权限　　chmod +x mywebbak.sh\r\n5、定时执行　　crontab -e按i编辑，添加运行的脚本和时间。如：　　0 1 * * * /chinasofti/wwwbakscript/mywebbak.sh则为每天凌晨1点执行，/chinasofti/wwwbakscript/mywebbak.sh这个shell脚本。修改完成后，按键盘右上角的“esc”键，然后输入英文的冒号加x（:x），回车完成。\r\n6、每天检查脚本是否正常运行。\r\n其它相关文章：\r\nwindows下如何对mysql进行整裤备份\r\nmysql导入和导出数据", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>linux自动定时备份web程序和mysql数据库 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4488610.html\">linux自动定时备份web程序和mysql数据库</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>　　前些天受朋友说linux定时备份不知道怎么搞，叫帮忙处理一下。由于这段时间正闲着，所以也就欣然答应。由于朋友对linux不懂也希望我将操作的过程记录下来，也就是越详细越好。所以写得比较$%^&amp;*。本以为半个小时或者一个小时可以搞好，谁不知整整搞了一天。原因在哪呢？这里也顺便吐槽一下，首先问web存放在什么地方？不知，给了个ftp。然后进去一看，各种压缩包，各种目录备份，混乱不堪，为了防止磁盘被撑爆，所以一个个目录确认，哪些目录是要的哪些是不要的，然后一个个删掉。还有mysql数据库，问用的哪个？不知，又是一通的等，一遍遍地确认。好吧，这也都算了。等我搞好了，然后说每天检查一下。谁不知，程序猿最怕发生的事情义无意外地发生了。目录搞错，这不等于万恶的改需求吗？脑子瞬间都是各种@!#$%^&amp;*(!@#$%^^&amp;*()。好吧，不接都已经接了认了吧。好了吐槽至此，不废话入正题。</p>\r\n<p>需求：</p>\r\n<p>　　1、每天定时备份web程序和mysql数据库</p>\r\n<p>　　2、web程序、web日志和mysql数据库备份均保留7天</p>\r\n<p>说明：</p>\r\n<p><span style=\"background-color: #c0c0c0;\">　　web目录：<span style=\"color: #ff0000;\"><strong>/chinasofti/www/bbswebdir</strong></span></span></p>\r\n<p><span style=\"background-color: #c0c0c0;\">　　web日志目录：<span style=\"color: #ff0000;\"><strong>/chinasofti/www/bbswebdir</strong></span><span style=\"color: #ff0000;\"><strong>/httplogs</strong></span></span></p>\r\n<p><span style=\"background-color: #c0c0c0;\"><span style=\"color: #ff0000;\"><span style=\"color: #000000;\">　　日志文件名格式：</span><span style=\"color: #ff00ff;\"><strong><strong><strong>myweb.com-access_log_YYYYMMDD，<strong>myweb.com-error_log_<strong><strong>YYYYMMDD</strong></strong></strong>，如<strong>myweb.com-access_log_20150508，<strong><strong><strong>myweb.com-error_log_20150508</strong></strong></strong></strong></strong></strong></strong></span></span></span></p>\r\n<p><span style=\"color: #000000; background-color: #c0c0c0;\">　　备份脚本存放目录：<span style=\"color: #ff0000;\"><strong><strong><strong><strong><strong><strong><strong>/chinasofti/wwwbakscript/</strong></strong></strong></strong></strong></strong></strong></span></span></p>\r\n<p><span style=\"background-color: #c0c0c0;\">　　备份文件存放目录：<span style=\"color: #ff0000;\"><strong>/chinasofti/wwwbakdir/</strong></span></span></p>\r\n<p><span style=\"background-color: #c0c0c0;\"><span style=\"color: #ff0000;\"><strong>　　</strong><span style=\"color: #000000;\">web</span><span style=\"color: #000000;\">备份文件名格式：</span><span style=\"color: #ff00ff;\"><strong><strong>bbs.myweb.com_<strong><strong>YYYYMMDD，如<strong><strong>bbs.myweb.com_<strong><strong><strong>20150508.tar.gz</strong></strong></strong></strong></strong></strong></strong></strong></strong></span></span></span></p>\r\n<p><span style=\"background-color: #c0c0c0;\">　　mysql备份文件格式：<span style=\"color: #ff00ff;\"><strong>数据库名_$(date +%Y%m%d).sql.gz</strong></span></span></p>\r\n<p>写在前面：务必注意各个目录的说明，运用是注意修改。完全不改是用不了的。注意各个目录和文件的对应关系。</p>\r\n<p><span style=\"background-color: #c0c0c0;\"><strong>淡绿色底的为linux命令，淡黄色底的为shell脚本内容，其他的为备注说明。</strong></span></p>\r\n<p>操作步骤</p>\r\n<p>root用户登陆后<br>1、切换目录<br>　　<span style=\"background-color: #ccffcc;\">cd /chinasofti/wwwbakscript</span><br>2、创建备份脚本<br>　　<span style=\"background-color: #ccffcc;\">vi mywebbak.sh</span></p>\r\n<p>按i然后输入以下内容</p>\r\n<p><span style=\"background-color: #ffff99;\">　　#!/bin/bash</span><br><span style=\"background-color: #ffff99;\">　　#backup <span style=\"color: #ff0000;\"><strong>/chinasofti/www/bbswebdir and database</strong></span></span></p>\r\n<p><span style=\"background-color: #ffff99;\">　　###################切换到web目录#################</span><br><span style=\"background-color: #ffff99;\">　　cd <strong><span style=\"color: #ff0000;\">/chinasofti/www/bbswebdir</span></strong></span></p>\r\n<p><span style=\"background-color: #ffff99;\">　　###################删除web日志#################</span><br><span style=\"background-color: #ffff99;\">　　rm -f <span style=\"color: #ff0000;\"><strong>./httplogs/</strong></span><span style=\"color: #ff00ff;\"><strong>myweb.com-access_log_$(date +%Y%m%d --date='7 days ago')</strong></span></span><br><span style=\"background-color: #ffff99;\">　　rm -f <span style=\"color: #ff0000;\"><strong>./httplogs/</strong></span><span style=\"color: #ff00ff;\"><strong>myweb.com-error_log_$(date +%Y%m%d --date='7 days ago')</strong></span></span></p>\r\n<p><span style=\"background-color: #ffff99;\">　　###################删除备份文件#################</span><br><span style=\"background-color: #ffff99;\">　　rm -f <span style=\"color: #ff0000;\"><strong>/chinasofti/wwwbakdir/</strong></span><span style=\"color: #ff00ff;\"><strong>bbs.myweb.com_$(date +%Y%m%d --date='7 days ago').tar.gz</strong></span></span></p>\r\n<p><span style=\"background-color: #ffff99;\">　　###################备份web程序#################</span><br><span style=\"background-color: #ffff99;\">　　tar -zcf <span style=\"color: #ff0000;\"><strong>/chinasofti/wwwbakdir/</strong></span><span style=\"color: #ff00ff;\"><strong>bbs.myweb.com_$(date +%Y%m%d).tar.gz ./* ./.[!.]*</strong></span></span></p>\r\n<p><span style=\"background-color: #ffff99;\">　　###################删除备份数据库####################</span><br><span style=\"background-color: #ffff99;\">　　rm -f <span style=\"color: #ff0000;\"><strong>/chinasofti/wwwbakdir/</strong></span><strong><span style=\"color: #ff00ff;\">数据库名_$(date +%Y%m%d --date='7 days ago').sql.gz</span></strong></span><br><span style=\"background-color: #ffff99;\">　　###################备份数据库####################</span><br><span style=\"background-color: #ffff99;\">　　mysqldump -u数据库账号 -p\"数据库密码\" 数据库 | gzip &gt;<span style=\"color: #ff0000;\"><strong>/chinasofti/wwwbakdir/</strong></span><span style=\"color: #ff00ff;\"><strong>数据库名_$(date +%Y%m%d).sql.gz</strong></span></span></p>\r\n<p><span style=\"background-color: #ffff99;\"><span style=\"color: #ff00ff;\"><strong>　　#################导出单个表数据和结构############</strong></span></span></p>\r\n<p><span style=\"background-color: #ffff99;\"><span style=\"color: #ff00ff;\"><strong>　　#</strong><span style=\"color: #000000;\">mysqldump -u账号 -p 数据库名 表名 &gt; /root/XXXX.sql</span></span></span></p>\r\n<p>添加完成后，按键盘右上角的“esc”键，然后输入英文的冒号加x（:x），回车完成。</p>\r\n<p><span style=\"background-color: #c0c0c0;\"><strong>注意：红色字体部分为路径（注意修改），品红色部分为文件名（注意修改）。</strong></span></p>\r\n<p>4、添加可执行权限<br>　　<span style=\"background-color: #ccffcc;\">chmod +x mywebbak.sh</span></p>\r\n<p>5、定时执行<br>　　<span style=\"background-color: #ccffcc;\">crontab -e</span><br>按i编辑，添加运行的脚本和时间。如：<br>　　<span style=\"background-color: #ccffcc;\">0 1 * * * /chinasofti/wwwbakscript/mywebbak.sh</span><br>则为每天凌晨1点执行，/chinasofti/wwwbakscript/mywebbak.sh这个shell脚本。<br>修改完成后，按键盘右上角的“esc”键，然后输入英文的冒号加x（:x），回车完成。</p>\r\n<p>6、每天检查脚本是否正常运行。</p>\r\n<p>其它相关文章：</p>\r\n<p><a id=\"homepage1_HomePageDays_DaysList_ctl00_DayList_TitleUrl_0\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4525085.html\">windows下如何对mysql进行整裤备份</a></p>\r\n<p><a id=\"homepage1_HomePageDays_DaysList_ctl00_DayList_TitleUrl_0\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4525085.html\"></a><a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4525045.html\">mysql导入和导出数据</a></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-08 18:50</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4488610\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4488610);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4488610,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/8 18:50:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4488610.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=21", "desc": "摘要: 前些天受朋友说linux定时备份不知道怎么搞，叫帮忙处理一下。由于这段时间正闲着，所以也就欣然答应。由于朋友对linux不懂也希望我将操作的过程记录下来，也就是越详细越好。所以写得比较$%^&*。本以为半个小时或者一个小时可以搞好，谁不知整整搞了一天。原因在哪呢？这里也顺便吐槽一下，首先问web存放"}
{"title": "php如何妩媚地生成执行的sql语句", "content": "　　会不会碰到这样一种情况呢？每次获取数据将数据和历史版本都有一定的差别，然而用ThinkPHP的addAll()函数，却会将已有的数据删掉再重新写入。这明显不是我们想要的。但自己写sql每次几十个字段也是醉了。如何优雅而又轻松地实现sql的自动生成呢？于是有了下面这个方法。\r\n\r\n    /**\r\n     * [array_to_sql 根据数组key和value拼接成需要的sql]\r\n     * @param  [type] $array   [key, value结构数组]\r\n     * @param  string $type    [sql类型insert,update]\r\n     * @param  array  $exclude [排除的字段]\r\n     * @return [string]          [返回拼接好的sql]\r\n     */\r\n    function array_to_sql($array, $type='insert', $exclude = array()){\r\n        \r\n        $sql = '';\r\n        if(count($array) > 0){\r\n            foreach ($exclude as $exkey) {\r\n                unset($array[$exkey]);//剔除不要的key\r\n            }\r\n\r\n            if('insert' == $type){\r\n                $keys = array_keys($array);\r\n                $values = array_values($array);\r\n                $col = implode(\"`, `\", $keys);\r\n                $val = implode(\"', '\", $values);\r\n                $sql = \"(`$col`) values('$val')\";\r\n            }else if('update' == $type){\r\n                $tempsql = '';\r\n                $temparr = array();\r\n                foreach ($array as $key => $value) {\r\n                    $tempsql = \"'$key' = '$value'\";\r\n                    $temparr[] = $tempsql;\r\n                }\r\n\r\n                $sql = implode(\",\", $temparr);\r\n            }\r\n        }\r\n        return $sql;\r\n    }\r\n\r\n \r\n当然，这个方法还有很多可以斟酌的地方。能用，但不是最好的。园子的猿猿们你们有更好的方法吗？请告诉我吧！", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>php如何妩媚地生成执行的sql语句 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4491019.html\">php如何妩媚地生成执行的sql语句</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>　　会不会碰到这样一种情况呢？每次获取数据将数据和历史版本都有一定的差别，然而用ThinkPHP的addAll()函数，却会将已有的数据删掉再重新写入。这明显不是我们想要的。但自己写sql每次几十个字段也是醉了。如何优雅而又轻松地实现sql的自动生成呢？于是有了下面这个方法。</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>    <span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">*\r\n     * [array_to_sql 根据数组key和value拼接成需要的sql]\r\n     * @param  [type] $array   [key, value结构数组]\r\n     * @param  string $type    [sql类型insert,update]\r\n     * @param  array  $exclude [排除的字段]\r\n     * @return [string]          [返回拼接好的sql]\r\n     </span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n    function array_to_sql($array, $type</span>=<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">insert</span><span style=\"color: #800000;\">'</span>, $exclude =<span style=\"color: #000000;\"> array()){\r\n        \r\n        $sql </span>= <span style=\"color: #800000;\">''</span><span style=\"color: #000000;\">;\r\n        </span><span style=\"color: #0000ff;\">if</span>(count($array) &gt; <span style=\"color: #800080;\">0</span><span style=\"color: #000000;\">){\r\n            </span><span style=\"color: #0000ff;\">foreach</span> ($exclude <span style=\"color: #0000ff;\">as</span><span style=\"color: #000000;\"> $exkey) {\r\n                unset($array[$exkey]);</span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">剔除不要的key</span>\r\n<span style=\"color: #000000;\">            }\r\n\r\n            </span><span style=\"color: #0000ff;\">if</span>(<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">insert</span><span style=\"color: #800000;\">'</span> ==<span style=\"color: #000000;\"> $type){\r\n                $keys </span>=<span style=\"color: #000000;\"> array_keys($array);\r\n                $values </span>=<span style=\"color: #000000;\"> array_values($array);\r\n                $col </span>= implode(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">`, `</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">, $keys);\r\n                $val </span>= implode(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">', '</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">, $values);\r\n                $sql </span>= <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">(`$col`) values('$val')</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n            }</span><span style=\"color: #0000ff;\">else</span> <span style=\"color: #0000ff;\">if</span>(<span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">update</span><span style=\"color: #800000;\">'</span> ==<span style=\"color: #000000;\"> $type){\r\n                $tempsql </span>= <span style=\"color: #800000;\">''</span><span style=\"color: #000000;\">;\r\n                $temparr </span>=<span style=\"color: #000000;\"> array();\r\n                </span><span style=\"color: #0000ff;\">foreach</span> ($array <span style=\"color: #0000ff;\">as</span> $key =&gt;<span style=\"color: #000000;\"> $value) {\r\n                    $tempsql </span>= <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">'$key' = '$value'</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">;\r\n                    $temparr[] </span>=<span style=\"color: #000000;\"> $tempsql;\r\n                }\r\n\r\n                $sql </span>= implode(<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">,</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">, $temparr);\r\n            }\r\n        }\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> $sql;\r\n    }</span></pre>\r\n</div>\r\n<p> </p>\r\n<p>当然，这个方法还有很多可以斟酌的地方。能用，但不是最好的。园子的猿猿们你们有更好的方法吗？请告诉我吧！</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-09 20:32</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4491019\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4491019);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4491019,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/9 20:32:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4491019.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=21", "desc": "摘要: 会不会碰到这样一种情况呢？每次获取数据将数据和历史版本都有一定的差别，然而用ThinkPHP的addAll()函数，却会将已有的数据删掉再重新写入。这明显不是我们想要的。但自己写sql每次几十个字段也是醉了。如何优雅而又轻松地实现sql的自动生成呢？于是有了下面这个方法。 /** ..."}
{"title": "java切换VPN让你像幽灵一样出现在全国各地", "content": "　　在很多情况下，有些网络应用的需求会要求模拟人在不同地区访问网站和应用。因而切换IP也就应运而生了，然而IP作为一种稀缺资源不是随便可以获得的。因而会想到应用程序切换VPN来达到全国不同地区访问网络。因而有了以下方案。\r\n　　前提：\r\n　　　　1、windows操作系统\r\n　　　　2、手工新建网络连接\r\n\r\npackage com.selenium.test;\r\n\r\nimport java.io.BufferedReader;\r\nimport java.io.InputStream;\r\nimport java.io.InputStreamReader;\r\n\r\npublic class ConnectNetWork {\r\n\r\n    /**\r\n     * @param args\r\n     * @throws Exception \r\n     */\r\n    public static void main(String[] args) throws Exception {\r\n        // TODO Auto-generated method stub\r\n        connAdsl(\"VPN_Test\",\"test\", \"test\");  \r\n        Thread.sleep(1000);  \r\n        cutAdsl(\"VPN_Test\");  \r\n        Thread.sleep(1000);  \r\n    }\r\n\r\n    /** \r\n     * 执行CMD命令,并返回String字符串 \r\n     */  \r\n    public static String executeCmd(String strCmd) throws Exception {\r\n        System.out.println(\"cmd /c \" + strCmd);\r\n        Process p = Runtime.getRuntime().exec(\"cmd /c \" + strCmd);  \r\n        StringBuilder sbCmd = new StringBuilder();\r\n        //这里很重要，设置GB2312解决乱码！！！\r\n        //如果程序默认编码就是GB2312，可以不写\r\n        //我NetBeans默认用UTF8\r\n        BufferedReader br = new BufferedReader(new InputStreamReader(p  \r\n                .getInputStream(), \"GB2312\"));  \r\n        String line;  \r\n        while ((line = br.readLine()) != null) {  \r\n            sbCmd.append(line + \"\\n\");  \r\n        }\r\n        return sbCmd.toString();  \r\n        \r\n        /*\r\n        //如果整个过程换成这样，就更清楚了。getInputStream是获取最原始的字节流，\r\n        //cmd返回的是以GB2312双字节编码的字节流\r\n        InputStream in = p.getInputStream();\r\n        byte[] b = new byte[2000];\r\n        in.read(b);\r\n        String msg = new String(b, \"GB2312\");\r\n        //用GB2312解释这堆字节，就可以组装成一个正常的String了\r\n        //如果上边不写GB2312，等于这里用UTF8组装，结果一样\r\n        return msg;\r\n        */\r\n    }  \r\n  \r\n    /** \r\n     * 连接ADSL \r\n     * 语法： rasdial  连接名称 username password  \r\n     * 实例： rasdial 我的宽带 hzhz1234567890 dfdfdfdfdf  \r\n     */  \r\n    public static boolean connAdsl(String adslTitle, String adslName, String adslPass) throws Exception {  \r\n        System.out.println(\"正在建立连接.\");  \r\n        String adslCmd = \"rasdial \" + adslTitle + \" \" + adslName + \" \" + adslPass;  \r\n        String tempCmd = executeCmd(adslCmd); \r\n        //String tempCmd = executeCmd(\"ping www.youku.com\"); \r\n        \r\n        // 判断是否连接成功  \r\n        if (tempCmd.indexOf(\"已连接\") > 0) {  \r\n            System.out.println(\"已成功建立连接.\");  \r\n            return true;  \r\n        } else {  \r\n            System.err.println(tempCmd);  \r\n            System.err.println(\"建立连接失败\");  \r\n            return false;  \r\n        }  \r\n    }  \r\n  \r\n    /** \r\n     * 断开ADSL \r\n     */  \r\n    public static boolean cutAdsl(String adslTitle) throws Exception {  \r\n        String cutAdsl = \"rasdial \" + adslTitle + \" /disconnect\";  \r\n        String result = executeCmd(cutAdsl);  \r\n         \r\n        if (result.indexOf(\"没有连接\")!=-1){  \r\n            System.err.println(adslTitle + \"连接不存在!\");  \r\n            return false;  \r\n        } else {  \r\n            System.out.println(\"连接已断开\");  \r\n            return true;  \r\n        }  \r\n    }  \r\n}\r\n\r\n　　说明：上述代码片段其实是调用了windows的rasdial命令。所以主要的功劳还是rasdial，java只是个外壳。又一次曲线救国。大家有更好的方法吗？有更好的方法的话请告诉我，^_^...", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>java切换VPN让你像幽灵一样出现在全国各地 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4492604.html\">java切换VPN让你像幽灵一样出现在全国各地</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>　　在很多情况下，有些网络应用的需求会要求模拟人在不同地区访问网站和应用。因而切换IP也就应运而生了，然而IP作为一种稀缺资源不是随便可以获得的。因而会想到应用程序切换VPN来达到全国不同地区访问网络。因而有了以下方案。</p>\r\n<p>　　前提：</p>\r\n<p>　　　　1、windows操作系统</p>\r\n<p>　　　　2、手工新建网络连接</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">package</span><span style=\"color: #000000;\"> com.selenium.test;\r\n\r\n</span><span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> java.io.BufferedReader;\r\n</span><span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> java.io.InputStream;\r\n</span><span style=\"color: #0000ff;\">import</span><span style=\"color: #000000;\"> java.io.InputStreamReader;\r\n\r\n</span><span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">class</span><span style=\"color: #000000;\"> ConnectNetWork {\r\n\r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\">\r\n     * </span><span style=\"color: #808080;\">@param</span><span style=\"color: #008000;\"> args\r\n     * </span><span style=\"color: #808080;\">@throws</span><span style=\"color: #008000;\"> Exception \r\n     </span><span style=\"color: #008000;\">*/</span>\r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">void</span> main(String[] args) <span style=\"color: #0000ff;\">throws</span><span style=\"color: #000000;\"> Exception {\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> TODO Auto-generated method stub</span>\r\n        connAdsl(\"VPN_Test\",\"test\", \"test\"<span style=\"color: #000000;\">);  \r\n        Thread.sleep(</span>1000<span style=\"color: #000000;\">);  \r\n        cutAdsl(</span>\"VPN_Test\"<span style=\"color: #000000;\">);  \r\n        Thread.sleep(</span>1000<span style=\"color: #000000;\">);  </span><span style=\"color: #000000;\">\r\n    }\r\n\r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\"> \r\n     * 执行CMD命令,并返回String字符串 \r\n     </span><span style=\"color: #008000;\">*/</span>  \r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span> String executeCmd(String strCmd) <span style=\"color: #0000ff;\">throws</span><span style=\"color: #000000;\"> Exception {\r\n        System.out.println(</span>\"cmd /c \" +<span style=\"color: #000000;\"> strCmd);\r\n        Process p </span>= Runtime.getRuntime().exec(\"cmd /c \" +<span style=\"color: #000000;\"> strCmd);  \r\n        StringBuilder sbCmd </span>= <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> StringBuilder();\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">这里很重要，设置GB2312解决乱码！！！\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">如果程序默认编码就是GB2312，可以不写\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">我NetBeans默认用UTF8</span>\r\n        BufferedReader br = <span style=\"color: #0000ff;\">new</span> BufferedReader(<span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> InputStreamReader(p  \r\n                .getInputStream(), </span>\"GB2312\"<span style=\"color: #000000;\">));  \r\n        String line;  \r\n        </span><span style=\"color: #0000ff;\">while</span> ((line = br.readLine()) != <span style=\"color: #0000ff;\">null</span><span style=\"color: #000000;\">) {  \r\n            sbCmd.append(line </span>+ \"\\n\"<span style=\"color: #000000;\">);  \r\n        }\r\n        </span><span style=\"color: #0000ff;\">return</span><span style=\"color: #000000;\"> sbCmd.toString();  \r\n        \r\n        </span><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">\r\n        //如果整个过程换成这样，就更清楚了。getInputStream是获取最原始的字节流，\r\n        //cmd返回的是以GB2312双字节编码的字节流\r\n        InputStream in = p.getInputStream();\r\n        byte[] b = new byte[2000];\r\n        in.read(b);\r\n        String msg = new String(b, \"GB2312\");\r\n        //用GB2312解释这堆字节，就可以组装成一个正常的String了\r\n        //如果上边不写GB2312，等于这里用UTF8组装，结果一样\r\n        return msg;\r\n        </span><span style=\"color: #008000;\">*/</span><span style=\"color: #000000;\">\r\n    }  \r\n  \r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\"> \r\n     * 连接ADSL \r\n     * 语法： rasdial  连接名称 username password  \r\n     * 实例： rasdial 我的宽带 hzhz1234567890 dfdfdfdfdf  \r\n     </span><span style=\"color: #008000;\">*/</span>  \r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">boolean</span> connAdsl(String adslTitle, String adslName, String adslPass) <span style=\"color: #0000ff;\">throws</span><span style=\"color: #000000;\"> Exception {  \r\n        System.out.println(</span>\"正在建立连接.\"<span style=\"color: #000000;\">);  \r\n        String adslCmd </span>= \"rasdial \" + adslTitle + \" \" + adslName + \" \" +<span style=\"color: #000000;\"> adslPass;  \r\n        String tempCmd </span>=<span style=\"color: #000000;\"> executeCmd(adslCmd); \r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">String tempCmd = executeCmd(\"ping www.youku.com\"); \r\n        \r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 判断是否连接成功  </span>\r\n        <span style=\"color: #0000ff;\">if</span> (tempCmd.indexOf(\"已连接\") &gt; 0<span style=\"color: #000000;\">) {  \r\n            System.out.println(</span>\"已成功建立连接.\"<span style=\"color: #000000;\">);  \r\n            </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">;  \r\n        } </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\"> {  \r\n            System.err.println(tempCmd);  \r\n            System.err.println(</span>\"建立连接失败\"<span style=\"color: #000000;\">);  \r\n            </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">;  \r\n        }  \r\n    }  \r\n  \r\n    </span><span style=\"color: #008000;\">/**</span><span style=\"color: #008000;\"> \r\n     * 断开ADSL \r\n     </span><span style=\"color: #008000;\">*/</span>  \r\n    <span style=\"color: #0000ff;\">public</span> <span style=\"color: #0000ff;\">static</span> <span style=\"color: #0000ff;\">boolean</span> cutAdsl(String adslTitle) <span style=\"color: #0000ff;\">throws</span><span style=\"color: #000000;\"> Exception {  \r\n        String cutAdsl </span>= \"rasdial \" + adslTitle + \" /disconnect\"<span style=\"color: #000000;\">;  \r\n        String result </span>=<span style=\"color: #000000;\"> executeCmd(cutAdsl);  \r\n         \r\n        </span><span style=\"color: #0000ff;\">if</span> (result.indexOf(\"没有连接\")!=-1<span style=\"color: #000000;\">){  \r\n            System.err.println(adslTitle </span>+ \"连接不存在!\"<span style=\"color: #000000;\">);  \r\n            </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">false</span><span style=\"color: #000000;\">;  \r\n        } </span><span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\"> {  \r\n            System.out.println(</span>\"连接已断开\"<span style=\"color: #000000;\">);  \r\n            </span><span style=\"color: #0000ff;\">return</span> <span style=\"color: #0000ff;\">true</span><span style=\"color: #000000;\">;  \r\n        }  \r\n    }  \r\n}</span></pre>\r\n</div>\r\n<p>　　说明：上述代码片段其实是调用了windows的rasdial命令。所以主要的功劳还是rasdial，java只是个外壳。又一次曲线救国。大家有更好的方法吗？有更好的方法的话请告诉我，^_^...</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-10 17:49</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4492604\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4492604);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4492604,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/10 17:49:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4492604.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=21", "desc": "摘要: 在很多情况下，有些网络应用的需求会要求模拟人在不同地区访问网站和应用。因而切换IP也就应运而生了，然而IP作为一种稀缺资源不是随便可以获得的。因而会想到应用程序切换VPN来达到全国不同地区访问网络。java调用cmd命令，用rasdial切换IP，实现不同地区访问指定网站。"}
{"title": "如何让您的php也支持pthreads多线程", "content": "　　我们常常会碰到这样一种情况，开发环境在windows下开发，而生产环境确是linux。windows下能正常运行，上传到linux后却无法好好地玩耍了。然后开始了一轮尼玛式的疯狂的查找原因，最后发现是服务器环境问题。这时只能默默地爆一句shit。最近在用php多线程开发一个小功能也碰到类似的问题，在此记录一下。\r\n　　1、查找资料发现php5.3或以上，且线程安全版本，才支持多线程。于是通过phpinfo()查看，发现php版本过低且为非线程安全版本。因而首先需要升级php版本，由于采用了集成式的wdlinux，因而直接采用官网的升级方式。\r\n　　http://www.wdlinux.cn/bbs/thread-8044-1-1.html\r\n　　然而升级后，PHPinfo查看。Thread Safety仍为false，于是继续查找。发现PHP多线程支持，编译时需要添加配置项 --enable-maintainer-zts，这样线程才是安全的（Thread Safety）。创建线程时才不会报错。\r\n　　于是修改下升级脚本，添加--enable-maintainer-zts，然后一步步编译运行。再phpinfo查看，希望的情景终于出现了。\r\n　　\r\n\r\n\r\n#!/bin/bash\r\n# PHP 5.5 update scripts\r\n\r\nif [ ! $1 ];then\r\n    Ver=5.5.9\r\nelse\r\n    Ver=$1\r\nfi\r\n\r\nDebugfile=20121212\r\n\r\necho \"THANK YOU FOR USING UPDATE SCRIPT MADE BY  HTTP://WWW.AREFLY.COM & HTTP://WWW.ITBULU.COM\"\r\necho \"YOU ARE GOING TO UPDATE YOUR PHP TO ${Ver}\"\r\necho \"YOU CAN JUST HAVE A REST\"\r\necho \"IT MAY TAKE A LOT OF TIME\"\r\necho\r\n#read -p \"PRESS ENTER IF YOU REALLY WANT TO UPDATE\"\r\nread -p \"DO YOU REALLY WANT TO UPDATE? (Y/N)\" yn\r\nif [ \"$yn\" == \"Y\" ] || [ \"$yn\" == \"y\" ]; then\r\n    echo \"PHP IS NOW UPDATING!\"\r\nelse\r\n    exit\r\nfi\r\necho\r\necho \"-------------------------------------------------------------\"\r\necho\r\n\r\n###yum\r\nyum install -y libmcrypt-devel libjpeg-devel libpng-devel freetype-devel curl-devel openssl-devel libxml2-devel zip unzip\r\n\r\n###\r\nif [ ! -f php-${Ver}.tar.gz ];then\r\n    wget -c http://us1.php.net/distributions/php-${Ver}.tar.gz\r\nfi\r\nif [ ! -f iconv_ins.sh ];then\r\n    wget -c http://down.wdlinux.cn/in/iconv_ins.sh\r\n    sh iconv_ins.sh\r\nfi\r\n\r\n###\r\nif [ -f /www/wdlinux/mysql/lib/libmysqlclient.so.18 ];then\r\n    if [ -d /usr/lib64 ];then\r\n        LIBNCU=\"/usr/lib64\"\r\n    else\r\n        LIBNCU=\"/usr/lib\"\r\n    fi\r\n    ln -sf /www/wdlinux/mysql/lib/libmysqlclient.so.18 $LIBNCU\r\nfi\r\n\r\ntar zxvf php-${Ver}.tar.gz\r\ncd php-${Ver}\r\nif [ -d /www/wdlinux/apache_php ];then\r\necho \"START CONFIGURING PHP ON NGINX\"\r\nsleep 3\r\nmake clean\r\n    ./configure --prefix=/www/wdlinux/apache_php-${Ver} --with-config-file-path=/www/wdlinux/apache_php-${Ver}/etc --with-iconv=/usr --with-freetype-dir --with-jpeg-dir --with-png-dir --with-zlib --with-libxml-dir=/usr --enable-xml --disable-rpath --enable-inline-optimization --with-curl --enable-mbregex --enable-mbstring --with-mcrypt=/usr --with-gd --enable-gd-native-ttf --with-openssl --with-mhash --enable-ftp --enable-sockets --enable-zip --with-apxs2=/www/wdlinux/apache/bin/apxs --with-mysqli=/www/wdlinux/mysql/bin/mysql_config --with-pdo-mysql=/www/wdlinux/mysql --enable-opcache --enable-bcmath --with-mysql=mysqlnd --with-mysqli=mysqlnd --with-pdo-mysql=mysqlnd --enable-maintainer-zts\r\n[ $? != 0 ] && echo \"NO! CONFIGURE ERROR! TRY AGAIN OR ASK IN THE BBS! :(\" && exit\r\necho \"START MAKE\"\r\nsleep 3\r\nmake\r\n[ $? != 0 ] && echo \"NO! MAKE ERROR! TRY AGAIN OR ASK IN THE BBS! :(\" && exit\r\necho \"START MAKE INSTALL\"\r\nsleep 3\r\nmake install\r\n[ $? != 0 ] && echo \"NO! MAKE INSTALL ERROR! TRY AGAIN OR ASK IN THE BBS! :(\" && exit\r\ncp php.ini-production /www/wdlinux/apache_php-${Ver}/etc/php.ini\r\nsed -i 's/short_open_tag = Off/short_open_tag = On/g' /www/wdlinux/apache_php-${Ver}/etc/php.ini\r\nrm -f /www/wdlinux/apache_php\r\nln -sf /www/wdlinux/apache_php-${Ver} /www/wdlinux/apache_php\r\nif [ ! -d /www/wdlinux/apache_php-${Ver}/lib/php/extensions ];then\r\n    mkdir -p /www/wdlinux/apache_php-${Ver}/lib/php/extensions/no-debug-zts-${Debugfile}\r\n    ln -sf /www/wdlinux/apache_php-${Ver}/lib/php/extensions/no-debug-zts-${Debugfile} /www/wdlinux/apache_php-${Ver}/lib/php/extensions/no-debug-non-zts-${Debugfile}\r\nfi\r\nservice httpd restart\r\nfi\r\n\r\nif [ -d /www/wdlinux/nginx_php ];then\r\necho \"START CONFIGURING PHP ON APACHE\"\r\nsleep 3\r\nmake clean\r\n    ./configure --prefix=/www/wdlinux/nginx_php-${Ver} --with-config-file-path=/www/wdlinux/nginx_php-${Ver}/etc --with-iconv=/usr --with-freetype-dir --with-jpeg-dir --with-png-dir --with-zlib --with-libxml-dir=/usr --enable-xml --disable-rpath --enable-inline-optimization --with-curl --enable-mbregex --enable-mbstring --with-mcrypt=/usr --with-gd --enable-gd-native-ttf --with-openssl --with-mhash --enable-ftp --enable-sockets --enable-zip --enable-fpm --with-mysqli=/www/wdlinux/mysql/bin/mysql_config --with-pdo-mysql=/www/wdlinux/mysql --with-mysql=mysqlnd --with-mysqli=mysqlnd --with-pdo-mysql=mysqlnd\r\n[ $? != 0 ] && echo \"NO! CONFIGURE ERROR! TRY AGAIN OR ASK IN THE BBS! :(\" && exit\r\necho \"START MAKE\"\r\nsleep 3\r\nmake\r\n[ $? != 0 ] && echo \"NO! MAKE ERROR! TRY AGAIN OR ASK IN THE BBS! :(\" && exit\r\necho \"START MAKE INSTALL\"\r\nsleep 3\r\nmake install\r\n[ $? != 0 ] && echo \"NO! MAKE INSTALL ERROR! TRY AGAIN OR ASK IN THE BBS! :(\" && exit\r\ncp php.ini-production /www/wdlinux/nginx_php-${Ver}/etc/php.ini\r\nsed -i 's/short_open_tag = Off/short_open_tag = On/g' /www/wdlinux/nginx_php-${Ver}/etc/php.ini\r\nservice php-fpm stop\r\nrm -f /www/wdlinux/nginx_php\r\nln -sf /www/wdlinux/nginx_php-${Ver} /www/wdlinux/nginx_php\r\ncp /www/wdlinux/nginx_php-${Ver}/etc/php-fpm.conf.default /www/wdlinux/nginx_php-${Ver}/etc/php-fpm.conf\r\nsed -i 's/user = nobody/user = www/g' /www/wdlinux/nginx_php/etc/php-fpm.conf\r\nsed -i 's/group = nobody/group = www/g' /www/wdlinux/nginx_php/etc/php-fpm.conf\r\nsed -i 's/;pid =/pid =/g' /www/wdlinux/nginx_php/etc/php-fpm.conf\r\ncp -f sapi/fpm/init.d.php-fpm /www/wdlinux/init.d/php-fpm\r\nchmod 755 /www/wdlinux/init.d/php-fpm\r\nif [ ! -d /www/wdlinux/nginx_php-${Ver}/lib/php/extensions ];then\r\n    mkdir -p /www/wdlinux/nginx_php-${Ver}/lib/php/extensions/no-debug-zts-${Debugfile}\r\n    ln -sf /www/wdlinux/nginx_php-${Ver}/lib/php/extensions/no-debug-zts-${Debugfile} /www/wdlinux/nginx_php-${Ver}/lib/php/extensions/no-debug-non-zts-${Debugfile}\r\nfi\r\nfi\r\ncd ..\r\nrm -rf php-${Ver}/\r\nrm -rf php-${Ver}.tar.gz\r\nrm -rf iconv_ins.sh\r\necho\r\necho \"---------------------www.itbulu.com-------------------------------------\"\r\necho \"PHP UPDATE FINISH! :D\"\r\necho \"NOW YOUR PHP VERSION IS ${Ver}!\"\r\necho \"UPDATE SCRIPT MADE BY HTTP://WWW.AREFLY.COM & HTTP://WWW.ITBULU.COM \"\r\necho \"THANK YOU FOR USING\"\r\necho\r\necho \"WDCP (C) COPYRIGHT\"\r\necho\r\necho \"PS: I THINK YOU NEED RESTART SERVER AFTER UPDATE.\"\r\necho \"PS2: REMEMBER TO VISIT HTTP://WWW.AREFLY.COM & HTTP://WWW.ITBULU.COM! :D\"\r\necho\r\n\r\nView Code\r\n \r\n　　2、接下来是添加pthreads扩展\r\n　　PHP扩展下载：https://github.com/krakjoe/pthreads\r\n　　安装pthreads扩展\r\n\r\nunzip pthreads-master.zip\r\ncd pthreads-master\r\n/usr/local/php/bin/phpize\r\n./configure –with-php-config=/usr/local/php/bin/php-config\r\nmake\r\nmake install\r\n\r\n　　3、更改php.ini配置（phpinfo Loaded Configuration File 节点）\r\n　　　　vim /usr/local/php/etc/php.ini　　添加节点：\r\n　　上一步编译完成之后，会告诉你一个 pthreads.so 文件路径\r\n　　　　extension='/usr/local/php/lib/php/extensions/no-debug-zts-20121212/pthreads.so'\r\n　　以上节点是我机器路径，你们根据自己的情况更改\r\n　　保存、退出　　4、重启Apache\r\n　　　　/usr/local/apache/bin/httpd -k restart　　5、测试，直接写个php文件，new Thread，如果能输出类Obj，说明安装成功。\r\n　　参考资料：\r\nhttp://www.wdlinux.cn/bbs/thread-8044-1-1.html------------php多线程---------------http://www.thinkphp.cn/topic/22676.htmlhttp://www.laozuo.org/4387.html----------线程安全编译要求---------http://www.45it.com/net/201503/38547.htm\r\nhttp://zyan.cc/pthreads/", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>如何让您的php也支持pthreads多线程 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4492251.html\">如何让您的php也支持pthreads多线程</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>　　我们常常会碰到这样一种情况，开发环境在windows下开发，而生产环境确是linux。windows下能正常运行，上传到linux后却无法好好地玩耍了。然后开始了一轮尼玛式的疯狂的查找原因，最后发现是服务器环境问题。这时只能默默地爆一句shit。最近在用php多线程开发一个小功能也碰到类似的问题，在此记录一下。</p>\r\n<p>　　1、查找资料发现php5.3或以上，且线程安全版本，才支持多线程。于是通过phpinfo()查看，发现php版本过低且为非线程安全版本。因而首先需要升级php版本，由于采用了集成式的wdlinux，因而直接采用官网的升级方式。</p>\r\n<p>　　http://www.wdlinux.cn/bbs/thread-8044-1-1.html</p>\r\n<p>　　然而升级后，PHPinfo查看。Thread Safety仍为false，于是继续查找。发现PHP多线程支持，编译时需要添加配置项 <span style=\"color: #ff0000;\"><strong>--enable-maintainer-zts</strong></span>，这样线程才是安全的（Thread Safety）。创建线程时才不会报错。</p>\r\n<p>　　于是修改下升级脚本，添加<strong>--enable-maintainer-zts</strong>，然后一步步编译运行。再phpinfo查看，希望的情景终于出现了。</p>\r\n<p>　　</p>\r\n<div class=\"cnblogs_code\" onclick=\"cnblogs_code_show('f4774fd9-7e17-41d6-a888-fd4a9e4145b8')\"><img id=\"code_img_closed_f4774fd9-7e17-41d6-a888-fd4a9e4145b8\" class=\"code_img_closed\" src=\"http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif\" alt=\"\"><img id=\"code_img_opened_f4774fd9-7e17-41d6-a888-fd4a9e4145b8\" class=\"code_img_opened\" style=\"display: none;\" onclick=\"cnblogs_code_hide('f4774fd9-7e17-41d6-a888-fd4a9e4145b8',event)\" src=\"http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif\" alt=\"\">\r\n<div id=\"cnblogs_code_open_f4774fd9-7e17-41d6-a888-fd4a9e4145b8\" class=\"cnblogs_code_hide\">\r\n<pre>#!/bin/<span style=\"color: #000000;\">bash\r\n# PHP </span><span style=\"color: #800080;\">5.5</span><span style=\"color: #000000;\"> update scripts\r\n\r\n</span><span style=\"color: #0000ff;\">if</span> [ ! $<span style=\"color: #800080;\">1</span> ];<span style=\"color: #0000ff;\">then</span><span style=\"color: #000000;\">\r\n    Ver</span>=<span style=\"color: #800080;\">5.5</span>.<span style=\"color: #800080;\">9</span>\r\n<span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n    Ver</span>=$<span style=\"color: #800080;\">1</span>\r\n<span style=\"color: #0000ff;\">fi</span><span style=\"color: #000000;\">\r\n\r\nDebugfile</span>=<span style=\"color: #800080;\">20121212</span>\r\n\r\n<span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">THANK YOU FOR USING UPDATE SCRIPT MADE BY  HTTP://WWW.AREFLY.COM &amp; HTTP://WWW.ITBULU.COM</span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">YOU ARE GOING TO UPDATE YOUR PHP TO ${Ver}</span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">YOU CAN JUST HAVE A REST</span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">IT MAY TAKE A LOT OF TIME</span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">echo</span><span style=\"color: #000000;\">\r\n#read </span>-p <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">PRESS ENTER IF YOU REALLY WANT TO UPDATE</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\">\r\nread </span>-p <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">DO YOU REALLY WANT TO UPDATE? (Y/N)</span><span style=\"color: #800000;\">\"</span><span style=\"color: #000000;\"> yn\r\n</span><span style=\"color: #0000ff;\">if</span> [ <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">$yn</span><span style=\"color: #800000;\">\"</span> == <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">Y</span><span style=\"color: #800000;\">\"</span> ] || [ <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">$yn</span><span style=\"color: #800000;\">\"</span> == <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">y</span><span style=\"color: #800000;\">\"</span> ]; <span style=\"color: #0000ff;\">then</span>\r\n    <span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">PHP IS NOW UPDATING!</span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n    exit\r\n</span><span style=\"color: #0000ff;\">fi</span>\r\n<span style=\"color: #0000ff;\">echo</span>\r\n<span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">-------------------------------------------------------------</span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">echo</span><span style=\"color: #000000;\">\r\n\r\n###</span><span style=\"color: #0000ff;\">yum</span>\r\n<span style=\"color: #0000ff;\">yum</span> <span style=\"color: #0000ff;\">install</span> -y libmcrypt-devel libjpeg-devel libpng-devel freetype-devel curl-devel openssl-devel libxml2-devel <span style=\"color: #0000ff;\">zip</span> <span style=\"color: #0000ff;\">unzip</span><span style=\"color: #000000;\">\r\n\r\n###\r\n</span><span style=\"color: #0000ff;\">if</span> [ ! -f php-${Ver}.<span style=\"color: #0000ff;\">tar</span>.gz ];<span style=\"color: #0000ff;\">then</span>\r\n    <span style=\"color: #0000ff;\">wget</span> -c http:<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">us1.php.net/distributions/php-${Ver}.tar.gz</span>\r\n<span style=\"color: #0000ff;\">fi</span>\r\n<span style=\"color: #0000ff;\">if</span> [ ! -f iconv_ins.<span style=\"color: #0000ff;\">sh</span> ];<span style=\"color: #0000ff;\">then</span>\r\n    <span style=\"color: #0000ff;\">wget</span> -c http:<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">down.wdlinux.cn/in/iconv_ins.sh</span>\r\n    <span style=\"color: #0000ff;\">sh</span> iconv_ins.<span style=\"color: #0000ff;\">sh</span>\r\n<span style=\"color: #0000ff;\">fi</span><span style=\"color: #000000;\">\r\n\r\n###\r\n</span><span style=\"color: #0000ff;\">if</span> [ -f /www/wdlinux/mysql/lib/libmysqlclient.so.<span style=\"color: #800080;\">18</span> ];<span style=\"color: #0000ff;\">then</span>\r\n    <span style=\"color: #0000ff;\">if</span> [ -d /usr/lib64 ];<span style=\"color: #0000ff;\">then</span><span style=\"color: #000000;\">\r\n        LIBNCU</span>=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">/usr/lib64</span><span style=\"color: #800000;\">\"</span>\r\n    <span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">\r\n        LIBNCU</span>=<span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">/usr/lib</span><span style=\"color: #800000;\">\"</span>\r\n    <span style=\"color: #0000ff;\">fi</span>\r\n    <span style=\"color: #0000ff;\">ln</span> -sf /www/wdlinux/mysql/lib/libmysqlclient.so.<span style=\"color: #800080;\">18</span><span style=\"color: #000000;\"> $LIBNCU\r\n</span><span style=\"color: #0000ff;\">fi</span>\r\n\r\n<span style=\"color: #0000ff;\">tar</span> zxvf php-${Ver}.<span style=\"color: #0000ff;\">tar</span><span style=\"color: #000000;\">.gz\r\ncd php</span>-<span style=\"color: #000000;\">${Ver}\r\n</span><span style=\"color: #0000ff;\">if</span> [ -d /www/wdlinux/apache_php ];<span style=\"color: #0000ff;\">then</span>\r\n<span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">START CONFIGURING PHP ON NGINX</span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">sleep</span> <span style=\"color: #800080;\">3</span>\r\n<span style=\"color: #0000ff;\">make</span><span style=\"color: #000000;\"> clean\r\n    .</span>/configure --prefix=/www/wdlinux/apache_php-${Ver} --with-config-<span style=\"color: #0000ff;\">file</span>-path=/www/wdlinux/apache_php-${Ver}/etc --with-iconv=/usr --with-freetype-<span style=\"color: #0000ff;\">dir</span> --with-jpeg-<span style=\"color: #0000ff;\">dir</span> --with-png-<span style=\"color: #0000ff;\">dir</span> --with-zlib --with-libxml-<span style=\"color: #0000ff;\">dir</span>=/usr --enable-xml --disable-rpath --enable-inline-optimization --with-curl --enable-mbregex --enable-mbstring --with-mcrypt=/usr --with-gd --enable-gd-native-ttf --with-openssl --with-mhash --enable-<span style=\"color: #0000ff;\">ftp</span> --enable-sockets --enable-<span style=\"color: #0000ff;\">zip</span> --with-apxs2=/www/wdlinux/apache/bin/apxs --with-mysqli=/www/wdlinux/mysql/bin/mysql_config --with-pdo-mysql=/www/wdlinux/mysql --enable-opcache --enable-bcmath --with-mysql=mysqlnd --with-mysqli=mysqlnd --with-pdo-mysql=mysqlnd --enable-maintainer-<span style=\"color: #000000;\">zts\r\n[ $</span>? != <span style=\"color: #800080;\">0</span> ] &amp;&amp; <span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">NO! CONFIGURE ERROR! TRY AGAIN OR ASK IN THE BBS! :(</span><span style=\"color: #800000;\">\"</span> &amp;&amp;<span style=\"color: #000000;\"> exit\r\n</span><span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">START MAKE</span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">sleep</span> <span style=\"color: #800080;\">3</span>\r\n<span style=\"color: #0000ff;\">make</span><span style=\"color: #000000;\">\r\n[ $</span>? != <span style=\"color: #800080;\">0</span> ] &amp;&amp; <span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">NO! MAKE ERROR! TRY AGAIN OR ASK IN THE BBS! :(</span><span style=\"color: #800000;\">\"</span> &amp;&amp;<span style=\"color: #000000;\"> exit\r\n</span><span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">START MAKE INSTALL</span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">sleep</span> <span style=\"color: #800080;\">3</span>\r\n<span style=\"color: #0000ff;\">make</span> <span style=\"color: #0000ff;\">install</span><span style=\"color: #000000;\">\r\n[ $</span>? != <span style=\"color: #800080;\">0</span> ] &amp;&amp; <span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">NO! MAKE INSTALL ERROR! TRY AGAIN OR ASK IN THE BBS! :(</span><span style=\"color: #800000;\">\"</span> &amp;&amp;<span style=\"color: #000000;\"> exit\r\n</span><span style=\"color: #0000ff;\">cp</span> php.ini-production /www/wdlinux/apache_php-${Ver}/etc/<span style=\"color: #000000;\">php.ini\r\n</span><span style=\"color: #0000ff;\">sed</span> -i <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">s/short_open_tag = Off/short_open_tag = On/g</span><span style=\"color: #800000;\">'</span> /www/wdlinux/apache_php-${Ver}/etc/<span style=\"color: #000000;\">php.ini\r\n</span><span style=\"color: #0000ff;\">rm</span> -f /www/wdlinux/<span style=\"color: #000000;\">apache_php\r\n</span><span style=\"color: #0000ff;\">ln</span> -sf /www/wdlinux/apache_php-${Ver} /www/wdlinux/<span style=\"color: #000000;\">apache_php\r\n</span><span style=\"color: #0000ff;\">if</span> [ ! -d /www/wdlinux/apache_php-${Ver}/lib/php/extensions ];<span style=\"color: #0000ff;\">then</span>\r\n    <span style=\"color: #0000ff;\">mkdir</span> -p /www/wdlinux/apache_php-${Ver}/lib/php/extensions/no-debug-zts-<span style=\"color: #000000;\">${Debugfile}\r\n    </span><span style=\"color: #0000ff;\">ln</span> -sf /www/wdlinux/apache_php-${Ver}/lib/php/extensions/no-debug-zts-${Debugfile} /www/wdlinux/apache_php-${Ver}/lib/php/extensions/no-debug-non-zts-<span style=\"color: #000000;\">${Debugfile}\r\n</span><span style=\"color: #0000ff;\">fi</span><span style=\"color: #000000;\">\r\nservice httpd restart\r\n</span><span style=\"color: #0000ff;\">fi</span>\r\n\r\n<span style=\"color: #0000ff;\">if</span> [ -d /www/wdlinux/nginx_php ];<span style=\"color: #0000ff;\">then</span>\r\n<span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">START CONFIGURING PHP ON APACHE</span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">sleep</span> <span style=\"color: #800080;\">3</span>\r\n<span style=\"color: #0000ff;\">make</span><span style=\"color: #000000;\"> clean\r\n    .</span>/configure --prefix=/www/wdlinux/nginx_php-${Ver} --with-config-<span style=\"color: #0000ff;\">file</span>-path=/www/wdlinux/nginx_php-${Ver}/etc --with-iconv=/usr --with-freetype-<span style=\"color: #0000ff;\">dir</span> --with-jpeg-<span style=\"color: #0000ff;\">dir</span> --with-png-<span style=\"color: #0000ff;\">dir</span> --with-zlib --with-libxml-<span style=\"color: #0000ff;\">dir</span>=/usr --enable-xml --disable-rpath --enable-inline-optimization --with-curl --enable-mbregex --enable-mbstring --with-mcrypt=/usr --with-gd --enable-gd-native-ttf --with-openssl --with-mhash --enable-<span style=\"color: #0000ff;\">ftp</span> --enable-sockets --enable-<span style=\"color: #0000ff;\">zip</span> --enable-fpm --with-mysqli=/www/wdlinux/mysql/bin/mysql_config --with-pdo-mysql=/www/wdlinux/mysql --with-mysql=mysqlnd --with-mysqli=mysqlnd --with-pdo-mysql=<span style=\"color: #000000;\">mysqlnd\r\n[ $</span>? != <span style=\"color: #800080;\">0</span> ] &amp;&amp; <span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">NO! CONFIGURE ERROR! TRY AGAIN OR ASK IN THE BBS! :(</span><span style=\"color: #800000;\">\"</span> &amp;&amp;<span style=\"color: #000000;\"> exit\r\n</span><span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">START MAKE</span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">sleep</span> <span style=\"color: #800080;\">3</span>\r\n<span style=\"color: #0000ff;\">make</span><span style=\"color: #000000;\">\r\n[ $</span>? != <span style=\"color: #800080;\">0</span> ] &amp;&amp; <span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">NO! MAKE ERROR! TRY AGAIN OR ASK IN THE BBS! :(</span><span style=\"color: #800000;\">\"</span> &amp;&amp;<span style=\"color: #000000;\"> exit\r\n</span><span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">START MAKE INSTALL</span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">sleep</span> <span style=\"color: #800080;\">3</span>\r\n<span style=\"color: #0000ff;\">make</span> <span style=\"color: #0000ff;\">install</span><span style=\"color: #000000;\">\r\n[ $</span>? != <span style=\"color: #800080;\">0</span> ] &amp;&amp; <span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">NO! MAKE INSTALL ERROR! TRY AGAIN OR ASK IN THE BBS! :(</span><span style=\"color: #800000;\">\"</span> &amp;&amp;<span style=\"color: #000000;\"> exit\r\n</span><span style=\"color: #0000ff;\">cp</span> php.ini-production /www/wdlinux/nginx_php-${Ver}/etc/<span style=\"color: #000000;\">php.ini\r\n</span><span style=\"color: #0000ff;\">sed</span> -i <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">s/short_open_tag = Off/short_open_tag = On/g</span><span style=\"color: #800000;\">'</span> /www/wdlinux/nginx_php-${Ver}/etc/<span style=\"color: #000000;\">php.ini\r\nservice php</span>-<span style=\"color: #000000;\">fpm stop\r\n</span><span style=\"color: #0000ff;\">rm</span> -f /www/wdlinux/<span style=\"color: #000000;\">nginx_php\r\n</span><span style=\"color: #0000ff;\">ln</span> -sf /www/wdlinux/nginx_php-${Ver} /www/wdlinux/<span style=\"color: #000000;\">nginx_php\r\n</span><span style=\"color: #0000ff;\">cp</span> /www/wdlinux/nginx_php-${Ver}/etc/php-fpm.conf.default /www/wdlinux/nginx_php-${Ver}/etc/php-<span style=\"color: #000000;\">fpm.conf\r\n</span><span style=\"color: #0000ff;\">sed</span> -i <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">s/user = nobody/user = www/g</span><span style=\"color: #800000;\">'</span> /www/wdlinux/nginx_php/etc/php-<span style=\"color: #000000;\">fpm.conf\r\n</span><span style=\"color: #0000ff;\">sed</span> -i <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">s/group = nobody/group = www/g</span><span style=\"color: #800000;\">'</span> /www/wdlinux/nginx_php/etc/php-<span style=\"color: #000000;\">fpm.conf\r\n</span><span style=\"color: #0000ff;\">sed</span> -i <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">s/;pid =/pid =/g</span><span style=\"color: #800000;\">'</span> /www/wdlinux/nginx_php/etc/php-<span style=\"color: #000000;\">fpm.conf\r\n</span><span style=\"color: #0000ff;\">cp</span> -f sapi/fpm/init.d.php-fpm /www/wdlinux/init.d/php-<span style=\"color: #000000;\">fpm\r\n</span><span style=\"color: #0000ff;\">chmod</span> <span style=\"color: #800080;\">755</span> /www/wdlinux/init.d/php-<span style=\"color: #000000;\">fpm\r\n</span><span style=\"color: #0000ff;\">if</span> [ ! -d /www/wdlinux/nginx_php-${Ver}/lib/php/extensions ];<span style=\"color: #0000ff;\">then</span>\r\n    <span style=\"color: #0000ff;\">mkdir</span> -p /www/wdlinux/nginx_php-${Ver}/lib/php/extensions/no-debug-zts-<span style=\"color: #000000;\">${Debugfile}\r\n    </span><span style=\"color: #0000ff;\">ln</span> -sf /www/wdlinux/nginx_php-${Ver}/lib/php/extensions/no-debug-zts-${Debugfile} /www/wdlinux/nginx_php-${Ver}/lib/php/extensions/no-debug-non-zts-<span style=\"color: #000000;\">${Debugfile}\r\n</span><span style=\"color: #0000ff;\">fi</span>\r\n<span style=\"color: #0000ff;\">fi</span><span style=\"color: #000000;\">\r\ncd ..\r\n</span><span style=\"color: #0000ff;\">rm</span> -rf php-${Ver}/\r\n<span style=\"color: #0000ff;\">rm</span> -rf php-${Ver}.<span style=\"color: #0000ff;\">tar</span><span style=\"color: #000000;\">.gz\r\n</span><span style=\"color: #0000ff;\">rm</span> -rf iconv_ins.<span style=\"color: #0000ff;\">sh</span>\r\n<span style=\"color: #0000ff;\">echo</span>\r\n<span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">---------------------www.itbulu.com-------------------------------------</span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">PHP UPDATE FINISH! :D</span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">NOW YOUR PHP VERSION IS ${Ver}!</span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">UPDATE SCRIPT MADE BY HTTP://WWW.AREFLY.COM &amp; HTTP://WWW.ITBULU.COM </span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">THANK YOU FOR USING</span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">echo</span>\r\n<span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">WDCP (C) COPYRIGHT</span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">echo</span>\r\n<span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">PS: I THINK YOU NEED RESTART SERVER AFTER UPDATE.</span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">echo</span> <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">PS2: REMEMBER TO VISIT HTTP://WWW.AREFLY.COM &amp; HTTP://WWW.ITBULU.COM! :D</span><span style=\"color: #800000;\">\"</span>\r\n<span style=\"color: #0000ff;\">echo</span></pre>\r\n</div>\r\n<span class=\"cnblogs_code_collapse\">View Code</span></div>\r\n<p> </p>\r\n<p>　　2、接下来是添加pthreads扩展</p>\r\n<p>　　PHP扩展下载：https://github.com/krakjoe/pthreads</p>\r\n<p>　　安装pthreads扩展</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">unzip</span> pthreads-master.<span style=\"color: #0000ff;\">zip</span><span style=\"color: #000000;\">\r\ncd pthreads</span>-<span style=\"color: #000000;\">master\r\n</span>/usr/local/php/bin/<span style=\"color: #000000;\">phpize\r\n.</span>/configure –with-php-config=/usr/local/php/bin/php-<span style=\"color: #000000;\">config\r\n</span><span style=\"color: #0000ff;\">make</span>\r\n<span style=\"color: #0000ff;\">make</span> <span style=\"color: #0000ff;\">install</span></pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">　　3、更改php.ini配置（phpinfo Loaded Configuration File 节点）</span></p>\r\n<p><em id=\"__mceDel\">　　　　<span style=\"background-color: #ffff99;\">vim /usr/local/php/etc/php.ini</span><br>　　添加节点：</em></p>\r\n<p>　　上一步编译完成之后，会告诉你一个 pthreads.so 文件路径</p>\r\n<p><span style=\"background-color: #ffff99;\">　　　　extension='/usr/local/php/lib/php/extensions/no-debug-zts-20121212/pthreads.so'</span></p>\r\n<p>　　以上节点是我机器路径，你们根据自己的情况更改</p>\r\n<p>　　保存、退出<br>　　4、重启Apache</p>\r\n<p>　　　　<span style=\"background-color: #ffff99;\">/usr/local/apache/bin/httpd -k restart</span><br>　　5、测试，直接写个php文件，new Thread，如果能输出类Obj，说明安装成功。</p>\r\n<p>　　参考资料：</p>\r\n<p style=\"margin-left: 60px;\">http://www.wdlinux.cn/bbs/thread-8044-1-1.html<br>------------php多线程---------------<br>http://www.thinkphp.cn/topic/22676.html<br>http://www.laozuo.org/4387.html<br>----------线程安全编译要求---------<br>http://www.45it.com/net/201503/38547.htm</p>\r\n<p style=\"margin-left: 60px;\">http://zyan.cc/pthreads/</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-10 14:59</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4492251\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4492251);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4492251,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/10 14:59:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4492251.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=21", "desc": "摘要: 我们常常会碰到这样一种情况，开发环境在windows下开发，而生产环境确是linux。windows下能正常运行，上传到linux后却无法好好地玩耍了。然后开始了一轮尼玛式的疯狂的查找原因，最后发现是服务器环境问题。这时只能默默地爆一句shit。最近在用php多线程开发一个小功能也碰到类似的问题..."}
{"title": "div加jquery实现iframe标签的功能", "content": "　　由于最近项目需要，前端后台都完全采用div+css的方式布局。因而左思右想，有什么办法可以替代常用的iframe上下左右的布局方式，而且页面只是局部刷新。参考了许多前辈的资料，并加以整理，因而有了以下的方法。\r\n　　需求：\r\n　　　　1、由于是全局的div+css，由于每次提交的内容都会有所差异。\r\n　　　　2、每个提交都会用到，因而需要一个通用方法。\r\n　　　　3、返回的是html内容，因而需要指定一个显示区域\r\n　　因而写一个可复用的方法就显得尤为重要了，因而有了以下的方法。上码：\r\n\r\n/**\r\n * [btnsubmit 提交url并返回html]\r\n * @param  {[type]} btnid    [操作ID]\r\n * @param  {[type]} linkattr [提交url链接]\r\n * @param  {[type]} disid    [返回内容的显示区域ID]\r\n * @param  {[type]} prams    [提交参数列表（根据id获取），多个时用\"--\"分割]\r\n * @return {[type]}          [description]\r\n */\r\nfunction btnsubmit(btnid, linkattr, disid, prams){\r\n    //console.log('btnid==========' + btnid);\r\n    var $this = $('#' + btnid);\r\n    $this.attr('disabled', 'true');\r\n    $('.pagecontentheader button').attr('disabled', 'true');\r\n    _clickTab = $this.attr(linkattr); // 找到链接a中的targer的值\r\n    \r\n    var prams_data = '';\r\n    var prams_val = new Array();\r\n    //console.log($this.prop('tagName') + '===========prams==========' + _clickTab);\r\n    if(prams.length != 0){\r\n        var prams_arr = prams.split('--');\r\n        var prams_str = '';\r\n        //console.log(prams_str + '===========22222==========');\r\n        for(var i = 0; i < prams_arr.length; i++){\r\n            var tagName = $('#' + prams_arr[i]).prop('tagName');\r\n            var pramval = '';\r\n            //console.log(tagName + '===========tagName==========');\r\n            if('SELECT' == tagName){\r\n                pramval = $('#' + prams_arr[i] + \" option:selected\").text();\r\n                //console.log(tagName + '===========prams_str==='+'#' + prams_arr[i] + \" option:selected\"+'=======' + pramval);\r\n            }else{\r\n                pramval = $('#' + prams_arr[i]).val();\r\n            }\r\n            \r\n            prams_str = '\"' + prams_arr[i] + '\":\"' + pramval + '\"';\r\n            prams_val.push(prams_str);\r\n        };\r\n    }\r\n    var prams_data = \"{\" + prams_val.join(\",\") + \"}\";\r\n    prams_data = $.parseJSON(prams_data);//将字符串转成json格式的对象\r\n    //console.log(linkattr + '===========href==========' + prams_data);\r\n    if(_clickTab){\r\n        $.post(_clickTab,\r\n            prams_data,\r\n            function(data){\r\n                $(\"#\" + disid).html(data);\r\n            }\r\n        );\r\n    }\r\n}\r\n\r\n注意：prams参数如果有换行符等特殊字符需要自行处理。\r\n调用方式：\r\n\r\n<button type=\"button\" class=\"btn btn-default shiny\" id=\"getRemark\" target=\"__CONTROLLER__/remark\" onclick=\"btnsubmit('getRemark', 'target', 'page-content', 'reservation')\">更新备注</button>\r\n\r\n\r\n<a id=\"linkOrderLst\" target=\"__CONTROLLER__/lst\" onclick=\"btnsubmit('linkOrderLst', 'target', 'page-content', '')\">订单列表</a></li>\r\n\r\n许多地方还考虑不周，你有更好的处理方式吗？请告诉我。。。", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>div加jquery实现iframe标签的功能 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4491752.html\">div加jquery实现iframe标签的功能</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>　　由于最近项目需要，前端后台都完全采用div+css的方式布局。因而左思右想，有什么办法可以替代常用的iframe上下左右的布局方式，而且页面只是局部刷新。参考了许多前辈的资料，并加以整理，因而有了以下的方法。</p>\r\n<p>　　需求：</p>\r\n<p>　　　　1、由于是全局的div+css，由于每次提交的内容都会有所差异。</p>\r\n<p>　　　　2、每个提交都会用到，因而需要一个通用方法。</p>\r\n<p>　　　　3、返回的是html内容，因而需要指定一个显示区域</p>\r\n<p>　　因而写一个可复用的方法就显得尤为重要了，因而有了以下的方法。上码：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #008000;\">/*</span><span style=\"color: #008000;\">*\r\n * [btnsubmit 提交url并返回html]\r\n * @param  {[type]} btnid    [操作ID]\r\n * @param  {[type]} linkattr [提交url链接]\r\n * @param  {[type]} disid    [返回内容的显示区域ID]\r\n * @param  {[type]} prams    [提交参数列表（根据id获取），多个时用\"--\"分割]\r\n * @return {[type]}          [description]\r\n </span><span style=\"color: #008000;\">*/</span>\r\n<span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\"> btnsubmit(btnid, linkattr, disid, prams){\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">console.log('btnid==========' + btnid);</span>\r\n    <span style=\"color: #0000ff;\">var</span> $<span style=\"color: #0000ff;\">this</span> = $('#' +<span style=\"color: #000000;\"> btnid);\r\n    $</span><span style=\"color: #0000ff;\">this</span>.attr('disabled', 'true'<span style=\"color: #000000;\">);\r\n    $(</span>'.pagecontentheader button').attr('disabled', 'true'<span style=\"color: #000000;\">);</span><span style=\"color: #000000;\">\r\n    _clickTab </span>= $<span style=\"color: #0000ff;\">this</span>.attr(linkattr); <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\"> 找到链接a中的targer的值</span>\r\n    \r\n    <span style=\"color: #0000ff;\">var</span> prams_data = ''<span style=\"color: #000000;\">;\r\n    </span><span style=\"color: #0000ff;\">var</span> prams_val = <span style=\"color: #0000ff;\">new</span><span style=\"color: #000000;\"> Array();\r\n    </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">console.log($this.prop('tagName') + '===========prams==========' + _clickTab);</span>\r\n    <span style=\"color: #0000ff;\">if</span>(prams.length != 0<span style=\"color: #000000;\">){\r\n        </span><span style=\"color: #0000ff;\">var</span> prams_arr = prams.split('--'<span style=\"color: #000000;\">);\r\n        </span><span style=\"color: #0000ff;\">var</span> prams_str = ''<span style=\"color: #000000;\">;\r\n        </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">console.log(prams_str + '===========22222==========');</span>\r\n        <span style=\"color: #0000ff;\">for</span>(<span style=\"color: #0000ff;\">var</span> i = 0; i &lt; prams_arr.length; i++<span style=\"color: #000000;\">){\r\n            </span><span style=\"color: #0000ff;\">var</span> tagName = $('#' + prams_arr[i]).prop('tagName'<span style=\"color: #000000;\">);\r\n            </span><span style=\"color: #0000ff;\">var</span> pramval = ''<span style=\"color: #000000;\">;\r\n            </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">console.log(tagName + '===========tagName==========');</span>\r\n            <span style=\"color: #0000ff;\">if</span>('SELECT' ==<span style=\"color: #000000;\"> tagName){\r\n                pramval </span>= $('#' + prams_arr[i] + \" option:selected\"<span style=\"color: #000000;\">).text();\r\n                </span><span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">console.log(tagName + '===========prams_str==='+'#' + prams_arr[i] + \" option:selected\"+'=======' + pramval);</span>\r\n            }<span style=\"color: #0000ff;\">else</span><span style=\"color: #000000;\">{\r\n                pramval </span>= $('#' +<span style=\"color: #000000;\"> prams_arr[i]).val();\r\n            }\r\n            \r\n            prams_str </span>= '\"' + prams_arr[i] + '\":\"' + pramval + '\"'<span style=\"color: #000000;\">;\r\n            prams_val.push(prams_str);\r\n        };\r\n    }\r\n    </span><span style=\"color: #0000ff;\">var</span> prams_data = \"{\" + prams_val.join(\",\") + \"}\"<span style=\"color: #000000;\">;\r\n    prams_data </span>= $.parseJSON(prams_data);<span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">将字符串转成json格式的对象</span>\r\n    <span style=\"color: #008000;\">//</span><span style=\"color: #008000;\">console.log(linkattr + '===========href==========' + prams_data);</span>\r\n    <span style=\"color: #0000ff;\">if</span><span style=\"color: #000000;\">(_clickTab){\r\n        $.post(_clickTab,\r\n            prams_data,\r\n            </span><span style=\"color: #0000ff;\">function</span><span style=\"color: #000000;\">(data){\r\n                $(</span>\"#\" +<span style=\"color: #000000;\"> disid).html(data);\r\n            }\r\n        );\r\n    }\r\n}</span></pre>\r\n</div>\r\n<p><span style=\"background-color: #ffff99;\"><strong>注意：prams参数如果有换行符等特殊字符需要自行处理。</strong></span></p>\r\n<p>调用方式：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre>&lt;button type=\"button\" class=\"btn btn-default shiny\" id=\"getRemark\" target=\"__CONTROLLER__/remark\" onclick=\"btnsubmit('getRemark', 'target', 'page-content', 'reservation')\"&gt;更新备注&lt;/button&gt;</pre>\r\n</div>\r\n<div class=\"cnblogs_code\">\r\n<pre>&lt;a id=\"linkOrderLst\" target=\"__CONTROLLER__/lst\" onclick=\"btnsubmit('linkOrderLst', 'target', 'page-content', '')\"&gt;订单列表&lt;/a&gt;&lt;/li&gt;</pre>\r\n</div>\r\n<p>许多地方还考虑不周，你有更好的处理方式吗？请告诉我。。。</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-10 09:25</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4491752\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4491752);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4491752,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/10 9:25:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4491752.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=21", "desc": "摘要: 由于最近项目需要，前端后台都完全采用div+css的方式布局。因而左思右想，有什么办法可以替代常用的iframe上下左右的布局方式，而且页面只是局部刷新。参考了许多前辈的资料，并加以整理，因而有了以下的方法。 需求： 1、由于是全局的div+css，由于每次提交的内容都会有所差异。 ..."}
{"title": "linux下用cronolog分割apache日志", "content": "linux下用cronolog分割apache日志，大神莫拍砖，菜鸟留一记录，小白请默默转载。连linux登陆和vi编辑都不会的，请默默关闭此页面。入正题\r\n说明：淡绿色底的为linux命令，其他的为备注说明。\r\n下载cronolog\r\nwget \"http://download.chinaunix.net/down.php?id=3457&ResourceID=1851&site=1\"#解压缩tar -xzvf cronolog-1.6.2.tar.gz#进入目录cd cronolog-1.6.2#列出所有文件ll#configure./configure --prefix=/usr/local/cronolog#makemake#安装make install#进入httpd的配置文件目录cd /chinasofti/apache/conf/extra#备份httpd的配置文件cp httpd-vhosts.conf httpd-vhosts.conf.20150508#编辑httpd的配置文件vi httpd.conf\r\n修改淡黄色底部分即可，注意红色部分的日志目录哦！\r\n<VirtualHost *:80>    DocumentRoot /chinasofti/www/wwwroot/mywebdir    ServerName  www.myweb.com    ServerAlias www.myweb.com    <Directory \"/chinasofti/www/wwwroot/mywebdir/\">        Options -Indexes FollowSymLinks        AllowOverride All        Order allow,deny        Allow from all    </Directory>ErrorLog \"|/usr/local/cronolog/sbin/cronolog /chinasofti/www/wwwroot/mywebdir/myweb_http_logs/myweb.com-error_log_%Y%m%d\"CustomLog \"|/usr/local/cronolog/sbin/cronolog /chinasofti/www/wwwroot/mywebdir/myweb_http_logs/myweb.com-access_log_%Y%m%d\" common</VirtualHost>\r\n保存退出。\r\n#重启apache\r\nservice httpd restart\r\n检查日志分割是否成功", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>linux下用cronolog分割apache日志 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4488396.html\">linux下用cronolog分割apache日志</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>linux下用cronolog分割apache日志，大神莫拍砖，菜鸟留一记录，小白请默默转载。连linux登陆和vi编辑都不会的，请默默关闭此页面。入正题</p>\r\n<p>说明：淡绿色底的为linux命令，其他的为备注说明。</p>\r\n<p>下载cronolog</p>\r\n<p><span style=\"background-color: #ccffcc;\">wget \"http://download.chinaunix.net/down.php?id=3457&amp;ResourceID=1851&amp;site=1\"</span><br>#解压缩<br><span style=\"background-color: #ccffcc;\">tar -xzvf cronolog-1.6.2.tar.gz</span><br>#进入目录<br><span style=\"background-color: #ccffcc;\">cd cronolog-1.6.2</span><br>#列出所有文件<br><span style=\"background-color: #ccffcc;\">ll</span><br>#configure<br><span style=\"background-color: #ccffcc;\">./configure --prefix=/usr/local/cronolog</span><br>#make<br><span style=\"background-color: #ccffcc;\">make</span><br>#安装<br><span style=\"background-color: #ccffcc;\">make install</span><br>#进入httpd的配置文件目录<br><span style=\"background-color: #ccffcc;\">cd /chinasofti/apache/conf/extra</span><br>#备份httpd的配置文件<br><span style=\"background-color: #ccffcc;\">cp httpd-vhosts.conf httpd-vhosts.conf.20150508</span><br>#编辑httpd的配置文件<br><span style=\"background-color: #ccffcc;\">vi httpd.conf</span></p>\r\n<p><span style=\"background-color: #ffff99;\">修改淡黄色底部分即可，注意<span style=\"font-size: 16px;\"><strong>红色部分的<span style=\"color: #ff0000;\">日志目录</span></strong></span>哦！</span></p>\r\n<p>&lt;VirtualHost *:80&gt;<br>    DocumentRoot /chinasofti/www/wwwroot/mywebdir<br>    ServerName  www.myweb.com<br>    ServerAlias www.myweb.com<br>    &lt;Directory \"/chinasofti/www/wwwroot/mywebdir/\"&gt;<br>        Options -Indexes FollowSymLinks<br>        AllowOverride All<br>        Order allow,deny<br>        Allow from all<br>    &lt;/Directory&gt;<br><span style=\"background-color: #ffff99;\">ErrorLog \"|/usr/local/cronolog/sbin/cronolog <span style=\"color: #ff0000;\"><strong>/chinasofti/www/wwwroot/mywebdir/myweb_http_logs</strong></span>/myweb.com-error_log_%Y%m%d\"</span><br><span style=\"background-color: #ffff99;\">CustomLog \"|/usr/local/cronolog/sbin/cronolog <span style=\"color: #ff0000;\"><strong>/chinasofti/www/wwwroot/mywebdir/myweb_http_logs</strong></span>/myweb.com-access_log_%Y%m%d\" common</span><br>&lt;/VirtualHost&gt;</p>\r\n<p>保存退出。</p>\r\n<p>#重启apache</p>\r\n<p><span style=\"background-color: #ccffcc;\">service httpd restart</span></p>\r\n<p>检查日志分割是否成功</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-08 17:43</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4488396\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4488396);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4488396,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/8 17:43:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4488396.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=21", "desc": "摘要: linux下用cronolog分割apache日志，大神莫拍砖，菜鸟留一记录，小白请默默转载。连linux登陆和vi编辑都不会的，请默默关闭此页面。入正题说明：淡绿色底的为linux命令，其他的为备注说明。下载cronologwget \"http://download.chinaunix.net/d..."}
{"title": "【转】sed 简明教程", "content": "本文转自：http://coolshell.cn/articles/9104.html\r\nawk于1977年出生，今年36岁本命年，sed比awk大2-3岁，awk就像林妹妹，sed就是宝玉哥哥了。所以 林妹妹跳了个Topless，他的哥哥sed坐不住了，也一定要出来抖一抖。\r\nsed全名叫stream editor，流编辑器，用程序的方式来编辑文本，相当的hacker啊。sed基本上就是玩正则模式匹配，所以，玩sed的人，正则表达式一般都比较强。\r\n同样，本篇文章不会说sed的全部东西，你可以参看sed的手册，我这里主要还是想和大家竞争一下那些从手机指缝间或马桶里流走的时间，用这些时间来学习一些东西。当然，接下来的还是要靠大家自己双手。\r\n用s命令替换\r\n我使用下面的这段文本做演示：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n\r\n\r\n\r\n$ cat pets.txt\r\nThis is my cat\r\n  my cat's name is betty\r\nThis is my dog\r\n  my dog's name is frank\r\nThis is my fish\r\n  my fish's name is george\r\nThis is my goat\r\n  my goat's name is adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n把其中的my字符串替换成Hao Chen’s，下面的语句应该很好理解（s表示替换命令，/my/表示匹配my，/Hao Chen’s/表示把匹配替换成Hao Chen’s，/g 表示一行上的替换所有的匹配）：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n\r\n\r\n\r\n$ sed \"s/my/Hao Chen's/g\" pets.txt\r\nThis is Hao Chen's cat\r\n  Hao Chen's cat's name is betty\r\nThis is Hao Chen's dog\r\n  Hao Chen's dog's name is frank\r\nThis is Hao Chen's fish\r\n  Hao Chen's fish's name is george\r\nThis is Hao Chen's goat\r\n  Hao Chen's goat's name is adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n注意：如果你要使用单引号，那么你没办法通过\\’这样来转义，就有双引号就可以了，在双引号内可以用\\”来转义。\r\n \r\n再注意：上面的sed并没有对文件的内容改变，只是把处理过后的内容输出，如果你要写回文件，你可以使用重定向，如：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n\r\n\r\n\r\n$ sed \"s/my/Hao Chen's/g\" pets.txt > hao_pets.txt\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n或使用 -i 参数直接修改文件内容：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n\r\n\r\n\r\n$ sed -i \"s/my/Hao Chen's/g\" pets.txt\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n在每一行最前面加点东西：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n\r\n\r\n\r\n$ sed 's/^/#/g' pets.txt\r\n#This is my cat\r\n#  my cat's name is betty\r\n#This is my dog\r\n#  my dog's name is frank\r\n#This is my fish\r\n#  my fish's name is george\r\n#This is my goat\r\n#  my goat's name is adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n在每一行最后面加点东西：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n\r\n\r\n\r\n$ sed 's/$/ --- /g' pets.txt\r\nThis is my cat ---\r\n  my cat's name is betty ---\r\nThis is my dog ---\r\n  my dog's name is frank ---\r\nThis is my fish ---\r\n  my fish's name is george ---\r\nThis is my goat ---\r\n  my goat's name is adam ---\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n顺手介绍一下正则表达式的一些最基本的东西：\r\n\r\n^ 表示一行的开头。如：/^#/ 以#开头的匹配。\r\n$ 表示一行的结尾。如：/}$/ 以}结尾的匹配。\r\n\\< 表示词首。 如 \\<abc 表示以 abc 为首的詞。\r\n\\> 表示词尾。 如 abc\\> 表示以 abc 結尾的詞。\r\n. 表示任何单个字符。\r\n* 表示某个字符出现了0次或多次。\r\n[ ] 字符集合。 如：[abc]表示匹配a或b或c，还有[a-zA-Z]表示匹配所有的26个字符。如果其中有^表示反，如[^a]表示非a的字符\r\n\r\n正规则表达式是一些很牛的事，比如我们要去掉某html中的tags：\r\n\r\n\r\nhtml.txt\r\n\r\n\r\n\r\n1\r\n\r\n\r\n\r\n<b>This</b> is what <span style=\"text-decoration: underline;\">I</span> meant. Understand?\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n看看我们的sed命令\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n\r\n\r\n\r\n# 如果你这样搞的话，就会有问题\r\n$ sed 's/<.*>//g' html.txt\r\n Understand?\r\n \r\n# 要解决上面的那个问题，就得像下面这样。\r\n# 其中的'[^>]' 指定了除了>的字符重复0次或多次。\r\n$ sed 's/<[^>]*>//g' html.txt\r\nThis is what I meant. Understand?\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n我们再来看看指定需要替换的内容：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n\r\n\r\n\r\n$ sed \"3s/my/your/g\" pets.txt\r\nThis is my cat\r\n  my cat's name is betty\r\nThis is your dog\r\n  my dog's name is frank\r\nThis is my fish\r\n  my fish's name is george\r\nThis is my goat\r\n  my goat's name is adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n下面的命令只替换第3到第6行的文本。\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n\r\n\r\n\r\n$ sed \"3,6s/my/your/g\" pets.txt\r\nThis is my cat\r\n  my cat's name is betty\r\nThis is your dog\r\n  your dog's name is frank\r\nThis is your fish\r\n  your fish's name is george\r\nThis is my goat\r\n  my goat's name is adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n \r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n\r\n\r\n\r\n$ cat my.txt\r\nThis is my cat, my cat's name is betty\r\nThis is my dog, my dog's name is frank\r\nThis is my fish, my fish's name is george\r\nThis is my goat, my goat's name is adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n只替换每一行的第一个s：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n\r\n\r\n\r\n$ sed 's/s/S/1' my.txt\r\nThiS is my cat, my cat's name is betty\r\nThiS is my dog, my dog's name is frank\r\nThiS is my fish, my fish's name is george\r\nThiS is my goat, my goat's name is adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n只替换每一行的第二个s：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n\r\n\r\n\r\n$ sed 's/s/S/2' my.txt\r\nThis iS my cat, my cat's name is betty\r\nThis iS my dog, my dog's name is frank\r\nThis iS my fish, my fish's name is george\r\nThis iS my goat, my goat's name is adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n只替换第一行的第3个以后的s：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n\r\n\r\n\r\n$ sed 's/s/S/3g' my.txt\r\nThis is my cat, my cat'S name iS betty\r\nThis is my dog, my dog'S name iS frank\r\nThis is my fiSh, my fiSh'S name iS george\r\nThis is my goat, my goat'S name iS adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n多个匹配\r\n如果我们需要一次替换多个模式，可参看下面的示例：（第一个模式把第一行到第三行的my替换成your，第二个则把第3行以后的This替换成了That）\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n\r\n\r\n\r\n$ sed '1,3s/my/your/g; 3,$s/This/That/g' my.txt\r\nThis is your cat, your cat's name is betty\r\nThis is your dog, your dog's name is frank\r\nThat is your fish, your fish's name is george\r\nThat is my goat, my goat's name is adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n上面的命令等价于：（注：下面使用的是sed的-e命令行参数）\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n\r\n\r\n\r\nsed -e '1,3s/my/your/g' -e '3,$s/This/That/g' my.txt\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n我们可以使用&来当做被匹配的变量，然后可以在基本左右加点东西。如下所示：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n\r\n\r\n\r\n$ sed 's/my/[&]/g' my.txt\r\nThis is [my] cat, [my] cat's name is betty\r\nThis is [my] dog, [my] dog's name is frank\r\nThis is [my] fish, [my] fish's name is george\r\nThis is [my] goat, [my] goat's name is adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n圆括号匹配\r\n使用圆括号匹配的示例：（圆括号括起来的正则表达式所匹配的字符串会可以当成变量来使用，sed中使用的是\\1,\\2…）\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n\r\n\r\n\r\n$ sed 's/This is my \\([^,]*\\),.*is \\(.*\\)/\\1:\\2/g' my.txt\r\ncat:betty\r\ndog:frank\r\nfish:george\r\ngoat:adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n上面这个例子中的正则表达式有点复杂，解开如下（去掉转义字符）：\r\n正则为：This is my ([^,]*),.*is (.*)匹配为：This is my (cat),……….is (betty)\r\n然后：\\1就是cat，\\2就是betty\r\nsed的命令\r\n让我们回到最一开始的例子pets.txt，让我们来看几个命令：\r\nN命令\r\n先来看N命令 —— 把下一行的内容纳入当成缓冲区做匹配。\r\n下面的的示例会把原文本中的偶数行纳入奇数行匹配，而s只匹配并替换一次，所以，就成了下面的结果：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n\r\n\r\n\r\n\r\n$ sed 'N;s/my/your/' pets.txt\r\nThis is your cat\r\n  my cat's name is betty\r\nThis is your dog\r\n  my dog's name is frank\r\nThis is your fish\r\n  my fish's name is george\r\nThis is your goat\r\n  my goat's name is adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n也就是说，原来的文件成了：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n\r\n\r\n\r\n\r\nThis is my cat\\n  my cat's name is betty\r\nThis is my dog\\n  my dog's name is frank\r\nThis is my fish\\n  my fish's name is george\r\nThis is my goat\\n  my goat's name is adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n这样一来，下面的例子你就明白了，\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n\r\n\r\n\r\n\r\n$ sed 'N;s/\\n/,/' pets.txt\r\nThis is my cat,  my cat's name is betty\r\nThis is my dog,  my dog's name is frank\r\nThis is my fish,  my fish's name is george\r\nThis is my goat,  my goat's name is adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\na命令和i命令\r\na命令就是append， i命令就是insert，它们是用来添加行的。如：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n11\r\n12\r\n13\r\n14\r\n15\r\n\r\n\r\n\r\n\r\n# 其中的1i表明，其要在第1行前插入一行（insert）\r\n$ sed \"1 i This is my monkey, my monkey's name is wukong\" my.txt\r\nThis is my monkey, my monkey's name is wukong\r\nThis is my cat, my cat's name is betty\r\nThis is my dog, my dog's name is frank\r\nThis is my fish, my fish's name is george\r\nThis is my goat, my goat's name is adam\r\n \r\n# 其中的1a表明，其要在最后一行后追加一行（append）\r\n$ sed \"$ a This is my monkey, my monkey's name is wukong\" my.txt\r\nThis is my cat, my cat's name is betty\r\nThis is my monkey, my monkey's name is wukong\r\nThis is my dog, my dog's name is frank\r\nThis is my fish, my fish's name is george\r\nThis is my goat, my goat's name is adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n我们可以运用匹配来添加文本：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n\r\n\r\n\r\n\r\n# 注意其中的/fish/a，这意思是匹配到/fish/后就追加一行\r\n$ sed \"/fish/a This is my monkey, my monkey's name is wukong\" my.txt\r\nThis is my cat, my cat's name is betty\r\nThis is my dog, my dog's name is frank\r\nThis is my fish, my fish's name is george\r\nThis is my monkey, my monkey's name is wukong\r\nThis is my goat, my goat's name is adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n下面这个例子是对每一行都挺插入：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n\r\n\r\n\r\n\r\n$ sed \"/my/a ----\" my.txt\r\nThis is my cat, my cat's name is betty\r\n----\r\nThis is my dog, my dog's name is frank\r\n----\r\nThis is my fish, my fish's name is george\r\n----\r\nThis is my goat, my goat's name is adam\r\n----\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nc命令\r\nc 命令是替换匹配行\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n11\r\n\r\n\r\n\r\n\r\n$ sed \"2 c This is my monkey, my monkey's name is wukong\" my.txt\r\nThis is my cat, my cat's name is betty\r\nThis is my monkey, my monkey's name is wukong\r\nThis is my fish, my fish's name is george\r\nThis is my goat, my goat's name is adam\r\n \r\n$ sed \"/fish/c This is my monkey, my monkey's name is wukong\" my.txt\r\nThis is my cat, my cat's name is betty\r\nThis is my dog, my dog's name is frank\r\nThis is my monkey, my monkey's name is wukong\r\nThis is my goat, my goat's name is adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nd命令\r\n删除匹配行\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n11\r\n12\r\n\r\n\r\n\r\n\r\n$ sed '/fish/d' my.txt\r\nThis is my cat, my cat's name is betty\r\nThis is my dog, my dog's name is frank\r\nThis is my goat, my goat's name is adam\r\n \r\n$ sed '2d' my.txt\r\nThis is my cat, my cat's name is betty\r\nThis is my fish, my fish's name is george\r\nThis is my goat, my goat's name is adam\r\n \r\n$ sed '2,$d' my.txt\r\nThis is my cat, my cat's name is betty\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\np命令\r\n打印命令\r\n你可以把这个命令当成grep式的命令\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n11\r\n12\r\n13\r\n14\r\n15\r\n16\r\n17\r\n18\r\n19\r\n20\r\n21\r\n22\r\n23\r\n\r\n\r\n\r\n\r\n# 匹配fish并输出，可以看到fish的那一行被打了两遍，\r\n# 这是因为sed处理时会把处理的信息输出\r\n$ sed '/fish/p' my.txt\r\nThis is my cat, my cat's name is betty\r\nThis is my dog, my dog's name is frank\r\nThis is my fish, my fish's name is george\r\nThis is my fish, my fish's name is george\r\nThis is my goat, my goat's name is adam\r\n \r\n# 使用n参数就好了\r\n$ sed -n '/fish/p' my.txt\r\nThis is my fish, my fish's name is george\r\n \r\n# 从一个模式到另一个模式\r\n$ sed -n '/dog/,/fish/p' my.txt\r\nThis is my dog, my dog's name is frank\r\nThis is my fish, my fish's name is george\r\n \r\n#从第一行打印到匹配fish成功的那一行\r\n$ sed -n '1,/fish/p' my.txt\r\nThis is my cat, my cat's name is betty\r\nThis is my dog, my dog's name is frank\r\nThis is my fish, my fish's name is george\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n几个知识点\r\n好了，下面我们要介绍四个sed的基本知识点：\r\nPattern Space\r\n第零个是关于-n参数的，大家也许没看懂，没关系，我们来看一下sed处理文本的伪代码，并了解一下Pattern Space的概念：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n11\r\n12\r\n\r\n\r\n\r\n\r\nforeach line in file {\r\n    //放入把行Pattern_Space\r\n    Pattern_Space <= line;\r\n \r\n    // 对每个pattern space执行sed命令\r\n    Pattern_Space <= EXEC(sed_cmd, Pattern_Space);\r\n \r\n    // 如果没有指定 -n 则输出处理后的Pattern_Space\r\n    if (sed option hasn't \"-n\")  {\r\n       print Pattern_Space\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAddress\r\n第一个是关于address，几乎上述所有的命令都是这样的（注：其中的!表示匹配成功后是否执行命令）\r\n[address[,address]][!]{cmd}\r\naddress可以是一个数字，也可以是一个模式，你可以通过逗号要分隔两个address 表示两个address的区间，参执行命令cmd，伪代码如下：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n11\r\n12\r\n13\r\n14\r\n\r\n\r\n\r\n\r\nbool bexec = false\r\nforeach line in file {\r\n    if ( match(address1) ){\r\n        bexec = true;\r\n    }\r\n \r\n    if ( bexec == true) {\r\n        EXEC(sed_cmd);\r\n    }\r\n \r\n    if ( match (address2) ) {\r\n        bexec = false;\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n关于address可以使用相对位置，如：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n\r\n\r\n\r\n\r\n# 其中的+3表示后面连续3行\r\n$ sed '/dog/,+3s/^/# /g' pets.txt\r\nThis is my cat\r\n  my cat's name is betty\r\n# This is my dog\r\n#   my dog's name is frank\r\n# This is my fish\r\n#   my fish's name is george\r\nThis is my goat\r\n  my goat's name is adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n命令打包\r\n第二个是cmd可以是多个，它们可以用分号分开，可以用大括号括起来作为嵌套命令。下面是几个例子：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n10\r\n11\r\n12\r\n13\r\n14\r\n15\r\n16\r\n17\r\n18\r\n19\r\n20\r\n21\r\n22\r\n23\r\n24\r\n25\r\n26\r\n27\r\n28\r\n29\r\n30\r\n31\r\n32\r\n33\r\n34\r\n35\r\n\r\n\r\n\r\n\r\n$ cat pets.txt\r\nThis is my cat\r\n  my cat's name is betty\r\nThis is my dog\r\n  my dog's name is frank\r\nThis is my fish\r\n  my fish's name is george\r\nThis is my goat\r\n  my goat's name is adam\r\n \r\n# 对3行到第6行，执行命令/This/d\r\n$ sed '3,6 {/This/d}' pets.txt\r\nThis is my cat\r\n  my cat's name is betty\r\n  my dog's name is frank\r\n  my fish's name is george\r\nThis is my goat\r\n  my goat's name is adam\r\n \r\n# 对3行到第6行，匹配/This/成功后，再匹配/fish/，成功后执行d命令\r\n$ sed '3,6 {/This/{/fish/d}}' pets.txt\r\nThis is my cat\r\n  my cat's name is betty\r\nThis is my dog\r\n  my dog's name is frank\r\n  my fish's name is george\r\nThis is my goat\r\n  my goat's name is adam\r\n \r\n# 从第一行到最后一行，如果匹配到This，则删除之；如果前面有空格，则去除空格\r\n$ sed '1,${/This/d;s/^ *//g}' pets.txt\r\nmy cat's name is betty\r\nmy dog's name is frank\r\nmy fish's name is george\r\nmy goat's name is adam\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nHold Space\r\n第三个我们再来看一下 Hold Space\r\n接下来，我们需要了解一下Hold Space的概念，我们先来看四个命令：\r\ng： 将hold space中的内容拷贝到pattern space中，原来pattern space里的内容清除G： 将hold space中的内容append到pattern space\\n后h： 将pattern space中的内容拷贝到hold space中，原来的hold space里的内容被清除H： 将pattern space中的内容append到hold space\\n后x： 交换pattern space和hold space的内容\r\n这些命令有什么用？我们来看两个示例吧，用到的示例文件是：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n\r\n\r\n\r\n\r\n$ cat t.txt\r\none\r\ntwo\r\nthree\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n第一个示例：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n7\r\n8\r\n9\r\n\r\n\r\n\r\n\r\n$ sed 'H;g' t.txt\r\none\r\n \r\none\r\ntwo\r\n \r\none\r\ntwo\r\nthree\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n是不是有点没看懂，我作个图你就看懂了。\r\n\r\n第二个示例，反序了一个文件的行：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n\r\n\r\n\r\n\r\n$ sed '1!G;h;$!d' t.txt\r\nthree\r\ntwo\r\none\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n其中的 ‘1!G;h;$!d’ 可拆解为三个命令\r\n\r\n1!G —— 只有第一行不执行G命令，将hold space中的内容append回到pattern space\r\nh —— 第一行都执行h命令，将pattern space中的内容拷贝到hold space中\r\n$!d —— 除了最后一行不执行d命令，其它行都执行d命令，删除当前行\r\n\r\n\r\n这个执行序列很难理解，做个图如下大家就明白了：\r\n\r\n就先说这么多吧，希望对大家有用。\r\n（全文完）", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>【转】sed 简明教程 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4501599.html\">【转】sed 简明教程</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p style=\"text-align: left;\">本文转自：http://coolshell.cn/articles/9104.html</p>\r\n<p style=\"text-align: left;\">awk于1977年出生，今年36岁本命年，sed比awk大2-3岁，awk就像林妹妹，sed就是宝玉哥哥了。所以 <a title=\"AWK 简明教程\" href=\"http://coolshell.cn/articles/9070.html\" target=\"_blank\">林妹妹跳了个Topless</a>，他的哥哥sed坐不住了，也一定要出来抖一抖。</p>\r\n<p style=\"text-align: left;\">sed全名叫stream editor，流编辑器，用程序的方式来编辑文本，相当的hacker啊。sed基本上就是玩正则模式匹配，所以，玩sed的人，正则表达式一般都比较强。</p>\r\n<p style=\"text-align: left;\">同样，本篇文章不会说sed的全部东西，你可以参看<a href=\"http://www.gnu.org/software/sed/manual/sed.html\" target=\"_blank\">sed的手册</a>，我这里主要还是想和大家竞争一下那些从手机指缝间或马桶里流走的时间，用这些时间来学习一些东西。当然，接下来的还是要靠大家自己双手。</p>\r\n<h4 style=\"text-align: left;\">用s命令替换</h4>\r\n<p style=\"text-align: left;\">我使用下面的这段文本做演示：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_279530\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\" style=\"text-align: left;\">\r\n<table style=\"margin-right: auto;\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\" style=\"text-align: right;\">1</div>\r\n<div class=\"line number2 index1 alt1\" style=\"text-align: right;\">2</div>\r\n<div class=\"line number3 index2 alt2\" style=\"text-align: right;\">3</div>\r\n<div class=\"line number4 index3 alt1\" style=\"text-align: right;\">4</div>\r\n<div class=\"line number5 index4 alt2\" style=\"text-align: right;\">5</div>\r\n<div class=\"line number6 index5 alt1\" style=\"text-align: right;\">6</div>\r\n<div class=\"line number7 index6 alt2\" style=\"text-align: right;\">7</div>\r\n<div class=\"line number8 index7 alt1\" style=\"text-align: right;\">8</div>\r\n<div class=\"line number9 index8 alt2\" style=\"text-align: right;\">9</div>\r\n</td>\r\n<td class=\"code\" style=\"text-align: right;\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\" style=\"text-align: left;\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">cat</code> <code class=\"bash plain\">pets.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">This is my dog</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my dog's name is frank</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">This is my fish</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my fish's name is george</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">This is my goat</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my goat's name is adam</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p style=\"text-align: left;\">把其中的my字符串替换成Hao Chen’s，下面的语句应该很好理解（s表示替换命令，/my/表示匹配my，/Hao Chen’s/表示把匹配替换成Hao Chen’s，/g 表示一行上的替换所有的匹配）：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_857316\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">\"s/my/Hao Chen's/g\"</code> <code class=\"bash plain\">pets.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">This is Hao Chen's </code><code class=\"bash functions\">cat</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">Hao Chen</code><code class=\"bash string\">'s cat'</code><code class=\"bash plain\">s name is betty</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">This is Hao Chen's dog</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">Hao Chen</code><code class=\"bash string\">'s dog'</code><code class=\"bash plain\">s name is frank</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">This is Hao Chen's fish</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">Hao Chen</code><code class=\"bash string\">'s fish'</code><code class=\"bash plain\">s name is george</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">This is Hao Chen's goat</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">Hao Chen</code><code class=\"bash string\">'s goat'</code><code class=\"bash plain\">s name is adam</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p style=\"text-align: left;\">注意：如果你要使用单引号，那么你没办法通过\\’这样来转义，就有双引号就可以了，在双引号内可以用\\”来转义。</p>\r\n<p style=\"text-align: left;\"> </p>\r\n<p style=\"text-align: left;\">再注意：上面的sed并没有对文件的内容改变，只是把处理过后的内容输出，如果你要写回文件，你可以使用重定向，如：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_467493\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">\"s/my/Hao Chen's/g\"</code> <code class=\"bash plain\">pets.txt &gt; hao_pets.txt</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p style=\"text-align: left;\">或使用 -i 参数直接修改文件内容：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_963743\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash plain\">-i </code><code class=\"bash string\">\"s/my/Hao Chen's/g\"</code> <code class=\"bash plain\">pets.txt</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p style=\"text-align: left;\">在每一行最前面加点东西：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_177950\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'s/^/#/g'</code> <code class=\"bash plain\">pets.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash comments\">#This is my cat</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash comments\">#  my cat's name is betty</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash comments\">#This is my dog</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash comments\">#  my dog's name is frank</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash comments\">#This is my fish</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash comments\">#  my fish's name is george</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash comments\">#This is my goat</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash comments\">#  my goat's name is adam</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p style=\"text-align: left;\">在每一行最后面加点东西：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_667552\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'s/$/ --- /g'</code> <code class=\"bash plain\">pets.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code> <code class=\"bash plain\">---</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty ---</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">This is my dog ---</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my dog's name is frank ---</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">This is my fish ---</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my fish's name is george ---</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">This is my goat ---</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my goat's name is adam ---</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p style=\"text-align: left;\">顺手介绍一下正则表达式的一些最基本的东西：</p>\r\n<ul style=\"text-align: left;\">\r\n<li>^ 表示一行的开头。如：/^#/ 以#开头的匹配。</li>\r\n<li>$ 表示一行的结尾。如：/}$/ 以}结尾的匹配。</li>\r\n<li>\\&lt; 表示词首。 如 \\&lt;abc 表示以 abc 为首的詞。</li>\r\n<li>\\&gt; 表示词尾。 如 abc\\&gt; 表示以 abc 結尾的詞。</li>\r\n<li>. 表示任何单个字符。</li>\r\n<li>* 表示某个字符出现了0次或多次。</li>\r\n<li>[ ] 字符集合。 如：[abc]表示匹配a或b或c，还有[a-zA-Z]表示匹配所有的26个字符。如果其中有^表示反，如[^a]表示非a的字符</li>\r\n</ul>\r\n<p style=\"text-align: left;\">正规则表达式是一些很牛的事，比如我们要去掉某html中的tags：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_822275\" class=\"syntaxhighlighter coolshell_syntaxhighlighter xml\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\"><caption>html.txt</caption>\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"xml plain\">&lt;</code><code class=\"xml keyword\">b</code><code class=\"xml plain\">&gt;This&lt;/</code><code class=\"xml keyword\">b</code><code class=\"xml plain\">&gt; is what &lt;</code><code class=\"xml keyword\">span</code> <code class=\"xml color1\">style</code><code class=\"xml plain\">=</code><code class=\"xml string\">\"text-decoration: underline;\"</code><code class=\"xml plain\">&gt;I&lt;/</code><code class=\"xml keyword\">span</code><code class=\"xml plain\">&gt; meant. Understand?</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p style=\"text-align: left;\">看看我们的sed命令</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_632873\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash comments\"># 如果你这样搞的话，就会有问题</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'s/&lt;.*&gt;//g'</code> <code class=\"bash plain\">html.txt</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash spaces\"> </code><code class=\"bash plain\">Understand?</code></div>\r\n<div class=\"line number4 index3 alt1\"> </div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash comments\"># 要解决上面的那个问题，就得像下面这样。</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash comments\"># 其中的'[^&gt;]' 指定了除了&gt;的字符重复0次或多次。</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'s/&lt;[^&gt;]*&gt;//g'</code> <code class=\"bash plain\">html.txt</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">This is what I meant. Understand?</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p style=\"text-align: left;\">我们再来看看指定需要替换的内容：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_660938\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1 highlighted\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">\"3s/my/your/g\"</code> <code class=\"bash plain\">pets.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number4 index3 alt1 highlighted\"><code class=\"bash plain\">This is your dog</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my dog's name is frank</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">This is my fish</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my fish's name is george</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">This is my goat</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my goat's name is adam</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p style=\"text-align: left;\">下面的命令只替换第3到第6行的文本。</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_822220\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1 highlighted\">4</div>\r\n<div class=\"line number5 index4 alt2 highlighted\">5</div>\r\n<div class=\"line number6 index5 alt1 highlighted\">6</div>\r\n<div class=\"line number7 index6 alt2 highlighted\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">\"3,6s/my/your/g\"</code> <code class=\"bash plain\">pets.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number4 index3 alt1 highlighted\"><code class=\"bash plain\">This is your dog</code></div>\r\n<div class=\"line number5 index4 alt2 highlighted\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">your dog's name is frank</code></div>\r\n<div class=\"line number6 index5 alt1 highlighted\"><code class=\"bash plain\">This is your fish</code></div>\r\n<div class=\"line number7 index6 alt2 highlighted\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">your fish's name is george</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">This is my goat</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my goat's name is adam</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p style=\"text-align: left;\"> </p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_530583\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">cat</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">, my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">This is my dog, my dog's name is frank</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">This is my fish, my fish's name is george</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">This is my goat, my goat's name is adam</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p style=\"text-align: left;\">只替换每一行的第一个s：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_558608\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'s/s/S/1'</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">ThiS is my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">, my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">ThiS is my dog, my dog's name is frank</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">ThiS is my fish, my fish's name is george</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">ThiS is my goat, my goat's name is adam</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p style=\"text-align: left;\">只替换每一行的第二个s：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_591280\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'s/s/S/2'</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">This iS my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">, my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">This iS my dog, my dog's name is frank</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">This iS my fish, my fish's name is george</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">This iS my goat, my goat's name is adam</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p style=\"text-align: left;\">只替换第一行的第3个以后的s：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_897395\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'s/s/S/3g'</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">, my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'S name iS betty</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">This is my dog, my dog'S name iS frank</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">This is my fiSh, my fiSh'S name iS george</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">This is my goat, my goat'S name iS adam</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<h4 style=\"text-align: left;\">多个匹配</h4>\r\n<p style=\"text-align: left;\">如果我们需要一次替换多个模式，可参看下面的示例：（第一个模式把第一行到第三行的my替换成your，第二个则把第3行以后的This替换成了That）</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_7794\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'1,3s/my/your/g; 3,$s/This/That/g'</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">This is your </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">, your </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">This is your dog, your dog's name is frank</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">That is your fish, your fish's name is george</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">That is my goat, my goat's name is adam</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p style=\"text-align: left;\">上面的命令等价于：（注：下面使用的是sed的-e命令行参数）</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_556032\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash functions\">sed</code> <code class=\"bash plain\">-e </code><code class=\"bash string\">'1,3s/my/your/g'</code> <code class=\"bash plain\">-e </code><code class=\"bash string\">'3,$s/This/That/g'</code> <code class=\"bash plain\">my.txt</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p style=\"text-align: left;\">我们可以使用&amp;来当做被匹配的变量，然后可以在基本左右加点东西。如下所示：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_227977\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'s/my/[&amp;]/g'</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">This is [my] </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">, [my] </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">This is [my] dog, [my] dog's name is frank</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">This is [my] fish, [my] fish's name is george</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">This is [my] goat, [my] goat's name is adam</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<h4 style=\"text-align: left;\">圆括号匹配</h4>\r\n<p style=\"text-align: left;\">使用圆括号匹配的示例：（圆括号括起来的正则表达式所匹配的字符串会可以当成变量来使用，sed中使用的是\\1,\\2…）</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_385528\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'s/This is my \\([^,]*\\),.*is \\(.*\\)/\\1:\\2/g'</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash functions\">cat</code><code class=\"bash plain\">:betty</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">dog:frank</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">fish:george</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">goat:adam</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p style=\"text-align: left;\">上面这个例子中的正则表达式有点复杂，解开如下（去掉转义字符）：</p>\r\n<p style=\"text-align: left;\">正则为：This is my ([^,]*),.*is (.*)<br>匹配为：This is my (cat),……….is (betty)</p>\r\n<p style=\"text-align: left;\">然后：\\1就是cat，\\2就是betty</p>\r\n<h4 style=\"text-align: left;\">sed的命令</h4>\r\n<p style=\"text-align: left;\">让我们回到最一开始的例子pets.txt，让我们来看几个命令：</p>\r\n<h5 style=\"text-align: left;\">N命令</h5>\r\n<p style=\"text-align: left;\">先来看N命令 —— 把下一行的内容纳入当成缓冲区做匹配。</p>\r\n<p style=\"text-align: left;\">下面的的示例会把原文本中的偶数行纳入奇数行匹配，而s只匹配并替换一次，所以，就成了下面的结果：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_867622\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'N;s/my/your/'</code> <code class=\"bash plain\">pets.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">This is your </code><code class=\"bash functions\">cat</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">This is your dog</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my dog's name is frank</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">This is your fish</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my fish's name is george</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">This is your goat</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my goat's name is adam</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<p style=\"text-align: left;\">也就是说，原来的文件成了：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_199921\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">\\n  my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">This is my dog\\n  my dog's name is frank</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">This is my fish\\n  my fish's name is george</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">This is my goat\\n  my goat's name is adam</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<p style=\"text-align: left;\">这样一来，下面的例子你就明白了，</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_808105\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'N;s/\\n/,/'</code> <code class=\"bash plain\">pets.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">,  my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">This is my dog,  my dog's name is frank</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">This is my fish,  my fish's name is george</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">This is my goat,  my goat's name is adam</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<h5 style=\"text-align: left;\">a命令和i命令</h5>\r\n<p style=\"text-align: left;\">a命令就是append， i命令就是insert，它们是用来添加行的。如：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_921489\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1 highlighted\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n<div class=\"line number10 index9 alt1\">10</div>\r\n<div class=\"line number11 index10 alt2\">11</div>\r\n<div class=\"line number12 index11 alt1 highlighted\">12</div>\r\n<div class=\"line number13 index12 alt2\">13</div>\r\n<div class=\"line number14 index13 alt1\">14</div>\r\n<div class=\"line number15 index14 alt2\">15</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash comments\"># 其中的1i表明，其要在第1行前插入一行（insert）</code></div>\r\n<div class=\"line number2 index1 alt1 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">\"1 i This is my monkey, my monkey's name is wukong\"</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">This is my monkey, my monkey's name is wukong</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">, my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">This is my dog, my dog's name is frank</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">This is my fish, my fish's name is george</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash plain\">This is my goat, my goat's name is adam</code></div>\r\n<div class=\"line number8 index7 alt1\"> </div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash comments\"># 其中的1a表明，其要在最后一行后追加一行（append）</code></div>\r\n<div class=\"line number10 index9 alt1\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">\"$ a This is my monkey, my monkey's name is wukong\"</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number11 index10 alt2\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">, my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number12 index11 alt1 highlighted\"><code class=\"bash plain\">This is my monkey, my monkey's name is wukong</code></div>\r\n<div class=\"line number13 index12 alt2\"><code class=\"bash plain\">This is my dog, my dog's name is frank</code></div>\r\n<div class=\"line number14 index13 alt1\"><code class=\"bash plain\">This is my fish, my fish's name is george</code></div>\r\n<div class=\"line number15 index14 alt2\"><code class=\"bash plain\">This is my goat, my goat's name is adam</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<p style=\"text-align: left;\">我们可以运用匹配来添加文本：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_475542\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1 highlighted\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash comments\"># 注意其中的/fish/a，这意思是匹配到/fish/后就追加一行</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">\"/fish/a This is my monkey, my monkey's name is wukong\"</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">, my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">This is my dog, my dog's name is frank</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">This is my fish, my fish's name is george</code></div>\r\n<div class=\"line number6 index5 alt1 highlighted\"><code class=\"bash plain\">This is my monkey, my monkey's name is wukong</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash plain\">This is my goat, my goat's name is adam</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<p style=\"text-align: left;\">下面这个例子是对每一行都挺插入：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_242625\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">\"/my/a ----\"</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">, my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">----</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">This is my dog, my dog's name is frank</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">----</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">This is my fish, my fish's name is george</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash plain\">----</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">This is my goat, my goat's name is adam</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash plain\">----</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<h5 style=\"text-align: left;\">c命令</h5>\r\n<p style=\"text-align: left;\">c 命令是替换匹配行</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_474704\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n<div class=\"line number10 index9 alt1\">10</div>\r\n<div class=\"line number11 index10 alt2\">11</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">\"2 c This is my monkey, my monkey's name is wukong\"</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">, my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">This is my monkey, my monkey's name is wukong</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">This is my fish, my fish's name is george</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">This is my goat, my goat's name is adam</code></div>\r\n<div class=\"line number6 index5 alt1\"> </div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">\"/fish/c This is my monkey, my monkey's name is wukong\"</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">, my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash plain\">This is my dog, my dog's name is frank</code></div>\r\n<div class=\"line number10 index9 alt1\"><code class=\"bash plain\">This is my monkey, my monkey's name is wukong</code></div>\r\n<div class=\"line number11 index10 alt2\"><code class=\"bash plain\">This is my goat, my goat's name is adam</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<h5 style=\"text-align: left;\">d命令</h5>\r\n<p style=\"text-align: left;\">删除匹配行</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_924482\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n<div class=\"line number10 index9 alt1\">10</div>\r\n<div class=\"line number11 index10 alt2\">11</div>\r\n<div class=\"line number12 index11 alt1\">12</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'/fish/d'</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">, my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">This is my dog, my dog's name is frank</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">This is my goat, my goat's name is adam</code></div>\r\n<div class=\"line number5 index4 alt2\"> </div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'2d'</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">, my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">This is my fish, my fish's name is george</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash plain\">This is my goat, my goat's name is adam</code></div>\r\n<div class=\"line number10 index9 alt1\"> </div>\r\n<div class=\"line number11 index10 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'2,$d'</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number12 index11 alt1\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">, my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<h5 style=\"text-align: left;\">p命令</h5>\r\n<p style=\"text-align: left;\">打印命令</p>\r\n<p style=\"text-align: left;\">你可以把这个命令当成grep式的命令</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_306556\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n<div class=\"line number10 index9 alt1\">10</div>\r\n<div class=\"line number11 index10 alt2\">11</div>\r\n<div class=\"line number12 index11 alt1\">12</div>\r\n<div class=\"line number13 index12 alt2\">13</div>\r\n<div class=\"line number14 index13 alt1\">14</div>\r\n<div class=\"line number15 index14 alt2\">15</div>\r\n<div class=\"line number16 index15 alt1\">16</div>\r\n<div class=\"line number17 index16 alt2\">17</div>\r\n<div class=\"line number18 index17 alt1\">18</div>\r\n<div class=\"line number19 index18 alt2\">19</div>\r\n<div class=\"line number20 index19 alt1\">20</div>\r\n<div class=\"line number21 index20 alt2\">21</div>\r\n<div class=\"line number22 index21 alt1\">22</div>\r\n<div class=\"line number23 index22 alt2\">23</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash comments\"># 匹配fish并输出，可以看到fish的那一行被打了两遍，</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash comments\"># 这是因为sed处理时会把处理的信息输出</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'/fish/p'</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">, my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">This is my dog, my dog's name is frank</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">This is my fish, my fish's name is george</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash plain\">This is my fish, my fish's name is george</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">This is my goat, my goat's name is adam</code></div>\r\n<div class=\"line number9 index8 alt2\"> </div>\r\n<div class=\"line number10 index9 alt1\"><code class=\"bash comments\"># 使用n参数就好了</code></div>\r\n<div class=\"line number11 index10 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash plain\">-n </code><code class=\"bash string\">'/fish/p'</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number12 index11 alt1\"><code class=\"bash plain\">This is my fish, my fish's name is george</code></div>\r\n<div class=\"line number13 index12 alt2\"> </div>\r\n<div class=\"line number14 index13 alt1\"><code class=\"bash comments\"># 从一个模式到另一个模式</code></div>\r\n<div class=\"line number15 index14 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash plain\">-n </code><code class=\"bash string\">'/dog/,/fish/p'</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number16 index15 alt1\"><code class=\"bash plain\">This is my dog, my dog's name is frank</code></div>\r\n<div class=\"line number17 index16 alt2\"><code class=\"bash plain\">This is my fish, my fish's name is george</code></div>\r\n<div class=\"line number18 index17 alt1\"> </div>\r\n<div class=\"line number19 index18 alt2\"><code class=\"bash comments\">#从第一行打印到匹配fish成功的那一行</code></div>\r\n<div class=\"line number20 index19 alt1\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash plain\">-n </code><code class=\"bash string\">'1,/fish/p'</code> <code class=\"bash plain\">my.txt</code></div>\r\n<div class=\"line number21 index20 alt2\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">, my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number22 index21 alt1\"><code class=\"bash plain\">This is my dog, my dog's name is frank</code></div>\r\n<div class=\"line number23 index22 alt2\"><code class=\"bash plain\">This is my fish, my fish's name is george</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<h4 style=\"text-align: left;\">几个知识点</h4>\r\n<p style=\"text-align: left;\">好了，下面我们要介绍四个sed的基本知识点：</p>\r\n<h5 style=\"text-align: left;\">Pattern Space</h5>\r\n<p style=\"text-align: left;\">第零个是关于-n参数的，大家也许没看懂，没关系，我们来看一下sed处理文本的伪代码，并了解一下Pattern Space的概念：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_334118\" class=\"syntaxhighlighter coolshell_syntaxhighlighter cpp\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n<div class=\"line number10 index9 alt1\">10</div>\r\n<div class=\"line number11 index10 alt2\">11</div>\r\n<div class=\"line number12 index11 alt1\">12</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"cpp plain\">foreach line in file {</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"cpp spaces\">    </code><code class=\"cpp comments\">//放入把行Pattern_Space</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"cpp spaces\">    </code><code class=\"cpp plain\">Pattern_Space &lt;= line;</code></div>\r\n<div class=\"line number4 index3 alt1\"> </div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"cpp spaces\">    </code><code class=\"cpp comments\">// 对每个pattern space执行sed命令</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"cpp spaces\">    </code><code class=\"cpp plain\">Pattern_Space &lt;= EXEC(sed_cmd, Pattern_Space);</code></div>\r\n<div class=\"line number7 index6 alt2\"> </div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"cpp spaces\">    </code><code class=\"cpp comments\">// 如果没有指定 -n 则输出处理后的Pattern_Space</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"cpp spaces\">    </code><code class=\"cpp keyword bold\">if</code> <code class=\"cpp plain\">(sed option hasn't </code><code class=\"cpp string\">\"-n\"</code><code class=\"cpp plain\">)  {</code></div>\r\n<div class=\"line number10 index9 alt1\"><code class=\"cpp spaces\">       </code><code class=\"cpp plain\">print Pattern_Space</code></div>\r\n<div class=\"line number11 index10 alt2\"><code class=\"cpp spaces\">    </code><code class=\"cpp plain\">}</code></div>\r\n<div class=\"line number12 index11 alt1\"><code class=\"cpp plain\">}</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<h5 style=\"text-align: left;\">Address</h5>\r\n<p style=\"text-align: left;\">第一个是关于address，几乎上述所有的命令都是这样的（注：其中的!表示匹配成功后是否执行命令）</p>\r\n<p style=\"text-align: left;\">[address[,address]][!]{cmd}</p>\r\n<p style=\"text-align: left;\">address可以是一个数字，也可以是一个模式，你可以通过逗号要分隔两个address 表示两个address的区间，参执行命令cmd，伪代码如下：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_23555\" class=\"syntaxhighlighter coolshell_syntaxhighlighter cpp\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n<div class=\"line number10 index9 alt1\">10</div>\r\n<div class=\"line number11 index10 alt2\">11</div>\r\n<div class=\"line number12 index11 alt1\">12</div>\r\n<div class=\"line number13 index12 alt2\">13</div>\r\n<div class=\"line number14 index13 alt1\">14</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"cpp color1 bold\">bool</code> <code class=\"cpp plain\">bexec = </code><code class=\"cpp keyword bold\">false</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"cpp plain\">foreach line in file {</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"cpp spaces\">    </code><code class=\"cpp keyword bold\">if</code> <code class=\"cpp plain\">( match(address1) ){</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"cpp spaces\">        </code><code class=\"cpp plain\">bexec = </code><code class=\"cpp keyword bold\">true</code><code class=\"cpp plain\">;</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"cpp spaces\">    </code><code class=\"cpp plain\">}</code></div>\r\n<div class=\"line number6 index5 alt1\"> </div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"cpp spaces\">    </code><code class=\"cpp keyword bold\">if</code> <code class=\"cpp plain\">( bexec == </code><code class=\"cpp keyword bold\">true</code><code class=\"cpp plain\">) {</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"cpp spaces\">        </code><code class=\"cpp plain\">EXEC(sed_cmd);</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"cpp spaces\">    </code><code class=\"cpp plain\">}</code></div>\r\n<div class=\"line number10 index9 alt1\"> </div>\r\n<div class=\"line number11 index10 alt2\"><code class=\"cpp spaces\">    </code><code class=\"cpp keyword bold\">if</code> <code class=\"cpp plain\">( match (address2) ) {</code></div>\r\n<div class=\"line number12 index11 alt1\"><code class=\"cpp spaces\">        </code><code class=\"cpp plain\">bexec = </code><code class=\"cpp keyword bold\">false</code><code class=\"cpp plain\">;</code></div>\r\n<div class=\"line number13 index12 alt2\"><code class=\"cpp spaces\">    </code><code class=\"cpp plain\">}</code></div>\r\n<div class=\"line number14 index13 alt1\"><code class=\"cpp plain\">}</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<p style=\"text-align: left;\">关于address可以使用相对位置，如：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_595869\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n<div class=\"line number10 index9 alt1\">10</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash comments\"># 其中的+3表示后面连续3行</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'/dog/,+3s/^/# /g'</code> <code class=\"bash plain\">pets.txt</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash comments\"># This is my dog</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash comments\">#   my dog's name is frank</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash comments\"># This is my fish</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash comments\">#   my fish's name is george</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash plain\">This is my goat</code></div>\r\n<div class=\"line number10 index9 alt1\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my goat's name is adam</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<h5 style=\"text-align: left;\">命令打包</h5>\r\n<p style=\"text-align: left;\">第二个是cmd可以是多个，它们可以用分号分开，可以用大括号括起来作为嵌套命令。下面是几个例子：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_284976\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n<div class=\"line number10 index9 alt1\">10</div>\r\n<div class=\"line number11 index10 alt2\">11</div>\r\n<div class=\"line number12 index11 alt1 highlighted\">12</div>\r\n<div class=\"line number13 index12 alt2\">13</div>\r\n<div class=\"line number14 index13 alt1\">14</div>\r\n<div class=\"line number15 index14 alt2\">15</div>\r\n<div class=\"line number16 index15 alt1\">16</div>\r\n<div class=\"line number17 index16 alt2\">17</div>\r\n<div class=\"line number18 index17 alt1\">18</div>\r\n<div class=\"line number19 index18 alt2\">19</div>\r\n<div class=\"line number20 index19 alt1\">20</div>\r\n<div class=\"line number21 index20 alt2 highlighted\">21</div>\r\n<div class=\"line number22 index21 alt1\">22</div>\r\n<div class=\"line number23 index22 alt2\">23</div>\r\n<div class=\"line number24 index23 alt1\">24</div>\r\n<div class=\"line number25 index24 alt2\">25</div>\r\n<div class=\"line number26 index25 alt1\">26</div>\r\n<div class=\"line number27 index26 alt2\">27</div>\r\n<div class=\"line number28 index27 alt1\">28</div>\r\n<div class=\"line number29 index28 alt2\">29</div>\r\n<div class=\"line number30 index29 alt1\">30</div>\r\n<div class=\"line number31 index30 alt2 highlighted\">31</div>\r\n<div class=\"line number32 index31 alt1\">32</div>\r\n<div class=\"line number33 index32 alt2\">33</div>\r\n<div class=\"line number34 index33 alt1\">34</div>\r\n<div class=\"line number35 index34 alt2\">35</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">cat</code> <code class=\"bash plain\">pets.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">This is my dog</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my dog's name is frank</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">This is my fish</code></div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my fish's name is george</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">This is my goat</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my goat's name is adam</code></div>\r\n<div class=\"line number10 index9 alt1\"> </div>\r\n<div class=\"line number11 index10 alt2\"><code class=\"bash comments\"># 对3行到第6行，执行命令/This/d</code></div>\r\n<div class=\"line number12 index11 alt1 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'3,6 {/This/d}'</code> <code class=\"bash plain\">pets.txt</code></div>\r\n<div class=\"line number13 index12 alt2\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code></div>\r\n<div class=\"line number14 index13 alt1\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number15 index14 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my dog's name is frank</code></div>\r\n<div class=\"line number16 index15 alt1\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my fish's name is george</code></div>\r\n<div class=\"line number17 index16 alt2\"><code class=\"bash plain\">This is my goat</code></div>\r\n<div class=\"line number18 index17 alt1\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my goat's name is adam</code></div>\r\n<div class=\"line number19 index18 alt2\"> </div>\r\n<div class=\"line number20 index19 alt1\"><code class=\"bash comments\"># 对3行到第6行，匹配/This/成功后，再匹配/fish/，成功后执行d命令</code></div>\r\n<div class=\"line number21 index20 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'3,6 {/This/{/fish/d}}'</code> <code class=\"bash plain\">pets.txt</code></div>\r\n<div class=\"line number22 index21 alt1\"><code class=\"bash plain\">This is my </code><code class=\"bash functions\">cat</code></div>\r\n<div class=\"line number23 index22 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number24 index23 alt1\"><code class=\"bash plain\">This is my dog</code></div>\r\n<div class=\"line number25 index24 alt2\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my dog's name is frank</code></div>\r\n<div class=\"line number26 index25 alt1\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my fish's name is george</code></div>\r\n<div class=\"line number27 index26 alt2\"><code class=\"bash plain\">This is my goat</code></div>\r\n<div class=\"line number28 index27 alt1\"><code class=\"bash spaces\">  </code><code class=\"bash plain\">my goat's name is adam</code></div>\r\n<div class=\"line number29 index28 alt2\"> </div>\r\n<div class=\"line number30 index29 alt1\"><code class=\"bash comments\"># 从第一行到最后一行，如果匹配到This，则删除之；如果前面有空格，则去除空格</code></div>\r\n<div class=\"line number31 index30 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'1,${/This/d;s/^ *//g}'</code> <code class=\"bash plain\">pets.txt</code></div>\r\n<div class=\"line number32 index31 alt1\"><code class=\"bash plain\">my </code><code class=\"bash functions\">cat</code><code class=\"bash plain\">'s name is betty</code></div>\r\n<div class=\"line number33 index32 alt2\"><code class=\"bash plain\">my dog's name is frank</code></div>\r\n<div class=\"line number34 index33 alt1\"><code class=\"bash plain\">my fish's name is george</code></div>\r\n<div class=\"line number35 index34 alt2\"><code class=\"bash plain\">my goat's name is adam</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<h5 style=\"text-align: left;\">Hold Space</h5>\r\n<p style=\"text-align: left;\">第三个我们再来看一下 Hold Space</p>\r\n<p style=\"text-align: left;\">接下来，我们需要了解一下Hold Space的概念，我们先来看四个命令：</p>\r\n<p style=\"text-align: left;\">g： 将hold space中的内容拷贝到pattern space中，原来pattern space里的内容清除<br>G： 将hold space中的内容append到pattern space\\n后<br>h： 将pattern space中的内容拷贝到hold space中，原来的hold space里的内容被清除<br>H： 将pattern space中的内容append到hold space\\n后<br>x： 交换pattern space和hold space的内容</p>\r\n<p style=\"text-align: left;\">这些命令有什么用？我们来看两个示例吧，用到的示例文件是：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_229727\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">cat</code> <code class=\"bash plain\">t.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">one</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">two</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">three</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<p style=\"text-align: left;\">第一个示例：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_949286\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n<div class=\"line number7 index6 alt2\">7</div>\r\n<div class=\"line number8 index7 alt1\">8</div>\r\n<div class=\"line number9 index8 alt2\">9</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'H;g'</code> <code class=\"bash plain\">t.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">one</code></div>\r\n<div class=\"line number3 index2 alt2\"> </div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">one</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">two</code></div>\r\n<div class=\"line number6 index5 alt1\"> </div>\r\n<div class=\"line number7 index6 alt2\"><code class=\"bash plain\">one</code></div>\r\n<div class=\"line number8 index7 alt1\"><code class=\"bash plain\">two</code></div>\r\n<div class=\"line number9 index8 alt2\"><code class=\"bash plain\">three</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<p style=\"text-align: left;\">是不是有点没看懂，我作个图你就看懂了。</p>\r\n<p style=\"text-align: left;\"><img class=\"aligncenter size-full wp-image-9118\" src=\"http://coolshell.cn//wp-content/uploads/2013/02/sed_demo_00.jpg\" alt=\"\" width=\"592\" height=\"404\"></p>\r\n<p style=\"text-align: left;\">第二个示例，反序了一个文件的行：</p>\r\n<div style=\"text-align: left;\">\r\n<div id=\"highlighter_577719\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2 highlighted\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2 highlighted\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">sed</code> <code class=\"bash string\">'1!G;h;$!d'</code> <code class=\"bash plain\">t.txt</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">three</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">two</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">one</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<p style=\"text-align: left;\">其中的 ‘1!G;h;$!d’ 可拆解为三个命令</p>\r\n<ul style=\"text-align: left;\">\r\n<li>1!G —— 只有第一行不执行G命令，将hold space中的内容append回到pattern space</li>\r\n<li>h —— 第一行都执行h命令，将pattern space中的内容拷贝到hold space中</li>\r\n<li>$!d —— 除了最后一行不执行d命令，其它行都执行d命令，删除当前行</li>\r\n\r\n</ul>\r\n<p style=\"text-align: left;\">这个执行序列很难理解，做个图如下大家就明白了：</p>\r\n<p style=\"text-align: left;\"><img class=\"aligncenter size-full wp-image-9110\" src=\"http://coolshell.cn//wp-content/uploads/2013/02/sed_demo.jpg\" alt=\"\" width=\"623\" height=\"316\"></p>\r\n<p style=\"text-align: left;\">就先说这么多吧，希望对大家有用。</p>\r\n<p style=\"text-align: left;\">（全文完）</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-13 20:29</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4501599\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4501599);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4501599,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/13 20:29:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4501599.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=21", "desc": "摘要: 本文转自：http://coolshell.cn/articles/9104.htmlawk于1977年出生，今年36岁本命年，sed比awk大2-3岁，awk就像林妹妹，sed就是宝玉哥哥了。所以林妹妹跳了个Topless，他的哥哥sed坐不住了，也一定要出来抖一抖。sed全名叫stream ed..."}
{"title": "【转】你可能不知道的Shell", "content": "本文转自http://coolshell.cn/articles/8619.html，只摘取了其中的一部分。\r\n再分享一些可能你不知道的shell用法和脚本，简单&强大！\r\n在阅读以下部分前，强烈建议读者打开一个shell实验，这些都不是shell教科书里的大路货哦：）\r\n\r\n!$!$是一个特殊的环境变量，它代表了上一个命令的最后一个字符串。如：你可能会这样：$mkdir mydir$mv mydir yourdir$cd yourdir可以改成：$mkdir mydir$mv !$ yourdir$cd !$\r\n\r\n\r\n\r\n\r\n\r\nsudo !!以root的身份执行上一条命令 。场景举例：比如Ubuntu里用apt-get安装软件包的时候是需要root身份的，我们经常会忘记在apt-get前加sudo。每次不得不加上sudo再重新键入这行命令，这时可以很方便的用sudo !!完事。（陈皓注：在shell下，有时候你会输入很长的命令，你可以使用!xxx来重复最近的一次命令，比如，你以前输入过，vi /where/the/file/is, 下次你可以使用 !vi 重得上次最近一次的vi命令。）\r\n\r\n\r\n\r\n\r\n\r\ncd –回到上一次的目录 。场景举例：当前目录为/home/a，用cd ../b切换到/home/b。这时可以通过反复执行cd –命令在/home/a和/home/b之间来回方便的切换。（陈皓注：cd ~ 是回到自己的Home目录，cd ~user，是进入某个用户的Home目录）\r\n\r\n\r\n\r\n\r\n\r\n‘ALT+.’ or ‘<ESC> .’热建alt+. 或 esc+. 可以把上次命令行的参数给重复出来。\r\n\r\n\r\n\r\n\r\n\r\n^old^new替换前一条命令里的部分字符串。场景：echo \"wanderful\"，其实是想输出echo \"wonderful\"。只需要^a^o就行了，对很长的命令的错误拼写有很大的帮助。（陈皓注：也可以使用 !!:gs/old/new）\r\n\r\n\r\n\r\n\r\n\r\ndu -s * | sort -n | tail列出当前目录里最大的10个文件。\r\n\r\n\r\n\r\n\r\n\r\n:w !sudo tee %在vi中保存一个只有root可以写的文件\r\n\r\n\r\n\r\n\r\n\r\ndate -d@1234567890时间截转时间\r\n\r\n\r\n\r\n\r\n\r\n\r\n> file.txt创建一个空文件，比touch短。\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nmtr coolshell.cnmtr命令比traceroute要好。\r\n\r\n\r\n\r\n\r\n\r\n在命令行前加空格，该命令不会进入history里。\r\n\r\n\r\n\r\n\r\n\r\necho “ls -l” | at midnight在某个时间运行某个命令。\r\n\r\n\r\n\r\n\r\n\r\ncurl -u user:pass -d status=”Tweeting from the shell” http://twitter.com/statuses/update.xml命令行的方式更新twitter。\r\n\r\n\r\n\r\n\r\n\r\ncurl -u username –silent “https://mail.google.com/mail/feed/atom” | perl -ne ‘print “\\t” if /<name>/; print “$2\\n” if /<(title|name)>(.*)<\\/\\1>/;’检查你的gmail未读邮件\r\n\r\n\r\n\r\n\r\n\r\nps aux | sort -nk +4 | tail列出头十个最耗内存的进程\r\n\r\n\r\n\r\n\r\n\r\nman ascii显示ascii码表。场景：忘记ascii码表的时候还需要google么?尤其在天朝网络如此“顺畅”的情况下，就更麻烦在GWF多应用一次规则了，直接用本地的man ascii吧。\r\n\r\n\r\n\r\n\r\n\r\nctrl-x e快速启动你的默认编辑器（由变量$EDITOR设置）。\r\n\r\n\r\n\r\n\r\n\r\nnetstat –tlnp列出本机进程监听的端口号。（陈皓注：netstat -anop 可以显示侦听在这个端口号的进程）\r\n\r\n\r\n\r\n\r\n\r\ntail -f /path/to/file.log | sed '/^Finished: SUCCESS$/ q'当file.log里出现Finished: SUCCESS时候就退出tail，这个命令用于实时监控并过滤log是否出现了某条记录。\r\n\r\n\r\n\r\n\r\n\r\nssh user@server bash < /path/to/local/script.sh在远程机器上运行一段脚本。这条命令最大的好处就是不用把脚本拷到远程机器上。\r\n\r\n\r\n\r\n\r\n\r\nssh user@host cat /path/to/remotefile | diff /path/to/localfile -比较一个远程文件和一个本地文件\r\n\r\n\r\n\r\n\r\n\r\n\r\nnet rpc shutdown -I ipAddressOfWindowsPC -U username%password远程关闭一台Windows的机器\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nscreen -d -m -S some_name ping my_router后台运行一段不终止的程序，并可以随时查看它的状态。-d -m参数启动“分离”模式，-S指定了一个session的标识。可以通过-R命令来重新“挂载”一个标识的session。更多细节请参考screen用法 man screen。\r\n\r\n\r\n\r\n\r\n\r\nwget --random-wait -r -p -e robots=off -U mozilla http://www.example.com下载整个www.example.com网站。（注：别太过分，大部分网站都有防爬功能了：））\r\n\r\n\r\n\r\n\r\n\r\ncurl ifconfig.me当你的机器在内网的时候，可以通过这个命令查看外网的IP。\r\n\r\n\r\n\r\n\r\n\r\nconvert input.png -gravity NorthWest -background transparent -extent 720×200  output.png改一下图片的大小尺寸\r\n\r\n\r\n\r\n\r\n\r\nlsof –i实时查看本机网络服务的活动状态。\r\n\r\n\r\n\r\n\r\n\r\nvim scp://username@host//path/to/somefilevim一个远程文件\r\n\r\n\r\n\r\n\r\n\r\npython -m SimpleHTTPServer一句话实现一个HTTP服务，把当前目录设为HTTP服务目录，可以通过http://localhost:8000访问 这也许是这个星球上最简单的HTTP服务器的实现了。\r\n\r\n\r\n\r\n\r\n\r\nhistory | awk '{CMD[$2]++;count++;} END { for (a in CMD )print CMD[a] \" \" CMD[a]/count*100 \"% \" a }' | grep -v \"./\" | column -c3 -s \" \" -t | sort -nr | nl | head -n10(陈皓注：有点复杂了，history|awk ‘{print $2}’|awk ‘BEGIN {FS=”|”} {print $1}’|sort|uniq -c|sort -rn|head -10)这行脚本能输出你最常用的十条命令，由此甚至可以洞察你是一个什么类型的程序员。\r\n\r\n\r\n\r\n\r\n\r\n\r\ntr -c “[:digit:]” ” ” < /dev/urandom | dd cbs=$COLUMNS conv=unblock | GREP_COLOR=”1;32″ grep –color “[^ ]”想看看Marix的屏幕效果吗？（不是很像，但也很Cool!）\r\n\r\n\r\n\r\n\r\n\r\n\r\n", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>【转】你可能不知道的Shell - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4499904.html\">【转】你可能不知道的Shell</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>本文转自http://coolshell.cn/articles/8619.html，只摘取了其中的一部分。</p>\r\n<p>再分享一些可能你不知道的shell用法和脚本，简单&amp;强大！</p>\r\n<p><em>在阅读以下部分前，强烈建议读者打开一个shell实验，这些都不是shell教科书里的大路货哦：）</em></p>\r\n<ul>\r\n<li><code><span style=\"color: #ff0000;\"><strong>!$</strong></span><br><code><span style=\"color: #ff0000;\">!$是一个特殊的环境变量，它代表了上一个命令的最后一个字符串。</span>如：你可能会这样：<br>$mkdir mydir<br>$mv mydir yourdir</code><br>$cd yourdir<br>可以改成：<br>$mkdir mydir<br>$mv !$ yourdir<br>$cd !$</code></li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong><code>sudo !!</code></strong><br>以root的身份执行上一条命令 。<br>场景举例：比如Ubuntu里用<code>apt-get</code>安装软件包的时候是需要root身份的，我们经常会忘记在<code>apt-get</code>前加<code>sudo</code>。每次不得不加上<code>sudo</code>再重新键入这行命令，这时可以很方便的用<code>sudo !!</code>完事。<br>（陈皓注：在shell下，有时候你会输入很长的命令，你可以使用!xxx来重复最近的一次命令，比如，你以前输入过，vi /where/the/file/is, 下次你可以使用 !vi 重得上次最近一次的vi命令。）</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><span style=\"color: #ff0000;\"><strong><code>cd –</code></strong></span><br>回到上一次的目录 。<br>场景举例：当前目录为<code>/home/a</code>，用<code>cd ../b</code>切换到<code>/home/b</code>。这时可以通过反复执行<code>cd –</code>命令在<code>/home/a</code>和<code>/home/b</code>之间来回方便的切换。<br>（陈皓注：cd ~ 是回到自己的Home目录，cd ~user，是进入某个用户的Home目录）</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong>‘ALT+.’ or ‘&lt;ESC&gt; .’</strong><br>热建alt+. 或 esc+. 可以把上次命令行的参数给重复出来。</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong><code>^old^new</code></strong><br>替换前一条命令里的部分字符串。<br>场景：<code>echo \"wanderful\"</code>，其实是想输出<code>echo \"wonderful\"</code>。只需要<code>^a^o</code>就行了，对很长的命令的错误拼写有很大的帮助。（陈皓注：也可以使用 <strong>!!:gs/old/new</strong>）</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong>du -s * | sort -n | tail</strong><br>列出当前目录里最大的10个文件。</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong>:w !sudo tee %</strong><br>在vi中保存一个只有root可以写的文件</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong>date -d@1234567890</strong><br>时间截转时间</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li>\r\n<div title=\"Click to select this command\"><strong>&gt; file.txt</strong><br>创建一个空文件，比touch短。</div>\r\n\r\n\r\n\r\n</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong>mtr coolshell.cn</strong><br>mtr命令比traceroute要好。</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li>在命令行前加空格，该命令不会进入history里。</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong>echo “ls -l” | at midnight</strong><br>在某个时间运行某个命令。</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong>curl -u user:pass -d status=”Tweeting from the shell” http://twitter.com/statuses/update.xml</strong><br>命令行的方式更新twitter。</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong>curl -u username –silent “https://mail.google.com/mail/feed/atom” | perl -ne ‘print “\\t” if /&lt;name&gt;/; print “$2\\n” if /&lt;(title|name)&gt;(.*)&lt;\\/\\1&gt;/;’</strong><br>检查你的gmail未读邮件</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><span style=\"color: #ff0000;\"><strong>ps aux | sort -nk +4 | tail</strong></span><br>列出头十个最耗内存的进程</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong><code>man ascii</code></strong><br>显示ascii码表。<br>场景：忘记ascii码表的时候还需要google么?尤其在天朝网络如此“顺畅”的情况下，就更麻烦在GWF多应用一次规则了，直接用本地的<code>man ascii</code>吧。</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong><code>ctrl-x e</code></strong><br>快速启动你的默认编辑器（由变量$EDITOR设置）。</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong><code>netstat –tlnp</code></strong><br>列出本机进程监听的端口号。（陈皓注：netstat -anop 可以显示侦听在这个端口号的进程）</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><span style=\"color: #ff0000;\"><strong><code>tail -f /path/to/file.log | sed '/^Finished: SUCCESS$/ q'</code></strong></span><br>当file.log里出现Finished: SUCCESS时候就退出tail，这个命令用于实时监控并过滤log是否出现了某条记录。</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><span style=\"color: #ff0000;\"><strong><code>ssh user@server bash &lt; /path/to/local/script.sh</code></strong></span><br>在远程机器上运行一段脚本。这条命令最大的好处就是不用把脚本拷到远程机器上。</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><span style=\"color: #ff0000;\"><strong>ssh user@host cat /path/to/remotefile | diff /path/to/localfile -</strong></span><br>比较一个远程文件和一个本地文件</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li>\r\n<div title=\"Click to select this command\"><strong>net rpc shutdown -I ipAddressOfWindowsPC -U username%password</strong><br>远程关闭一台Windows的机器</div>\r\n\r\n\r\n\r\n</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong><code>screen -d -m -S some_name ping my_router</code></strong><br>后台运行一段不终止的程序，并可以随时查看它的状态。<code>-d -m</code>参数启动“分离”模式，<code>-S</code>指定了一个session的标识。可以通过<code>-R</code>命令来重新“挂载”一个标识的session。更多细节请参考screen用法 <code>man screen</code>。</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong><code>wget --random-wait -r -p -e robots=off -U mozilla http://www.example.com</code></strong><br>下载整个www.example.com网站。（注：别太过分，大部分网站都有防爬功能了：））</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong><code>curl ifconfig.me</code></strong><br>当你的机器在内网的时候，可以通过这个命令查看外网的IP。</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong>convert input.png -gravity NorthWest -background transparent -extent 720×200  output.png</strong><br>改一下图片的大小尺寸</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong><code>lsof –i</code></strong><br>实时查看本机网络服务的活动状态。</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong>vim scp://username@host//path/to/somefile</strong><br>vim一个远程文件</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong><code>python -m SimpleHTTPServer</code></strong><br>一句话实现一个HTTP服务，把当前目录设为HTTP服务目录，可以通过<code>http://localhost:8000</code>访问 这也许是这个星球上最简单的HTTP服务器的实现了。</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li><strong><code>history | awk '{CMD[$2]++;count++;} END { for (a in CMD )print CMD[a] \" \" CMD[a]/count*100 \"% \" a }' | grep -v \"./\" | column -c3 -s \" \" -t | sort -nr | nl | head -n10</code></strong><br>(陈皓注：有点复杂了，history|awk ‘{print $2}’|awk ‘BEGIN {FS=”|”} {print $1}’|sort|uniq -c|sort -rn|head -10)<br>这行脚本能输出你最常用的十条命令，由此甚至可以洞察你是一个什么类型的程序员。</li>\r\n\r\n\r\n\r\n</ul>\r\n<ul>\r\n<li>\r\n<div title=\"Click to select this command\"><strong>tr -c “[:digit:]” ” ” &lt; /dev/urandom | dd cbs=$COLUMNS conv=unblock | GREP_COLOR=”1;32″ grep –color “[^ ]”</strong><br>想看看Marix的屏幕效果吗？（不是很像，但也很Cool!）</div>\r\n\r\n\r\n\r\n</li>\r\n\r\n\r\n</ul></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-13 11:20</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4499904\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4499904);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4499904,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/13 11:20:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4499904.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=21", "desc": "摘要: 本文转自http://coolshell.cn/articles/8619.html，只摘取了其中的一部分。再分享一些可能你不知道的shell用法和脚本，简单&强大！在阅读以下部分前，强烈建议读者打开一个shell实验，这些都不是shell教科书里的大路货哦：）!$!$是一个特殊的环境变量，它代表了..."}
{"title": "写在前面--点燃酱爆心中的那团火", "content": "　　感谢在浩瀚互联网世界里，游历至此的您！有缘千里来相会，文字的相会，博客的会见。缘分？猿粪？曾几何时一直想经营一个自己的博客。记录自己的心绪，分享自己的技术，反思自己的行为，局促自己的成长。这个想法在脑海里不知道辗转和浮现了多少遍，然后又被自己的懒惰一次次无情地抛下。如此的反复而始终没有进展，积攒的几两代码仍然静静地躺在磁盘的角落里发霉。似乎这一切也都在无止境地循环下去，没有尽头。一次次的放下，一次次的借口，一次次的推托；从有想法到现在四五年的时间也还仍然的是个想法，除了空想什么也没做。这也再次印证了“这个世界上有想法的人多了去了，但是真正行动和做的仍然是少数”。\r\n　　打从有经营自己博客的想法起，四五年时间内仍然是个想法；一月份开通了博客园的博客，本打算写一些东西。懒惰之人懒惰的习性，又再次放下，几个月时间过去了仍然没有一篇博文，没写任何一个字。然而今天和朋友再次聊起这个事情，再次点燃了酱爆心中的那团火。与其不断滴空想，不如蹒跚学步地前行。在路上总比空想来的有意义。那个死循环终究有个break了，掌声在哪里？！^_^。。。\r\n\r\n　　为什么会有经营自己博客的想法呢？首先是整理和记录技术的片段和解决方案，这些技术上的代码片段和解决方案，也许是原创的，也许是转载的这也都无妨，这是一个代码展现和记录的地方。其次也是为了分享自己碰到问题的解决方案，回想自己能够进入互联网和程序猿这一行，由衷地感谢各位前辈和技术大牛的分享精神。没有这种分享的精神也就没有今天自己技术的积累。同时也为碰到类似问题，检索到此的同行们一个技术的参考。最后也是记录自己成长和心绪的一个场所。古人云：“日三省吾身”，做不到三省吾身也记录下自己的心路历程吧。\r\n　　我一个科班非科班出身的屌丝程序猿，毕业于一个二流本科的万金油专业《信息管理与信息系统》。屌丝专业？万金油专业？NO，这可是我大百度Robin的专业哦，哥哥！GG一下你就知道，NO！万能的长城；百度一下你就知道了。接下来的一段时间里会将静静躺在磁盘文件里的东西拿出来晒晒太阳。别一板砖一臭鞋地扔过来哦，疼！！！码农改码字了，一个写得了代码，修得了航母，设计得了导弹，拿了110米跨栏冠军的好厨司出现了。这都是什么鬼呀，板砖一摞摞，疼？？？！！！说明还有知觉，点燃酱爆心中的那团火。duang。。。", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>写在前面--点燃酱爆心中的那团火 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4486260.html\">写在前面--点燃酱爆心中的那团火</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>　　感谢在浩瀚互联网世界里，游历至此的您！有缘千里来相会，文字的相会，博客的会见。缘分？猿粪？曾几何时一直想经营一个自己的博客。记录自己的心绪，分享自己的技术，反思自己的行为，局促自己的成长。这个想法在脑海里不知道辗转和浮现了多少遍，然后又被自己的懒惰一次次无情地抛下。如此的反复而始终没有进展，积攒的几两代码仍然静静地躺在磁盘的角落里发霉。似乎这一切也都在无止境地循环下去，没有尽头。一次次的放下，一次次的借口，一次次的推托；从有想法到现在四五年的时间也还仍然的是个想法，除了空想什么也没做。这也再次印证了“这个世界上有想法的人多了去了，但是真正行动和做的仍然是少数”。</p>\r\n<p>　　打从有经营自己博客的想法起，四五年时间内仍然是个想法；一月份开通了博客园的博客，本打算写一些东西。懒惰之人懒惰的习性，又再次放下，几个月时间过去了仍然没有一篇博文，没写任何一个字。然而今天和朋友再次聊起这个事情，再次点燃了酱爆心中的那团火。与其不断滴空想，不如蹒跚学步地前行。在路上总比空想来的有意义。那个死循环终究有个break了，掌声在哪里？！^_^。。。</p>\r\n<p style=\"text-align: center;\"><img src=\"http://images.cnitblog.com/blog2015/709606/201505/072207499079562.jpg\" alt=\"\"></p>\r\n<p>　　为什么会有经营自己博客的想法呢？首先是整理和记录技术的片段和解决方案，这些技术上的代码片段和解决方案，也许是原创的，也许是转载的这也都无妨，这是一个代码展现和记录的地方。其次也是为了分享自己碰到问题的解决方案，回想自己能够进入互联网和程序猿这一行，由衷地感谢各位前辈和技术大牛的分享精神。没有这种分享的精神也就没有今天自己技术的积累。同时也为碰到类似问题，检索到此的同行们一个技术的参考。最后也是记录自己成长和心绪的一个场所。古人云：“日三省吾身”，做不到三省吾身也记录下自己的心路历程吧。</p>\r\n<p>　　我一个科班非科班出身的屌丝程序猿，毕业于一个二流本科的万金油专业《信息管理与信息系统》。屌丝专业？万金油专业？NO，这可是我大百度Robin的专业哦，哥哥！GG一下你就知道，NO！万能的长城；百度一下你就知道了。接下来的一段时间里会将静静躺在磁盘文件里的东西拿出来晒晒太阳。别一板砖一臭鞋地扔过来哦，疼！！！码农改码字了，一个写得了代码，修得了航母，设计得了导弹，拿了110米跨栏冠军的好厨司出现了。这都是什么鬼呀，板砖一摞摞，疼？？？！！！说明还有知觉，点燃酱爆心中的那团火。duang。。。</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-07 22:10</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4486260\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4486260);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4486260,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/7 22:10:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4486260.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=21", "desc": "摘要: 感谢在浩瀚互联网世界里，游历至此的您！有缘千里来相会，文字的相会，博客的会见。缘分？猿粪？曾几何时一直想经营一个自己的博客。记录自己的心绪，分享自己的技术，反思自己的行为，局促自己的成长。这个想法在脑海里不知道辗转和浮现了多少遍，然后又被自己的懒惰一次次无情地抛下。如此的反复而始终没有进展，积攒..."}
{"title": "Sybase IQ导出文件的几种方式", "content": "IQ有四种方法，将表的数据导出为文本文件：1、重定向 SELECT * FROM TABLE1 ># D:MYDATATABLE1.TXT -- 文件生成在执行语句的客户端上\r\n2、通过选项导出 \r\n\r\nSET TEMPORARY OPTION Temp_Extract_Name1 = '/data/mydata/table1.txt'; \r\nSET TEMPORARY OPTION Temp_Extract_Name2 = ’’; \r\nSELECT * FROM TABLE1; （将查询结果写入 table1.txt 文件中,） \r\nSET TEMPORARY OPTION Temp_Extract_Name1 = ’’; --- 该文件在 IQ SERVER上生成 \r\n\r\n3、output 语句 \r\n\r\nSELECT * FROM \"DBA\".\"V_ICP_ID\"; \r\nOUTPUT TO 'c:\\temp\\V_ICP_ID.out' --- 注意有引号 \r\nDELIMITED BY '|' FORMAT ASCII QUOTE ''; --- 文件生成在客户端\r\n\r\n4、iq_bcp 外部命令 iq_bcp [ [ database_name. ] owner. ] table_name { in | out }", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>Sybase IQ导出文件的几种方式 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4506603.html\">Sybase IQ导出文件的几种方式</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>IQ有四种方法，将表的数据导出为文本文件：<br>1、重定向 SELECT * FROM TABLE1 &gt;# D:MYDATATABLE1.TXT -- 文件生成在执行语句的客户端上</p>\r\n<p>2、通过选项导出 </p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">SET</span> <span style=\"color: #0000ff;\">TEMPORARY</span> <span style=\"color: #0000ff;\">OPTION</span> Temp_Extract_Name1 <span style=\"color: #808080;\">=</span> <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">/data/mydata/table1.txt</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">; \r\n</span><span style=\"color: #0000ff;\">SET</span> <span style=\"color: #0000ff;\">TEMPORARY</span> <span style=\"color: #0000ff;\">OPTION</span> Temp_Extract_Name2 <span style=\"color: #808080;\">=</span><span style=\"color: #000000;\"> ’’; \r\n</span><span style=\"color: #0000ff;\">SELECT</span> <span style=\"color: #808080;\">*</span> <span style=\"color: #0000ff;\">FROM</span><span style=\"color: #000000;\"> TABLE1; （将查询结果写入 table1.txt 文件中,） \r\n</span><span style=\"color: #0000ff;\">SET</span> <span style=\"color: #0000ff;\">TEMPORARY</span> <span style=\"color: #0000ff;\">OPTION</span> Temp_Extract_Name1 <span style=\"color: #808080;\">=</span> ’’; <span style=\"color: #008080;\">--</span><span style=\"color: #008080;\">- 该文件在 IQ SERVER上生成 </span></pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">3、output 语句 </span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">SELECT</span> <span style=\"color: #808080;\">*</span> <span style=\"color: #0000ff;\">FROM</span><span style=\"color: #000000;\"> \"DBA\".\"V_ICP_ID\"; \r\nOUTPUT </span><span style=\"color: #0000ff;\">TO</span> <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">c:\\temp\\V_ICP_ID.out</span><span style=\"color: #ff0000;\">'</span> <span style=\"color: #008080;\">--</span><span style=\"color: #008080;\">- 注意有引号 </span>\r\nDELIMITED <span style=\"color: #0000ff;\">BY</span> <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">|</span><span style=\"color: #ff0000;\">'</span> FORMAT <span style=\"color: #ff00ff;\">ASCII</span> QUOTE <span style=\"color: #ff0000;\">''</span>; <span style=\"color: #008080;\">--</span><span style=\"color: #008080;\">- 文件生成在客户端</span></pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">4、iq_bcp 外部命令 iq_bcp [ [ database_name. ] owner. ] table_name { in | out }</span></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-15 18:18</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4506603\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4506603);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4506603,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/15 18:18:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4506603.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=20", "desc": "摘要: IQ有四种方法，将表的数据导出为文本文件：1、重定向 SELECT * FROM TABLE1 ># D:MYDATATABLE1.TXT -- 文件生成在执行语句的客户端上2、通过选项导出SET TEMPORARY OPTION Temp_Extract_Name1 = '/data/mydata..."}
{"title": "Sybase IQ如何将大文件数据迅速加载到数据库", "content": "　　试想一下，如果一个文件5G、10G甚至更大。如何将它迅速地加载到数据库指定的表呢？我们看看Sybase IQ是如何迅速地将表的数据加载到数据库的。\r\n数据文件格式：\r\n1440,2011-01-09 00:00:00,1,珠海,1,C网,8612345678222,221943,1,12175,1,12,14426467,1191632,9,1440,2011-01-09 00:00:00,1,珠海,1,C网,8612345678222,968852,1,82077,1,7,2430696,134921,5,1440,2011-01-09 00:00:00,1,珠海,1,C网,8612345678222,936862,3,10847,1,5,4585323,362630,5,1440,2011-01-09 00:00:00,1,珠海,1,C网,8612345678222,308796,2,5614,2,12,14401931,1202200,11,1440,2011-01-09 00:00:00,1,珠海,2,固网,861234567000,11058523,6,984391,3,19,12789576,1113565,19,\r\n据以“,”分割。并以“,”结尾。\r\n\r\ncommit;\r\nlock table iqloadtest in write mode wait '00:05:00';\r\nSet temporary option conversion_error='off';\r\nSet temporary option escape_character='on';\r\nSet temporary option load_memory_mb=256;Set temporary option timestamp_format='YYYY-MM-DD HH:mm:ss';--解决时间格式问题\r\nLOAD TABLE iqloadtest          \r\n(                                       \r\n  col1  ',',                  \r\n  col2 ',',              \r\n  col3  ',',        \r\n  col4 ',',       \r\n  col5     ',',        \r\n  col6   ',',        \r\n  col7        ',',        \r\n  col8  ',',  \r\n  col9 ',',      \r\n  col10  ',',      \r\n  col11     ',',      \r\n  col12 ',',     \r\n  col13  ',',      \r\n  col14 ',',        \r\n  col15    ',\\x0a',--最后一个字段顺便过滤掉换行符0a　filler(1)--在此例子中加了此条语句最后一行数据不被加载\r\n) \r\n FROM '/home/test/test.load' \r\n ESCAPES OFF \r\n QUOTES OFF \r\n IGNORE CONSTRAINT ALL 0 \r\n MESSAGE LOG '/home/test/iqMsg.log' \r\n ROW LOG '/home/test/iqRow.log' \r\n  ONLY LOG ALL \r\n Notify 50000 \r\n WITH CHECKPOINT ON;\r\n commit; \r\n\r\n \r\n结论：如果行结束符后面带了分隔符的话必须用此种方式。否则无法加载。\t如果行结束符后面不带分隔符的话可以用filler(1)这种方式\r\nIQLoad 会遇到的问题。1、  ODBC 与 JDBC 的默认设置不一样。 JDBC 需要加上  Set temporary option escape_character='on';\r\n2、当数据中存在null时的解决方法\r\n\r\ncommit;\r\nlock table iqloadtest in write mode wait '00:05:00';\r\nSet temporary option conversion_error='off';\r\nSet temporary option escape_character='on';\r\nSet temporary option load_memory_mb=256;\r\nSet temporary option timestamp_format='YYYY-MM-DD HH:mm:ss';\r\nLOAD TABLE iqloadtest          \r\n(   \r\n字段1 '分隔符' null('NULL'), \r\n字段2 '分隔符' null('NULL'),\r\ncol15 '分隔符\\x0a' null('NULL'), \r\n　filler(1)--在此例子中加了此条语句最后一行数据不被加载\r\n) \r\n FROM '/home/test/test.load' \r\n ESCAPES OFF \r\n QUOTES OFF \r\n IGNORE CONSTRAINT ALL 0 \r\n MESSAGE LOG '/home/test/iqMsg.log' \r\n ROW LOG '/home/test/iqRow.log' \r\n  ONLY LOG ALL \r\n Notify 50000 \r\n WITH CHECKPOINT ON;\r\n commit; \r\n\r\n ", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>Sybase IQ如何将大文件数据迅速加载到数据库 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4506562.html\">Sybase IQ如何将大文件数据迅速加载到数据库</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>　　试想一下，如果一个文件5G、10G甚至更大。如何将它迅速地加载到数据库指定的表呢？我们看看Sybase IQ是如何迅速地将表的数据加载到数据库的。</p>\r\n<p>数据文件格式：</p>\r\n<p>1440,2011-01-09 00:00:00,1,珠海,1,C网,8612345678222,221943,1,12175,1,12,14426467,1191632,9,<br>1440,2011-01-09 00:00:00,1,珠海,1,C网,8612345678222,968852,1,82077,1,7,2430696,134921,5,<br>1440,2011-01-09 00:00:00,1,珠海,1,C网,8612345678222,936862,3,10847,1,5,4585323,362630,5,<br>1440,2011-01-09 00:00:00,1,珠海,1,C网,8612345678222,308796,2,5614,2,12,14401931,1202200,11,<br>1440,2011-01-09 00:00:00,1,珠海,2,固网,861234567000,11058523,6,984391,3,19,12789576,1113565,19,</p>\r\n<p>据以“,”分割。并以“,”结尾。</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">commit</span><span style=\"color: #000000;\">;\r\nlock </span><span style=\"color: #0000ff;\">table</span> iqloadtest <span style=\"color: #808080;\">in</span> write mode wait <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">00:05:00</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">Set</span> <span style=\"color: #0000ff;\">temporary</span> <span style=\"color: #0000ff;\">option</span> conversion_error<span style=\"color: #808080;\">=</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">off</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">Set</span> <span style=\"color: #0000ff;\">temporary</span> <span style=\"color: #0000ff;\">option</span> escape_character<span style=\"color: #808080;\">=</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">on</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">Set</span> <span style=\"color: #0000ff;\">temporary</span> <span style=\"color: #0000ff;\">option</span> load_memory_mb<span style=\"color: #808080;\">=</span><span style=\"color: #800000; font-weight: bold;\">256</span><span style=\"color: #000000;\">;<br><span style=\"color: #ff0000;\"><strong>Set temporary option timestamp_format='YYYY-MM-DD HH:mm:ss';--解决时间格式问题\r\n</strong></span></span><span style=\"color: #0000ff;\">LOAD</span> <span style=\"color: #0000ff;\">TABLE</span><span style=\"color: #000000;\"> iqloadtest          \r\n(                                       \r\n  col1  </span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">,</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,                  \r\n  col2 </span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">,</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,              \r\n  col3  </span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">,</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,        \r\n  col4 </span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">,</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,       \r\n  col5     </span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">,</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,        \r\n  col6   </span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">,</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,        \r\n  col7        </span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">,</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,        \r\n  col8  </span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">,</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,  \r\n  col9 </span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">,</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,      \r\n  col10  </span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">,</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,      \r\n  col11     </span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">,</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,      \r\n  col12 </span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">,</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,     \r\n  col13  </span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">,</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,      \r\n  col14 </span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">,</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">,        \r\n  col15    </span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">,\\x0a</span><span style=\"color: #ff0000;\">',--最后一个字段顺便过滤掉换行符0a<br>　<strong>filler(1)</strong>--在此例子中加了此条语句最后一行数据不被加载</span><span style=\"color: #000000;\">\r\n) \r\n </span><span style=\"color: #0000ff;\">FROM</span> <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">/home/test/test.load</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\"> \r\n ESCAPES </span><span style=\"color: #0000ff;\">OFF</span><span style=\"color: #000000;\"> \r\n QUOTES </span><span style=\"color: #0000ff;\">OFF</span><span style=\"color: #000000;\"> \r\n IGNORE </span><span style=\"color: #0000ff;\">CONSTRAINT</span> <span style=\"color: #808080;\">ALL</span> <span style=\"color: #800000; font-weight: bold;\">0</span><span style=\"color: #000000;\"> \r\n MESSAGE </span><span style=\"color: #ff00ff;\">LOG</span> <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">/home/test/iqMsg.log</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\"> \r\n ROW </span><span style=\"color: #ff00ff;\">LOG</span> <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">/home/test/iqRow.log</span><span style=\"color: #ff0000;\">'</span> \r\n  <span style=\"color: #0000ff;\">ONLY</span> <span style=\"color: #ff00ff;\">LOG</span> <span style=\"color: #808080;\">ALL</span><span style=\"color: #000000;\"> \r\n Notify </span><span style=\"color: #800000; font-weight: bold;\">50000</span> \r\n <span style=\"color: #0000ff;\">WITH</span> <span style=\"color: #0000ff;\">CHECKPOINT</span> <span style=\"color: #0000ff;\">ON</span><span style=\"color: #000000;\">;\r\n </span><span style=\"color: #0000ff;\">commit</span>; </pre>\r\n</div>\r\n<p> </p>\r\n<p>结论：如果行结束符后面带了分隔符的话必须用此种方式。否则无法加载。<br>\t如果行结束符后面不带分隔符的话可以用filler(1)这种方式</p>\r\n<p>IQLoad 会遇到的问题。<br>1、  ODBC 与 JDBC 的默认设置不一样。 JDBC 需要加上  <br><span style=\"color: #ff0000;\"><strong>Set temporary option escape_character='on';</strong></span></p>\r\n<p><span style=\"color: #000000;\">2、当数据中存在null时的解决方法</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">commit</span><span style=\"color: #000000;\">;\r\nlock </span><span style=\"color: #0000ff;\">table</span> iqloadtest <span style=\"color: #808080;\">in</span> write mode wait <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">00:05:00</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">Set</span> <span style=\"color: #0000ff;\">temporary</span> <span style=\"color: #0000ff;\">option</span> conversion_error<span style=\"color: #808080;\">=</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">off</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">Set</span> <span style=\"color: #0000ff;\">temporary</span> <span style=\"color: #0000ff;\">option</span> escape_character<span style=\"color: #808080;\">=</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">on</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">Set</span> <span style=\"color: #0000ff;\">temporary</span> <span style=\"color: #0000ff;\">option</span> load_memory_mb<span style=\"color: #808080;\">=</span><span style=\"color: #800000; font-weight: bold;\">256</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">Set</span> <span style=\"color: #0000ff;\">temporary</span> <span style=\"color: #0000ff;\">option</span> timestamp_format<span style=\"color: #808080;\">=</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">YYYY-MM-DD HH:mm:ss</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">;\r\n</span><span style=\"color: #0000ff;\">LOAD</span> <span style=\"color: #0000ff;\">TABLE</span><span style=\"color: #000000;\"> iqloadtest          \r\n(   \r\n字段1 </span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">分隔符</span><span style=\"color: #ff0000;\">'</span> <span style=\"color: #0000ff;\">null</span>(<span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">NULL</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">), \r\n字段2 </span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">分隔符</span><span style=\"color: #ff0000;\">'</span> <span style=\"color: #0000ff;\">null</span>(<span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">NULL</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">),\r\ncol15 </span><span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">分隔符\\x0a</span><span style=\"color: #ff0000;\">'</span> <span style=\"color: #0000ff;\">null</span>(<span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">NULL</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\">), \r\n　filler(</span><span style=\"color: #800000; font-weight: bold;\">1</span>)<span style=\"color: #008080;\">--</span><span style=\"color: #008080;\">在此例子中加了此条语句最后一行数据不被加载</span>\r\n<span style=\"color: #000000;\">) \r\n </span><span style=\"color: #0000ff;\">FROM</span> <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">/home/test/test.load</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\"> \r\n ESCAPES </span><span style=\"color: #0000ff;\">OFF</span><span style=\"color: #000000;\"> \r\n QUOTES </span><span style=\"color: #0000ff;\">OFF</span><span style=\"color: #000000;\"> \r\n IGNORE </span><span style=\"color: #0000ff;\">CONSTRAINT</span> <span style=\"color: #808080;\">ALL</span> <span style=\"color: #800000; font-weight: bold;\">0</span><span style=\"color: #000000;\"> \r\n MESSAGE </span><span style=\"color: #ff00ff;\">LOG</span> <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">/home/test/iqMsg.log</span><span style=\"color: #ff0000;\">'</span><span style=\"color: #000000;\"> \r\n ROW </span><span style=\"color: #ff00ff;\">LOG</span> <span style=\"color: #ff0000;\">'</span><span style=\"color: #ff0000;\">/home/test/iqRow.log</span><span style=\"color: #ff0000;\">'</span> \r\n  <span style=\"color: #0000ff;\">ONLY</span> <span style=\"color: #ff00ff;\">LOG</span> <span style=\"color: #808080;\">ALL</span><span style=\"color: #000000;\"> \r\n Notify </span><span style=\"color: #800000; font-weight: bold;\">50000</span> \r\n <span style=\"color: #0000ff;\">WITH</span> <span style=\"color: #0000ff;\">CHECKPOINT</span> <span style=\"color: #0000ff;\">ON</span><span style=\"color: #000000;\">;\r\n </span><span style=\"color: #0000ff;\">commit</span>; </pre>\r\n</div>\r\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-15 18:02</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4506562\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4506562);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4506562,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/15 18:02:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4506562.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=20", "desc": "摘要: 试想一下，如果一个文件5G、10G甚至更大。如何将它迅速地加载到数据库指定的表呢？我们看看Sybase IQ是如何迅速地将表的数据加载到数据库的。数据文件格式：1440,2011-01-09 00:00:00,1,珠海,1,C网,8612345678222,221943,1,12175,1,12..."}
{"title": "Select Top在不同数据库中的使用", "content": "1. oracle数据库\r\n\r\nSELECT * FROM TABLE1 WHERE ROWNUM<=N\r\n\r\n2. Infomix数据库\r\n\r\nSELECT FIRST N * FROM TABLE1\r\n\r\n3. DB2数据库\r\n\r\nSELECT * ROW_NUMBER() OVER(ORDER BY COL1 DESC) AS ROWNUM WHERE ROWNUM<=N\r\n\r\n或者\r\n\r\nSELECT COLUMN FROM TABLE FETCH FIRST N ROWS ONLY\r\n\r\n4. SQL Server数据库\r\nSELECT TOP N * FROM TABLE1\r\n5. Sybase数据库\r\n\r\nSET ROWCOUNT N\r\nGO\r\nSELECT * FROM TABLE1\r\nSET ROWCOUNT 0\r\n\r\nSELECT TOP N * FROM TABLE1\r\n\r\n6. MySQL数据库\r\n\r\nSELECT * FROM TABLE1 LIMIT N\r\n\r\n7. FoxPro数据库\r\n\r\nSELECT * TOP N FROM TABLE ORDER BY COLUMN\r\n\r\n ", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>Select Top在不同数据库中的使用 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4506629.html\">Select Top在不同数据库中的使用</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>1. oracle数据库</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">SELECT</span> <span style=\"color: #808080;\">*</span> <span style=\"color: #0000ff;\">FROM</span> TABLE1 <span style=\"color: #0000ff;\">WHERE</span> ROWNUM<span style=\"color: #808080;\">&lt;=</span>N</pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">2. Infomix数据库</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">SELECT</span> FIRST N <span style=\"color: #808080;\">*</span> <span style=\"color: #0000ff;\">FROM</span> TABLE1</pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">3. DB2数据库</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">SELECT</span> <span style=\"color: #808080;\">*</span> ROW_NUMBER() <span style=\"color: #0000ff;\">OVER</span>(<span style=\"color: #0000ff;\">ORDER</span> <span style=\"color: #0000ff;\">BY</span> COL1 <span style=\"color: #0000ff;\">DESC</span>) <span style=\"color: #0000ff;\">AS</span> ROWNUM <span style=\"color: #0000ff;\">WHERE</span> ROWNUM<span style=\"color: #808080;\">&lt;=</span>N</pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">或者</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">SELECT</span> <span style=\"color: #0000ff;\">COLUMN</span> <span style=\"color: #0000ff;\">FROM</span> <span style=\"color: #0000ff;\">TABLE</span> <span style=\"color: #0000ff;\">FETCH</span> FIRST N ROWS <span style=\"color: #0000ff;\">ONLY</span></pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">4. SQL Server数据库</span></p>\r\n<p>SELECT TOP N * FROM TABLE1</p>\r\n<p>5. Sybase数据库</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">SET</span> <span style=\"color: #0000ff;\">ROWCOUNT</span><span style=\"color: #000000;\"> N\r\n</span><span style=\"color: #0000ff;\">GO</span>\r\n<span style=\"color: #0000ff;\">SELECT</span> <span style=\"color: #808080;\">*</span> <span style=\"color: #0000ff;\">FROM</span><span style=\"color: #000000;\"> TABLE1\r\n</span><span style=\"color: #0000ff;\">SET</span> <span style=\"color: #0000ff;\">ROWCOUNT</span> <span style=\"color: #800000; font-weight: bold;\">0</span>\r\n\r\n<span style=\"color: #0000ff;\">SELECT</span> <span style=\"color: #0000ff;\">TOP</span> N <span style=\"color: #808080;\">*</span> <span style=\"color: #0000ff;\">FROM</span> TABLE1</pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">6. MySQL数据库</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">SELECT</span> <span style=\"color: #808080;\">*</span> <span style=\"color: #0000ff;\">FROM</span> TABLE1 LIMIT N</pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">7. FoxPro数据库</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">SELECT</span> <span style=\"color: #808080;\">*</span> <span style=\"color: #0000ff;\">TOP</span> N <span style=\"color: #0000ff;\">FROM</span> <span style=\"color: #0000ff;\">TABLE</span> <span style=\"color: #0000ff;\">ORDER</span> <span style=\"color: #0000ff;\">BY</span> <span style=\"color: #0000ff;\">COLUMN</span></pre>\r\n</div>\r\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-15 18:30</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4506629\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4506629);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4506629,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/15 18:30:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4506629.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=20", "desc": "摘要: 1. oracle数据库SELECT * FROM TABLE1 WHERE ROWNUM<=N2. Infomix数据库SELECT FIRST N * FROM TABLE13. DB2数据库SELECT * ROW_NUMBER() OVER(ORDER BY COL1 DESC) AS RO..."}
{"title": "windows2003批量添加和导出所有ip", "content": "批量添加IP\r\n在cmd命令行下运行：\r\n\r\nFOR /L %i IN (130,1,190) DO netsh interface ip add address \"本地连接\" 192.168.1.%i 255.255.255.192\r\n\r\n往“本地连接”中添加“192.168.1.130~192.168.1.190”的所有IP，且子网掩码都是255.255.255.192\r\n \r\n导出所有IP\r\n写一个批处理bat文件,如下内容,运行\r\n\r\n@echo off\r\n\r\nfor /f %%i in (‘wmic computersystem get name^|findstr /i /v “name”‘) do set name=%%i&echo 计算计算机名称为%%i > %%i.txt\r\nfor /f “delims=: tokens=2″ %%j in (‘ipconfig^|findstr /i “IP Address”‘) do echo 计算机ip为%%j >> %name%.txt\r\necho 任务处理完毕任意键显示\r\npause&start %name%.txt\r\n\r\n ", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>windows2003批量添加和导出所有ip - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4505875.html\">windows2003批量添加和导出所有ip</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>批量添加IP</p>\r\n<p>在cmd命令行下运行：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">FOR</span> /L %i IN (130,1,190) <span style=\"color: #0000ff;\">DO</span> netsh interface ip add address \"本地连接\" 192.168.1.%i 255.255.255.192</pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">往“本地连接”中添加“</span><span style=\"line-height: 1.5;\">192.168.1</span><span style=\"line-height: 1.5;\">.130~</span><span style=\"line-height: 1.5;\">192.168.1</span><span style=\"line-height: 1.5;\">.190”的所有IP，且子网掩码都是255.255.255.192</span></p>\r\n<p> </p>\r\n<p>导出所有IP</p>\r\n<p>写一个批处理bat文件,如下内容,运行</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">@echo</span> <span style=\"color: #0000ff;\">off</span>\r\n\r\n<span style=\"color: #0000ff;\">for</span> /f %%i in (‘wmic computersystem get name^|findstr /i /v “name”‘) <span style=\"color: #0000ff;\">do</span> <span style=\"color: #0000ff;\">set</span> name=%%i&amp;<span style=\"color: #0000ff;\">echo</span> 计算计算机名称为%%i &gt; %%i.<span style=\"color: #000000;\">txt\r\n</span><span style=\"color: #0000ff;\">for</span> /f “delims=: tokens=2″ %%j in (‘ipconfig^|findstr /i “IP Address”‘) <span style=\"color: #0000ff;\">do</span> <span style=\"color: #0000ff;\">echo</span> 计算机ip为%%j &gt;&gt; %name%.<span style=\"color: #000000;\">txt\r\n</span><span style=\"color: #0000ff;\">echo</span><span style=\"color: #000000;\"> 任务处理完毕任意键显示\r\n</span><span style=\"color: #0000ff;\">pause</span>&amp;<span style=\"color: #0000ff;\">start</span> %name%.txt</pre>\r\n</div>\r\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-15 14:24</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4505875\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4505875);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4505875,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/15 14:24:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4505875.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=20", "desc": "摘要: 批量添加IP在cmd命令行下运行：FOR /L %i IN (130,1,190) DO netsh interface ip add address \"本地连接\" 192.168.1.%i 255.255.255.192往“本地连接”中添加“192.168.1.130~192.168.1.190”..."}
{"title": "windows下批量删除文件", "content": "FORFILES /P d:\\www /D -7 /S /M ex*.log /C \"cmd /c del @path\"\r\n删除d:\\www目录下7天前ex*.log的所有文件\r\n \r\n例子：\r\nD:\\test>FORFILES /D -30 /S /M *jpg /C \"cmd /c echo @path 0x09 在 30 前就被更改。\r\n\"D:\\test\\index_ad1.jpg\"          在 30 前就被更改。\"D:\\test\\index_ad2.jpg\"          在 30 前就被更改。\"D:\\test\\index_ad3.jpg\"          在 30 前就被更改。\"D:\\test\\index_ad4.jpg\"          在 30 前就被更改。\"D:\\test\\index_ad5.jpg\"          在 30 前就被更改。\"D:\\test\\淘宝商城多格jQuery焦点图\\index.jpg\"     在 30 前就被更改。\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\a01.jpg\"   在 30 前就被更改。\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\a02.jpg\"   在 30 前就被更改。\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\a03.jpg\"   在 30 前就被更改。\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\a04.jpg\"   在 30 前就被更改。\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\b01.jpg\"   在 30 前就被更改。\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\c01.jpg\"   在 30 前就被更改。\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\c02.jpg\"   在 30 前就被更改。\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\c03.jpg\"   在 30 前就被更改。\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\c04.jpg\"   在 30 前就被更改。\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\d01.jpg\"   在 30 前就被更改。\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\d02.jpg\"   在 30 前就被更改。\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\d03.jpg\"   在 30 前就被更改。\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\d04.jpg\"   在 30 前就被更改。\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\e01.jpg\"   在 30 前就被更改。", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>windows下批量删除文件 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4505855.html\">windows下批量删除文件</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p><span style=\"color: #ff0000;\"><strong><span style=\"line-height: 1.5;\">FORFILES /P d:\\www /D -7 /S /M ex*.log /C \"cmd /c del @path\"</span></strong></span></p>\r\n<p>删除d:\\www目录下7天前ex*.log的所有文件</p>\r\n<p> </p>\r\n<p>例子：</p>\r\n<p>D:\\test&gt;FORFILES /D -30 /S /M *jpg /C \"cmd /c echo @path 0x09 在 30 前就被更改。</p>\r\n<p>\"D:\\test\\index_ad1.jpg\"          在 30 前就被更改。<br>\"D:\\test\\index_ad2.jpg\"          在 30 前就被更改。<br>\"D:\\test\\index_ad3.jpg\"          在 30 前就被更改。<br>\"D:\\test\\index_ad4.jpg\"          在 30 前就被更改。<br>\"D:\\test\\index_ad5.jpg\"          在 30 前就被更改。<br>\"D:\\test\\淘宝商城多格jQuery焦点图\\index.jpg\"     在 30 前就被更改。<br>\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\a01.jpg\"   在 30 前就被更改。<br>\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\a02.jpg\"   在 30 前就被更改。<br>\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\a03.jpg\"   在 30 前就被更改。<br>\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\a04.jpg\"   在 30 前就被更改。<br>\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\b01.jpg\"   在 30 前就被更改。<br>\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\c01.jpg\"   在 30 前就被更改。<br>\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\c02.jpg\"   在 30 前就被更改。<br>\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\c03.jpg\"   在 30 前就被更改。<br>\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\c04.jpg\"   在 30 前就被更改。<br>\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\d01.jpg\"   在 30 前就被更改。<br>\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\d02.jpg\"   在 30 前就被更改。<br>\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\d03.jpg\"   在 30 前就被更改。<br>\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\d04.jpg\"   在 30 前就被更改。<br>\"D:\\test\\淘宝商城多格jQuery焦点图\\img\\e01.jpg\"   在 30 前就被更改。</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-15 14:17</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4505855\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4505855);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4505855,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/15 14:17:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4505855.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=20", "desc": "摘要: FORFILES /P d:\\www /D -7 /S /M ex*.log /C \"cmd /c del @path\"删除d:\\www目录下7天前ex*.log的所有文件例子：D:\\test>FORFILES /D -30 /S /M *jpg /C \"cmd /c echo @path 0x09..."}
{"title": "bat批量去除文件首行和合并到文件", "content": "bat批量去除文件首行\r\n\r\nset n=1\r\n:starline\r\nfor %%j in (*.txt) do (\r\n:3\r\nif exist D:\\work\\test\\new_%n%.txt (set /a n+=1&goto 3)\r\nset file=%n%.txt\r\nfor /f \"skip=1 delims=\" %%i in ('type \"%file%\"') do (\r\necho %%i >>D:\\work\\test\\new_%n%.txt\r\n)\r\nset /a n+=1&goto starline\r\n)\r\n::start \"\" D:\\work\\test\\new_%n%.txt\r\n::pause>nul\r\n\r\n \r\n将一批文件合并到一个文件\r\n\r\n@echo off\r\nfor /f \"delims=\" %%a in ('dir/b *.txt') do (\r\ntype \"%%a\">>All.txt\r\n)\r\n\r\n ", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>bat批量去除文件首行和合并到文件 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4505863.html\">bat批量去除文件首行和合并到文件</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>bat批量去除文件首行</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">set</span> n=1\r\n<span style=\"color: #800000;\">:starline</span>\r\n<span style=\"color: #0000ff;\">for</span> %%j in (*.txt) <span style=\"color: #0000ff;\">do</span> (<span style=\"color: #000000;\">\r\n:</span>3\r\n<span style=\"color: #0000ff;\">if</span> <span style=\"color: #0000ff;\">exist</span> D:\\work\\test\\new_%n%.txt (<span style=\"color: #0000ff;\">set</span> /a n+=1&amp;<span style=\"color: #0000ff;\">goto</span> 3)\r\n<span style=\"color: #0000ff;\">set</span> file=%n%.<span style=\"color: #000000;\">txt\r\n</span><span style=\"color: #0000ff;\">for</span> /f \"skip=1 delims=\" %%i in ('<span style=\"color: #0000ff;\">type</span> \"%file%\"') <span style=\"color: #0000ff;\">do</span> (\r\n<span style=\"color: #0000ff;\">echo</span> %%i &gt;&gt;D:\\work\\test\\new_%n%.<span style=\"color: #000000;\">txt\r\n</span>)\r\n<span style=\"color: #0000ff;\">set</span> /a n+=1&amp;<span style=\"color: #0000ff;\">goto</span><span style=\"color: #000000;\"> starline\r\n</span>)\r\n<span style=\"color: #008000;\">::</span><span style=\"color: #008000;\">start \"\" D:\\work\\test\\new_%n%.txt</span><span style=\"color: #008000;\">\r\n::</span><span style=\"color: #008000;\">pause&gt;nul</span></pre>\r\n</div>\r\n<p> </p>\r\n<p>将一批文件合并到一个文件</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">@echo</span> <span style=\"color: #0000ff;\">off</span>\r\n<span style=\"color: #0000ff;\">for</span> /f \"delims=\" %%a in ('<span style=\"color: #0000ff;\">dir</span>/b *.txt') <span style=\"color: #0000ff;\">do</span> (\r\n<span style=\"color: #0000ff;\">type</span> \"%%a\"&gt;&gt;All.<span style=\"color: #000000;\">txt\r\n</span>)</pre>\r\n</div>\r\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-15 14:20</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4505863\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4505863);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4505863,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/15 14:20:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4505863.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=20", "desc": "摘要: bat批量去除文件首行set n=1:starlinefor %%j in (*.txt) do (:3if exist D:\\work\\test\\new_%n%.txt (set /a n+=1&goto 3)set file=%n%.txtfor /f \"skip=1 delims=\" %%i ..."}
{"title": "【转】自动实时监控Windows2003服务器终端登录并发邮件和发短信通知", "content": "记得以前管理的一批windows服务器，一些开源程序做的web站点总会遭到入侵。然而就想找找看有没有办法可以知道服务器有没有被入侵。服务器在什么时候登陆过，如果登陆马上发邮件通知，感觉这种问题肯定有人处理过，于是网上搜罗了一下。转载至此，至于是哪个地方转载过来的已经无从跟踪。\r\n朋友一台Windows服务器被黑了，而且还被人恶意删除了一些数据备份，帮其做了下安全加固，考虑到服务器都是通过Windows 终端服务器来管理的，就想办法对其登录做个监控，找了个命令行下发邮件的小工具blat还有批处理，做了个简单的监控程序，功能是当有人通过终端登录且成功后，会向指定的邮箱发送登录者IP地址。1.先下载blat解压缩到c盘blat目录下面。2.任意目录新建一个bat文件，我这里是mail.bat,内容如下，\r\n\r\n@echo off\r\ndate /t >mail.txt\r\ntime /t >>mail.txt\r\nnetstat -n -p tcp | find \"3389\" >>mail.txt\r\n:::::::::::::: config::::::::::::::\r\nset from=webshell.cc@126.com\r\nset user=webshell.cc\r\nset pass=webshell.cc\r\nset to=webshell.cc@qq.com\r\nset subj=3389\r\nset mail=mail.txt\r\nset server=smtp.126.com\r\nset debug=-debug -log blat.log -timestamp\r\n\r\n::::::::::::::::: run blat :::::::::::::::::\r\nC:\\blat\\full\\blat.exe %mail% -to %to% -base64 -charset Gb2312 -subject %subj% -server %server% -f %from% -u %user% -pw %pass% %debug%start Explorer很简单的了，先通过bat查找哪个ip连接到了本机的3389端口，然后邮件发送到指定邮箱。3.进入控制面板—管理工具—终端服务器配置—RDP-Tcp—属性-环境-用户登录时启用下列程序—在程序路径和文件名—写“C:\\mail.bat”—起始于—写“C:\\”这样就ok了。4.注销，重新登录，看是否能收到邮件。如果出错的话，桌面出不来的话，可通过ctrl+alt+end来呼出任务管理器来调用桌面。5.目前发现个小bug，就是登录的时候，会弹出一个cmd的框。6.如果开通邮箱的短信通知，或者使用139的邮箱，可以达到实时的手机短信通知，有兴趣的可以试试。\r\n当然，这个脚本本身也存在安全问题。一旦服务器被入侵，邮箱也就不保了。", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>【转】自动实时监控Windows2003服务器终端登录并发邮件和发短信通知 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4505842.html\">【转】自动实时监控Windows2003服务器终端登录并发邮件和发短信通知</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>记得以前管理的一批windows服务器，一些开源程序做的web站点总会遭到入侵。然而就想找找看有没有办法可以知道服务器有没有被入侵。服务器在什么时候登陆过，如果登陆马上发邮件通知，感觉这种问题肯定有人处理过，于是网上搜罗了一下。转载至此，至于是哪个地方转载过来的已经无从跟踪。</p>\r\n<p>朋友一台Windows服务器被黑了，而且还被人恶意删除了一些数据备份，帮其做了下安全加固，考虑到服务器都是通过Windows 终端服务器来管理的，就想办法对其登录做个监控，找了个命令行下发邮件的小工具blat还有批处理，做了个简单的监控程序，功能是当有人通过终端登录且成功后，会向指定的邮箱发送登录者IP地址。<br>1.先下载blat解压缩到c盘blat目录下面。<br>2.任意目录新建一个bat文件，我这里是mail.bat,内容如下，</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">@echo</span> <span style=\"color: #0000ff;\">off</span>\r\n<span style=\"color: #0000ff;\">date</span> /t &gt;mail.<span style=\"color: #000000;\">txt\r\n</span><span style=\"color: #0000ff;\">time</span> /t &gt;&gt;mail.<span style=\"color: #000000;\">txt\r\nnetstat -n -p tcp | </span><span style=\"color: #0000ff;\">find</span> \"3389\" &gt;&gt;mail.<span style=\"color: #000000;\">txt\r\n</span><span style=\"color: #008000;\">::</span><span style=\"color: #008000;\">:::::::::::: config::::::::::::::</span>\r\n<span style=\"color: #0000ff;\">set</span> from=webshell.cc@126.<span style=\"color: #000000;\">com\r\n</span><span style=\"color: #0000ff;\">set</span> user=webshell.<span style=\"color: #000000;\">cc\r\n</span><span style=\"color: #0000ff;\">set</span> pass=webshell.<span style=\"color: #000000;\">cc\r\n</span><span style=\"color: #0000ff;\">set</span> to=webshell.cc@qq.<span style=\"color: #000000;\">com\r\n</span><span style=\"color: #0000ff;\">set</span> subj=3389\r\n<span style=\"color: #0000ff;\">set</span> mail=mail.<span style=\"color: #000000;\">txt\r\n</span><span style=\"color: #0000ff;\">set</span> server=smtp.126.<span style=\"color: #000000;\">com\r\n</span><span style=\"color: #0000ff;\">set</span> <span style=\"color: #0000ff;\">debug</span>=-<span style=\"color: #0000ff;\">debug</span> -log blat.log -timestamp</pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">::::::::::::::::: run blat :::::::::::::::::</span></p>\r\n<p>C:\\blat\\full\\blat.exe %mail% -to %to% -base64 -charset Gb2312 -subject %subj% -server %server% -f %from% -u %user% -pw %pass% %debug%<br>start Explorer<br>很简单的了，先通过bat查找哪个ip连接到了本机的3389端口，然后邮件发送到指定邮箱。<br>3.进入控制面板—管理工具—终端服务器配置—RDP-Tcp—属性-环境-用户登录时启用下列程序—在程序路径和文件名—写“C:\\mail.bat”—起始于—写“C:\\”这样就ok了。<br>4.注销，重新登录，看是否能收到邮件。如果出错的话，桌面出不来的话，可通过ctrl+alt+end来呼出任务管理器来调用桌面。<br>5.目前发现个小bug，就是登录的时候，会弹出一个cmd的框。<br>6.如果开通邮箱的短信通知，或者使用139的邮箱，可以达到实时的手机短信通知，有兴趣的可以试试。</p>\r\n<p><span style=\"line-height: 1.5;\">当然，这个脚本本身也存在安全问题。一旦服务器被入侵，邮箱也就不保了。</span></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-15 14:11</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4505842\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4505842);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4505842,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/15 14:11:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4505842.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=20", "desc": "摘要: 记得以前管理的一批windows服务器，一些开源程序做的web站点总会遭到入侵。然而就想找找看有没有办法可以知道服务器有没有被入侵。服务器在什么时候登陆过，如果登陆马上发邮件通知，感觉这种问题肯定有人处理过，于是网上搜罗了一下。转载至此，至于是哪个地方转载过来的已经无从跟踪。朋友一台Windows服..."}
{"title": "windows添加和删除服务", "content": "删除系统服务，记得一定要小心用。避免删错sc delete 服务名\r\n加入服务: sc create 服务名 binPath= 路径 start= auto", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>windows添加和删除服务 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4505847.html\">windows添加和删除服务</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>删除系统服务，记得一定要小心用。避免删错<br><span style=\"color: #ff0000;\"><strong>sc delete 服务名</strong></span></p>\r\n<p>加入服务: <br><span style=\"color: #ff0000;\"><strong>sc create 服务名 binPath= 路径 start= auto</strong></span></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-15 14:14</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4505847\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4505847);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4505847,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/15 14:14:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4505847.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=20", "desc": "摘要: 删除系统服务，记得一定要小心用。避免删错sc delete 服务名加入服务: sc create 服务名 binPath= 路径 start= auto"}
{"title": "Linux压缩和解压汇总", "content": "各种后缀的压缩包压缩方法和解压方法\r\n\r\n\r\n\r\n压缩包\r\n压缩\r\n解压\r\n\r\n\r\n.tar.gz和.tgz\r\ntar -czf jpg.tar.gz *.jpg\r\ntar -xzvf filename -C path\r\n\r\n\r\n.tar.bz2\r\ntar -cjf jpg.tar.bz2 *.jpg\r\ntar -xjvf filename -C path\r\n\r\n\r\n.tar.Z\r\ntar -cZf jpg.tar.Z *.jpg\r\ntar -xZvf filename -C path\r\n\r\n\r\n.tar\r\ntar -cvf jpg.tar *.jpg\r\ntar -xvf filename -C path\r\n\r\n\r\n.gz\r\ntar -czf jpg.tar.gz *.jpg\r\ntar -xzvf filename -C path　　\r\n\r\n\r\n.bz2\r\nbzip2 filename\r\nbunzip2 -f filename\r\n\r\n\r\n.Z\r\ncompress filename\r\numcompress filename\r\n\r\n\r\n.zip\r\nzip jpg.zip *.jpg\r\nunzip -q filename -C path\r\n\r\n\r\n.rar\r\nrar a jpg.rar *.jpg\r\nrar x filename -C path\r\n\r\n\r\n\r\n　　往.zip压缩包追加文件和目录的方法，zip -r filename.zip filename1 filenam2 /home/test\r\n　　tar压缩，某些目录不压缩\r\n\r\ntar -zcvf testtart20150708.tar --exclude=./public_html/images --exclude=./public_html/data/article --exclude=./public_html/data/sqldata --exclude=./public_html/data/afficheimg ./public_html/*\r\n\r\ntar压缩，某些文件不压缩（排除某些文件用 -X ）\r\n\r\ntar cvfz  backup_1.tar.gz   -exclude=resource*  -X ext.txt  /opt/data\r\n\r\n 　　tar不解压查看文件列表\r\n\r\ntar -ztvf filename.tar.gz \r\n\r\n　　tar解压某个文件到当前目录\r\n　　tar -xvf 压缩包名称 文件或目录\r\n\r\ntar -xvf filename.tar.gz www/wdlinux/apache/conf/vhost/00000.default.conf\r\ntar -xvf filename.tar.gz www/wdlinux/apache/conf/*\r\n\r\n \r\n总结 1、*.tar 用 tar –xvf 解压 2、*.gz 用 gzip -d或者gunzip 解压 3、*.tar.gz和*.tgz 用 tar –xzf 解压 4、*.bz2 用 bzip2 -d或者用bunzip2 解压 5、*.tar.bz2用tar –xjf 解压 6、*.Z 用 uncompress 解压 7、*.tar.Z 用tar –xZf 解压 8、*.rar 用 unrar e解压 9、*.zip 用 unzip 解压\r\n ", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>Linux压缩和解压汇总 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4505934.html\">Linux压缩和解压汇总</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>各种后缀的压缩包压缩方法和解压方法</p>\r\n<table border=\"0\">\r\n<tbody>\r\n<tr>\r\n<td>压缩包</td>\r\n<td>压缩</td>\r\n<td>解压</td>\r\n</tr>\r\n<tr>\r\n<td>.tar.gz和.tgz</td>\r\n<td>tar -czf jpg.tar.gz *.jpg</td>\r\n<td>tar -xzvf filename -C path</td>\r\n</tr>\r\n<tr>\r\n<td>.tar.bz2</td>\r\n<td>tar -cjf jpg.tar.bz2 *.jpg</td>\r\n<td>tar -xjvf filename -C path</td>\r\n</tr>\r\n<tr>\r\n<td>.tar.Z</td>\r\n<td>tar -cZf jpg.tar.Z *.jpg</td>\r\n<td>tar -xZvf filename -C path</td>\r\n</tr>\r\n<tr>\r\n<td>.tar</td>\r\n<td>tar -cvf jpg.tar *.jpg</td>\r\n<td>tar -xvf filename -C path</td>\r\n</tr>\r\n<tr>\r\n<td>.gz</td>\r\n<td>tar -czf jpg.tar.gz *.jpg</td>\r\n<td>tar -xzvf filename -C path　　</td>\r\n</tr>\r\n<tr>\r\n<td>.bz2</td>\r\n<td>bzip2 filename</td>\r\n<td>bunzip2 -f filename</td>\r\n</tr>\r\n<tr>\r\n<td>.Z</td>\r\n<td>compress filename</td>\r\n<td>umcompress filename</td>\r\n</tr>\r\n<tr>\r\n<td>.zip</td>\r\n<td>zip jpg.zip *.jpg</td>\r\n<td>unzip -q filename -C path</td>\r\n</tr>\r\n<tr>\r\n<td>.rar</td>\r\n<td>rar a jpg.rar *.jpg</td>\r\n<td>rar x filename -C path</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>　　往.zip压缩包追加文件和目录的方法，zip -r filename.zip filename1 filenam2 /home/test</p>\r\n<p>　　tar压缩，某些目录不压缩</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">tar</span> -zcvf testtart20150708.<span style=\"color: #0000ff;\">tar</span> --exclude=./public_html/images --exclude=./public_html/data/article --exclude=./public_html/data/sqldata --exclude=./public_html/data/afficheimg ./public_html<span style=\"color: #008000;\">/*</span></pre>\r\n</div>\r\n<p style=\"margin-left: 30px;\">tar压缩，某些文件不压缩（排除某些文件用 -X ）</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">tar</span> cvfz  backup_1.<span style=\"color: #0000ff;\">tar</span>.gz   -exclude=resource*  -X ext.txt  /opt/data</pre>\r\n</div>\r\n<p> 　　tar不解压查看文件列表</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">tar</span> -ztvf filename.<span style=\"color: #0000ff;\">tar</span>.gz </pre>\r\n</div>\r\n<p>　　tar解压某个文件到当前目录</p>\r\n<p>　　tar -xvf 压缩包名称 文件或目录</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">tar</span> -xvf filename.<span style=\"color: #0000ff;\">tar</span>.gz www/wdlinux/apache/conf/vhost/<span style=\"color: #800080;\">00000</span><span style=\"color: #000000;\">.default.conf\r\n</span><span style=\"color: #0000ff;\">tar</span> -xvf filename.<span style=\"color: #0000ff;\">tar</span>.gz www/wdlinux/apache/conf<span style=\"color: #008000;\">/*</span></pre>\r\n</div>\r\n<p> </p>\r\n<p style=\"margin-left: 30px;\">总结 <br>1、*.tar 用 tar –xvf 解压 <br>2、*.gz 用 gzip -d或者gunzip 解压 <br>3、*.tar.gz和*.tgz 用 tar –xzf 解压 <br>4、*.bz2 用 bzip2 -d或者用bunzip2 解压 <br>5、*.tar.bz2用tar –xjf 解压 <br>6、*.Z 用 uncompress 解压 <br>7、*.tar.Z 用tar –xZf 解压 <br>8、*.rar 用 unrar e解压 <br>9、*.zip 用 unzip 解压</p>\r\n<p style=\"margin-left: 30px;\"> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-15 14:45</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4505934\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4505934);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4505934,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/15 14:45:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4505934.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=20", "desc": "摘要: 各种后缀的压缩包压缩方法和解压方法压缩包压缩解压.tar.gz和.tgztar -czf jpg.tar.gz *.jpgtar -xzvf filename -C path.tar.bz2tar -cjf jpg.tar.bz2 *.jpgtar -xjvf filename -C path.ta..."}
{"title": "windows下bat批处理实现守护进程", "content": "本文转自网络，由于找不到原作者，因而无法知道出处。如果有幸让原作者看到，请联系我加上。先转载至此。\r\n最近几天加班加疯掉了，天天晚上没法睡。开发部的一个核心程序总是会自己宕机，然后需要手工去起，而这个服务的安全级别又很高，只有我可以操作，搞得我晚上老没法睡，昨晚实在受不了了，想起以前在hp-ux下写的shell守护进程，这回搞个windows下的bat版守护程序吧，当时晚上思路已经很迟钝了，就叫了个兄弟让他写了，上去后运行效果不错，至少昨晚我安心睡了7小时。 早上来把程序改完善一些，增加了记录等功能。实现：检查是否有notepad，要用的话就算成自己的进程名，如果进程宕了就过会自动重启（会在当前目录下生成一个start.bat）  \r\n\r\n@echo off\r\n\r\nset _task=notepad.exe\r\nset _svr=c:\\windows\\notepad.exe\r\nset _des=start.bat\r\n\r\n:checkstart\r\nfor /f \"tokens=5\" %%n in ('qprocess.exe ^| find \"%_task%\" ') do (\r\n if %%n==%_task% (goto checkag) else goto startsvr\r\n)\r\n\r\n \r\n\r\n:startsvr\r\necho %time% \r\necho ********程序开始启动********\r\necho 程序重新启动于 %time% ,请检查系统日志 >> restart_service.txt\r\necho start %_svr% > %_des%\r\necho exit >> %_des%\r\nstart %_des%\r\nset/p=.<nul\r\nfor /L %%i in (1 1 10) do set /p a=.<nul&ping.exe /n 2 127.0.0.1>nul\r\necho .\r\necho Wscript.Sleep WScript.Arguments(0) >%tmp%\\delay.vbs \r\ncscript //b //nologo %tmp%\\delay.vbs 10000 \r\ndel %_des% /Q\r\necho ********程序启动完成********\r\ngoto checkstart\r\n\r\n\r\n:checkag\r\necho %time% 程序运行正常,10秒后继续检查.. \r\necho Wscript.Sleep WScript.Arguments(0) >%tmp%\\delay.vbs \r\ncscript //b //nologo %tmp%\\delay.vbs 10000 \r\ngoto checkstart\r\n\r\n ", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>windows下bat批处理实现守护进程 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4505884.html\">windows下bat批处理实现守护进程</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>本文转自网络，由于找不到原作者，因而无法知道出处。如果有幸让原作者看到，请联系我加上。先转载至此。</p>\r\n<p>最近几天加班加疯掉了，天天晚上没法睡。开发部的一个核心程序总是会自己宕机，然后需要手工去起，而这个服务的安全级别又很高，只有我可以操作，搞得我晚上老没法睡，昨晚实在受不了了，想起以前在hp-ux下写的shell守护进程，这回搞个windows下的bat版守护程序吧，当时晚上思路已经很迟钝了，就叫了个兄弟让他写了，上去后运行效果不错，至少昨晚我安心睡了7小时。<br> <br>早上来把程序改完善一些，增加了记录等功能。<br>实现：<br>检查是否有notepad，要用的话就算成自己的进程名，如果进程宕了就过会自动重启（会在当前目录下生成一个start.bat）<br> <br> </p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">@echo</span> <span style=\"color: #0000ff;\">off</span>\r\n\r\n<span style=\"color: #0000ff;\">set</span> _task=notepad.<span style=\"color: #000000;\">exe\r\n</span><span style=\"color: #0000ff;\">set</span> _svr=c:\\windows\\notepad.<span style=\"color: #000000;\">exe\r\n</span><span style=\"color: #0000ff;\">set</span> _des=<span style=\"color: #0000ff;\">start</span>.<span style=\"color: #000000;\">bat\r\n\r\n</span><span style=\"color: #800000;\">:checkstart</span>\r\n<span style=\"color: #0000ff;\">for</span> /f \"tokens=5\" %%n in ('qprocess.exe ^| <span style=\"color: #0000ff;\">find</span> \"%_task%\" ') <span style=\"color: #0000ff;\">do</span> (\r\n <span style=\"color: #0000ff;\">if</span> %%n==%_task% (<span style=\"color: #0000ff;\">goto</span> checkag) <span style=\"color: #0000ff;\">else</span> <span style=\"color: #0000ff;\">goto</span><span style=\"color: #000000;\"> startsvr\r\n</span>)\r\n\r\n \r\n\r\n<span style=\"color: #800000;\">:startsvr</span>\r\n<span style=\"color: #0000ff;\">echo</span> %<span style=\"color: #0000ff;\">time</span><span style=\"color: #000000;\">% \r\n</span><span style=\"color: #0000ff;\">echo</span><span style=\"color: #000000;\"> ********程序开始启动********\r\n</span><span style=\"color: #0000ff;\">echo</span> 程序重新启动于 %<span style=\"color: #0000ff;\">time</span>% ,请检查系统日志 &gt;&gt; restart_service.<span style=\"color: #000000;\">txt\r\n</span><span style=\"color: #0000ff;\">echo</span> <span style=\"color: #0000ff;\">start</span> %_svr% &gt;<span style=\"color: #000000;\"> %_des%\r\n</span><span style=\"color: #0000ff;\">echo</span> <span style=\"color: #0000ff;\">exit</span> &gt;&gt;<span style=\"color: #000000;\"> %_des%\r\n</span><span style=\"color: #0000ff;\">start</span><span style=\"color: #000000;\"> %_des%\r\n</span><span style=\"color: #0000ff;\">set</span>/p=.&lt;<span style=\"color: #000000;\">nul\r\n</span><span style=\"color: #0000ff;\">for</span> /L %%i in (1 1 10) <span style=\"color: #0000ff;\">do</span> <span style=\"color: #0000ff;\">set</span> /p a=.&lt;nul&amp;ping.exe /n 2 127.0.0.1&gt;<span style=\"color: #000000;\">nul\r\n</span><span style=\"color: #0000ff;\">echo</span> .\r\n<span style=\"color: #0000ff;\">echo</span> Wscript.Sleep WScript.Arguments(0) &gt;%tmp%\\delay.<span style=\"color: #000000;\">vbs \r\ncscript </span>//b //nologo %tmp%\\delay.vbs 10000 \r\n<span style=\"color: #0000ff;\">del</span> %_des% /<span style=\"color: #000000;\">Q\r\n</span><span style=\"color: #0000ff;\">echo</span><span style=\"color: #000000;\"> ********程序启动完成********\r\n</span><span style=\"color: #0000ff;\">goto</span><span style=\"color: #000000;\"> checkstart\r\n\r\n\r\n</span><span style=\"color: #800000;\">:checkag</span>\r\n<span style=\"color: #0000ff;\">echo</span> %<span style=\"color: #0000ff;\">time</span>% 程序运行正常,10秒后继续检查.. \r\n<span style=\"color: #0000ff;\">echo</span> Wscript.Sleep WScript.Arguments(0) &gt;%tmp%\\delay.<span style=\"color: #000000;\">vbs \r\ncscript </span>//b //nologo %tmp%\\delay.vbs 10000 \r\n<span style=\"color: #0000ff;\">goto</span> checkstart</pre>\r\n</div>\r\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-15 14:26</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4505884\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4505884);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4505884,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/15 14:26:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4505884.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=20", "desc": "摘要: 本文转自网络，由于找不到原作者，因而无法知道出处。如果有幸让原作者看到，请联系我加上。先转载至此。最近几天加班加疯掉了，天天晚上没法睡。开发部的一个核心程序总是会自己宕机，然后需要手工去起，而这个服务的安全级别又很高，只有我可以操作，搞得我晚上老没法睡，昨晚实在受不了了，想起以前在hp-ux下写的s..."}
{"title": "我常用的find命令", "content": "查找某种类型文件中包含特定字符的文件\r\nfind /* -type f -name \"*.php\" |xargs grep \"rename(\"\r\nfind ./|xargs grep -ri \"is_vip\" -l\r\n \r\nLinux下find一次查找多个指定文件或者排除某类文件，在 GREP 中匹配多个关键字的方法（1）Linux下find一次查找多个指定文件:查找a.html和b.html\r\n\r\nfind . -name \"a.html\" -name \"b.html\"\r\n\r\n\r\nfind . -regex '.*\\.txt\\|.*\\.doc\\|.*\\.mp3'\r\nfind . -regex '.*\\.txt\\|.*\\.doc\\|.*\\.mp3' \r\n\r\n./a.txt \r\n./a.doc ./a.mp3   \r\n \r\n(2)排除某些文件类型：排除目录下所有以html结尾的文件：\r\n\r\nfind . -type f ! -name \"*.html\"\r\n\r\n./ge.bak.02.09 \r\n./ge.html.changed.by.jack ./a.txt   ./a.doc   ./a.mp3   \r\n \r\n（3）排除多种文件类型的示例：\r\n\r\nfind . -type f ! -name \"*.html\" -type f ! -name \"*.php\" -type f ! -name \"*.svn-base\" -type f ! -name \"*.js\" -type f ! -name \"*.gif\" -type f ! -name \"*.png\" -type f ! -name \"*.cpp\" -type f ! -name \"*.h\" -type f ! -name \"*.o\" -type f ! -name \"*.jpg\" -type f ! -name \"*.so\" -type f ! -name \"*.bak\" -type f ! -name \"*.log\"\r\n\r\n（3）在 GREP 中匹配多个关键字的方法：\r\ngrep查找多个数字的文件：-r 递归，-E：正则  -l：只显示文件名\r\n\r\ngrep -r -E '0341028|100081|10086|10001' * \r\n\r\na.txt:100081 \r\nb.txt:10086 c/cc.txt:0341028   c/cc.txt:100081   c/cc.txt:10086   c/cc.txt:10001   c.txt:10001   d.txt:0341028   \r\n \r\n\r\ngrep -r -E -l '0341028|100081|10086|10001' * \r\n\r\na.txt \r\nb.txt c/cc.txt   c.txt   d.txt   \r\n \r\n多种类型文件示例：\r\n\r\nfind . -name \"*.html\" -o -name \"*.js\"|xargs grep -r \"BusiTree\"\r\n\r\n（4）查找系统大于100M的文件\r\n\r\nfind / -type f -size +1000000k \r\n\r\n ", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>我常用的find命令 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4505949.html\">我常用的find命令</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>查找某种类型文件中包含特定字符的文件</p>\r\n<p><strong><span style=\"line-height: 1.5;\">find /* -type f -name \"<span style=\"color: #ff0000;\">*.php</span>\" |xargs grep \"<span style=\"color: #ff0000;\">rename(</span>\"</span></strong></p>\r\n<p>find ./|xargs grep -ri \"is_vip\" -l</p>\r\n<p> </p>\r\n<p>Linux下find一次查找多个指定文件或者排除某类文件，在 GREP 中匹配多个关键字的方法<br>（1）Linux下find一次查找多个指定文件:<br>查找a.html和b.html</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">find</span> . -name <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">a.html</span><span style=\"color: #800000;\">\"</span> -name <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">b.html</span><span style=\"color: #800000;\">\"</span></pre>\r\n</div>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">find</span> . -regex <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">.*\\.txt\\|.*\\.doc\\|.*\\.mp3</span><span style=\"color: #800000;\">'</span>\r\n<span style=\"color: #0000ff;\">find</span> . -regex <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">.*\\.txt\\|.*\\.doc\\|.*\\.mp3</span><span style=\"color: #800000;\">'</span> </pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">./a.txt </span></p>\r\n<p>./a.doc <br>./a.mp3   </p>\r\n<p> </p>\r\n<p>(2)排除某些文件类型：<br>排除目录下所有以html结尾的文件：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">find</span> . -type f ! -name <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">*.html</span><span style=\"color: #800000;\">\"</span></pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">./ge.bak.02.09 </span></p>\r\n<p>./ge.html.changed.by.jack <br>./a.txt   <br>./a.doc   <br>./a.mp3   </p>\r\n<p> </p>\r\n<p>（3）排除多种文件类型的示例：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">find</span> . -type f ! -name <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">*.html</span><span style=\"color: #800000;\">\"</span> -type f ! -name <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">*.php</span><span style=\"color: #800000;\">\"</span> -type f ! -name <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">*.svn-base</span><span style=\"color: #800000;\">\"</span> -type f ! -name <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">*.js</span><span style=\"color: #800000;\">\"</span> -type f ! -name <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">*.gif</span><span style=\"color: #800000;\">\"</span> -type f ! -name <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">*.png</span><span style=\"color: #800000;\">\"</span> -type f ! -name <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">*.cpp</span><span style=\"color: #800000;\">\"</span> -type f ! -name <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">*.h</span><span style=\"color: #800000;\">\"</span> -type f ! -name <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">*.o</span><span style=\"color: #800000;\">\"</span> -type f ! -name <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">*.jpg</span><span style=\"color: #800000;\">\"</span> -type f ! -name <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">*.so</span><span style=\"color: #800000;\">\"</span> -type f ! -name <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">*.bak</span><span style=\"color: #800000;\">\"</span> -type f ! -name <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">*.log</span><span style=\"color: #800000;\">\"</span></pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">（3）在 GREP 中匹配多个关键字的方法：</span></p>\r\n<p>grep查找多个数字的文件：<br>-r 递归，-E：正则  -l：只显示文件名</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">grep</span> -r -E <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">0341028|100081|10086|10001</span><span style=\"color: #800000;\">'</span> * </pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">a.txt:100081 </span></p>\r\n<p>b.txt:10086 <br>c/cc.txt:0341028   <br>c/cc.txt:100081   <br>c/cc.txt:10086   <br>c/cc.txt:10001   <br>c.txt:10001   <br>d.txt:0341028   </p>\r\n<p> </p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">grep</span> -r -E -l <span style=\"color: #800000;\">'</span><span style=\"color: #800000;\">0341028|100081|10086|10001</span><span style=\"color: #800000;\">'</span> * </pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">a.txt </span></p>\r\n<p>b.txt <br>c/cc.txt   <br>c.txt   <br>d.txt   </p>\r\n<p> </p>\r\n<p>多种类型文件示例：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">find</span> . -name <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">*.html</span><span style=\"color: #800000;\">\"</span> -o -name <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">*.js</span><span style=\"color: #800000;\">\"</span>|<span style=\"color: #0000ff;\">xargs</span> <span style=\"color: #0000ff;\">grep</span> -r <span style=\"color: #800000;\">\"</span><span style=\"color: #800000;\">BusiTree</span><span style=\"color: #800000;\">\"</span></pre>\r\n</div>\r\n<p>（4）查找系统大于100M的文件</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">find</span> / -type f -size +1000000k </pre>\r\n</div>\r\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-15 14:52</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4505949\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4505949);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4505949,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/15 14:52:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4505949.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=20", "desc": "摘要: 查找某种类型文件中包含特定字符的文件find /* -type f -name \"*.php\" |xargs grep \"rename(\"find ./|xargs grep -ri \"is_vip\" -lLinux下find一次查找多个指定文件或者排除某类文件，在 GREP 中匹配多个关键字的方法..."}
{"title": "设置windows网络连接别名和linux网络连接别名", "content": "windows网络连接别名\r\nC:\\Windows\\System32\\drivers\\etc目录下的hosts文件中添加\r\n\r\n127.0.0.1 localhost\r\n192.168.1.100 proxy.zj.chinamobile.com\r\n\r\n \r\nlinux网络连接别名\r\n/etc/hosts\r\n\r\n# Do not remove the following line, or various programs\r\n# that require network functionality will fail.\r\n192.168.1.100 test1\r\n192.168.1.101 test2\r\n\r\n \r\n设置好以后，可以绕过域名解析，直接用域名访问相应IP的网站了。", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>设置windows网络连接别名和linux网络连接别名 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4505786.html\">设置windows网络连接别名和linux网络连接别名</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>windows网络连接别名</p>\r\n<p><span style=\"color: #ff0000;\"><strong>C:\\Windows\\System32\\drivers\\etc</strong></span>目录下的<span style=\"color: #ff0000;\"><strong>hosts</strong></span>文件中添加</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #800080;\">127.0</span>.<span style=\"color: #800080;\">0.1</span><span style=\"color: #000000;\"> localhost\r\n</span><span style=\"color: #800080;\">192.168</span>.<span style=\"color: #800080;\">1.100</span> proxy.zj.chinamobile.com</pre>\r\n</div>\r\n<p> </p>\r\n<p><span style=\"line-height: 1.5;\">linux网络连接别名</span></p>\r\n<p><span style=\"color: #ff0000;\"><strong>/etc/hosts</strong></span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #000000;\"># Do not remove the following line, or various programs\r\n# that require network functionality will fail.\r\n</span><span style=\"color: #800080;\">192.168</span>.<span style=\"color: #800080;\">1.100</span><span style=\"color: #000000;\"> test1\r\n</span><span style=\"color: #800080;\">192.168</span>.<span style=\"color: #800080;\">1.101</span> test2</pre>\r\n</div>\r\n<p> </p>\r\n<p>设置好以后，可以绕过域名解析，直接用域名访问相应IP的网站了。</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-15 13:49</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4505786\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4505786);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4505786,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/15 13:49:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4505786.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=20", "desc": "摘要: windows网络连接别名C:\\Windows\\System32\\drivers\\etc目录下的hosts文件中添加127.0.0.1 localhost192.168.1.100 proxy.zj.chinamobile.comlinux网络连接别名/etc/hosts# Do not remov..."}
{"title": "【转】如何调试bash脚本", "content": "本文转自：http://coolshell.cn/articles/1379.html\r\nBash 是Linux操作系统的默认Shell脚本。Shell是用来处理操作系统和用户交互的一个程序。Shell的脚本可以帮助用户自动化地和操作系统进行交互。你也可以理解为一种脚本式的编程。即然有编程，那么，程序的编译器，解释器，调试器就必不可少了，Bash也一样，但在调试方面可能会有一些和编程语言不一样的东西和技术，所以，下面这篇文章主要是说明调试bash脚本的各种技术。\r\n跟踪脚本的执行\r\n你可以让bash打印出你脚本执行的过程中的所有语句。这很简单，只需要使用bash的-x选项就可以做到，下面让我们来看一下。\r\n \r\n下面的这段脚本，先是输出一个问候语句，然后输出当前的时间：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n\r\n\r\n\r\n#!/bin/bash\r\necho \"Hello $USER,\"\r\necho \"Today is $(date +'%Y-%m-%d')\"\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n下面让我们使用-x选项来运行这段脚本：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n\r\n\r\n\r\n$ bash -x example_script.sh\r\n+ echo 'Hello chenhao,'\r\nHello chenhao,\r\n++ date +%Y-%m-%d\r\n+ echo 'Today is 2009-08-31'\r\nToday is 2009-08-31\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n这时，我们可以看到，bash在运行前打印出了每一行命令。而且每行前面的+号表明了嵌套。这样的输出可以让你看到命令执行的顺序并可以让你知道整个脚本的行为。在跟踪里输出行号\r\n在一个很大的脚本中，你会看到很多很多的执行跟踪的输出，阅读起来非常费劲，所以，你可以在每一行前加上文件的行号，这会非常有用。要做到这样，你只需要设置下面的环境变量：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n\r\n\r\n\r\n\r\n  \r\nexport PS4='+${BASH_SOURCE}:${LINENO}:${FUNCNAME[0]}: '\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n让我们看看设置上了PS4这个环境变量后会是什么样的输出。\r\n \r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n\r\n\r\n\r\n\r\n$ bash -x example_script.sh\r\n+example_script.sh:2:: echo 'Hello chenhao,'\r\nHello chenhao,\r\n++example_script.sh:3:: date +%Y-%m-%d\r\n+example_script.sh:3:: echo 'Today is 2009-08-31'\r\nToday is 2009-08-31\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n 调试部份的脚本\r\n有些时候，你并不想调试整个脚本，你只要调试其中的一部份，那么，你可以在你想要调试的脚本之前，调用“set -x”，结束的时候调用“set +x”就可以了。如下面的脚本所示：\r\n \r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n\r\n\r\n\r\n\r\n#!/bin/bash\r\necho \"Hello $USER,\"\r\nset -x\r\necho \"Today is $(date %Y-%m-%d)\"\r\nset +x\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n \r\n让我们看看运行起来是啥样？\r\n \r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n6\r\n\r\n\r\n\r\n\r\n$ ./example_script.sh\r\nHello chenhao,\r\n++example_script.sh:4:: date +%Y-%m-%d\r\n+example_script.sh:4:: echo 'Today is 2009-08-31'\r\nToday is 2009-08-31\r\n+example_script.sh:5:: set +x\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n \r\n注意：我们在运行脚本的时候，不需要使用bash -x了。\r\n \r\n日志输出\r\n跟踪日志有时候太多了，多得都受不了，而且，输出的内容很难阅读。一般来说，我们很多时候只关心于条件表达式，变量值，或是函数调用，或是循环等。。在这种情况下，log一些感兴趣的特定的信息，可能会更好。\r\n使用log前，我们先写一个函数：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n4\r\n5\r\n\r\n\r\n\r\n\r\n_log() {\r\n    if [ \"$_DEBUG\" == \"true\" ]; then\r\n        echo 1>&2 \"$@\"\r\n    fi\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n \r\n于是，你就可以在你的脚本中如下使用：\r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n3\r\n\r\n\r\n\r\n\r\n  \r\n_log \"Copying files...\"\r\ncp src/* dst/\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n 我们可以看到，上面那个_log函数，需要检查一个_DEBUG 变量，只有这个变量是真，才会真正开发输出日志。这样，你就只需要控制这个开关，而不需要删除你的debug信息。\r\n \r\n\r\n\r\n\r\n\r\n\r\n\r\n1\r\n2\r\n\r\n\r\n\r\n\r\n  \r\n$ _DEBUG=true ./example_script.sh\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n \r\n使用Bash专用调试器\r\n如果你在写一个相当复杂的脚本，并且，你需要一个完整的像调试别的语言一样的调试器，那么你可以试着用用这个开源软件—— bashdb， 一个Bash的专用调试器。这个调试器很强大，你想得到的功能，他都有，比如，设置断点，单步跟踪，跳出函数，等等。它的用户接口很想GDB，这是他的文档 。\r\n（全文完）", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>【转】如何调试bash脚本 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4505449.html\">【转】如何调试bash脚本</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>本文转自：http://coolshell.cn/articles/1379.html</p>\r\n<p><a href=\"http://en.wikipedia.org/wiki/Bash\">Bash</a> 是Linux操作系统的默认Shell脚本。Shell是用来处理操作系统和用户交互的一个程序。Shell的脚本可以帮助用户自动化地和操作系统进行交互。你也可以理解为一种脚本式的编程。即然有编程，那么，程序的编译器，解释器，调试器就必不可少了，Bash也一样，但在调试方面可能会有一些和编程语言不一样的东西和技术，所以，下面这篇文章主要是说明调试bash脚本的各种技术。</p>\r\n<h4 id=\"Tracing_script_execution\">跟踪脚本的执行</h4>\r\n<p>你可以让bash打印出你脚本执行的过程中的所有语句。这很简单，只需要使用bash的-x选项就可以做到，下面让我们来看一下。</p>\r\n<p> </p>\r\n<p>下面的这段脚本，先是输出一个问候语句，然后输出当前的时间：</p>\r\n<div>\r\n<div id=\"highlighter_176682\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash preprocessor bold\">#!/bin/bash</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash functions\">echo</code> <code class=\"bash string\">\"Hello $USER,\"</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash functions\">echo</code> <code class=\"bash string\">\"Today is $(date +'%Y-%m-%d')\"</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>下面让我们使用-x选项来运行这段脚本：</p>\r\n<div>\r\n<div id=\"highlighter_646869\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">bash</code> <code class=\"bash plain\">-x example_script.sh</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">+ </code><code class=\"bash functions\">echo</code> <code class=\"bash string\">'Hello chenhao,'</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">Hello chenhao,</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">++ </code><code class=\"bash functions\">date</code> <code class=\"bash plain\">+%Y-%m-%d</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">+ </code><code class=\"bash functions\">echo</code> <code class=\"bash string\">'Today is 2009-08-31'</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">Today is 2009-08-31</code></div>\r\n</div>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</div>\r\n</div>\r\n<p>这时，我们可以看到，bash在运行前打印出了每一行命令。而且每行前面的+号表明了嵌套。这样的输出可以让你看到命令执行的顺序并可以让你知道整个脚本的行为。<br><strong>在跟踪里输出行号</strong></p>\r\n<p>在一个很大的脚本中，你会看到很多很多的执行跟踪的输出，阅读起来非常费劲，所以，你可以在每一行前加上文件的行号，这会非常有用。要做到这样，你只需要设置下面的环境变量：</p>\r\n<div>\r\n<div id=\"highlighter_39791\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash spaces\"> </code> </div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash functions\">export</code> <code class=\"bash plain\">PS4=</code><code class=\"bash string\">'+${BASH_SOURCE}:${LINENO}:${FUNCNAME[0]}: '</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<p>让我们看看设置上了PS4这个环境变量后会是什么样的输出。</p>\r\n<p> </p>\r\n<div>\r\n<div id=\"highlighter_405299\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ </code><code class=\"bash functions\">bash</code> <code class=\"bash plain\">-x example_script.sh</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">+example_script.sh:2:: </code><code class=\"bash functions\">echo</code> <code class=\"bash string\">'Hello chenhao,'</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">Hello chenhao,</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">++example_script.sh:3:: </code><code class=\"bash functions\">date</code> <code class=\"bash plain\">+%Y-%m-%d</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">+example_script.sh:3:: </code><code class=\"bash functions\">echo</code> <code class=\"bash string\">'Today is 2009-08-31'</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">Today is 2009-08-31</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<p> <br><strong>调试部份的脚本</strong></p>\r\n<p>有些时候，你并不想调试整个脚本，你只要调试其中的一部份，那么，你可以在你想要调试的脚本之前，调用“set -x”，结束的时候调用“set +x”就可以了。如下面的脚本所示：</p>\r\n<p> </p>\r\n<div>\r\n<div id=\"highlighter_366140\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash preprocessor bold\">#!/bin/bash</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash functions\">echo</code> <code class=\"bash string\">\"Hello $USER,\"</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash functions\">set</code> <code class=\"bash plain\">-x</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash functions\">echo</code> <code class=\"bash string\">\"Today is $(date %Y-%m-%d)\"</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash functions\">set</code> <code class=\"bash plain\">+x</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<p> </p>\r\n<p>让我们看看运行起来是啥样？</p>\r\n<p> </p>\r\n<div>\r\n<div id=\"highlighter_519132\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n<div class=\"line number6 index5 alt1\">6</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">$ .</code><code class=\"bash plain\">/example_script</code><code class=\"bash plain\">.sh</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">Hello chenhao,</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash plain\">++example_script.sh:4:: </code><code class=\"bash functions\">date</code> <code class=\"bash plain\">+%Y-%m-%d</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash plain\">+example_script.sh:4:: </code><code class=\"bash functions\">echo</code> <code class=\"bash string\">'Today is 2009-08-31'</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">Today is 2009-08-31</code></div>\r\n<div class=\"line number6 index5 alt1\"><code class=\"bash plain\">+example_script.sh:5:: </code><code class=\"bash functions\">set</code> <code class=\"bash plain\">+x</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<p> </p>\r\n<p>注意：我们在运行脚本的时候，不需要使用bash -x了。</p>\r\n<p> </p>\r\n<h4 id=\"Logging\">日志输出</h4>\r\n<p>跟踪日志有时候太多了，多得都受不了，而且，输出的内容很难阅读。一般来说，我们很多时候只关心于条件表达式，变量值，或是函数调用，或是循环等。。在这种情况下，log一些感兴趣的特定的信息，可能会更好。</p>\r\n<p>使用log前，我们先写一个函数：</p>\r\n<div>\r\n<div id=\"highlighter_821044\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n<div class=\"line number4 index3 alt1\">4</div>\r\n<div class=\"line number5 index4 alt2\">5</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash plain\">_log() {</code></div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash spaces\">    </code><code class=\"bash keyword\">if</code> <code class=\"bash plain\">[ </code><code class=\"bash string\">\"$_DEBUG\"</code> <code class=\"bash plain\">== </code><code class=\"bash string\">\"true\"</code> <code class=\"bash plain\">]; </code><code class=\"bash keyword\">then</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash spaces\">        </code><code class=\"bash functions\">echo</code> <code class=\"bash plain\">1&gt;&amp;2 </code><code class=\"bash string\">\"$@\"</code></div>\r\n<div class=\"line number4 index3 alt1\"><code class=\"bash spaces\">    </code><code class=\"bash keyword\">fi</code></div>\r\n<div class=\"line number5 index4 alt2\"><code class=\"bash plain\">}</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<p> </p>\r\n<p>于是，你就可以在你的脚本中如下使用：</p>\r\n<div>\r\n<div id=\"highlighter_307634\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n<div class=\"line number3 index2 alt2\">3</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash spaces\"> </code> </div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">_log </code><code class=\"bash string\">\"Copying files...\"</code></div>\r\n<div class=\"line number3 index2 alt2\"><code class=\"bash functions\">cp</code> <code class=\"bash plain\">src/* dst/</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<p> <br>我们可以看到，上面那个_log函数，需要检查一个_DEBUG 变量，只有这个变量是真，才会真正开发输出日志。这样，你就只需要控制这个开关，而不需要删除你的debug信息。</p>\r\n<p> </p>\r\n<div>\r\n<div id=\"highlighter_838896\" class=\"syntaxhighlighter coolshell_syntaxhighlighter bash\">\r\n<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\r\n<tbody>\r\n<tr>\r\n<td class=\"gutter\">\r\n<div class=\"line number1 index0 alt2\">1</div>\r\n<div class=\"line number2 index1 alt1\">2</div>\r\n\r\n</td>\r\n<td class=\"code\">\r\n<div class=\"container\">\r\n<div class=\"line number1 index0 alt2\"><code class=\"bash spaces\"> </code> </div>\r\n<div class=\"line number2 index1 alt1\"><code class=\"bash plain\">$ _DEBUG=</code><code class=\"bash functions\">true</code> <code class=\"bash plain\">.</code><code class=\"bash plain\">/example_script</code><code class=\"bash plain\">.sh</code></div>\r\n\r\n</div>\r\n\r\n</td>\r\n\r\n</tr>\r\n\r\n</tbody>\r\n\r\n</table>\r\n\r\n</div>\r\n\r\n</div>\r\n<p> </p>\r\n<h4 id=\"Using_the_Bash_debugger\">使用Bash专用调试器</h4>\r\n<p>如果你在写一个相当复杂的脚本，并且，你需要一个完整的像调试别的语言一样的调试器，那么你可以试着用用这个开源软件—— <a href=\"http://bashdb.sourceforge.net/\">bashdb</a>， 一个Bash的专用调试器。这个调试器很强大，你想得到的功能，他都有，比如，设置断点，单步跟踪，跳出函数，等等。它的用户接口很想GDB，这是他的<a href=\"http://bashdb.sourceforge.net/bashdb.html\">文档</a> 。</p>\r\n<p>（全文完）</p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-15 11:20</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4505449\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4505449);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4505449,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/15 11:20:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4505449.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=20", "desc": "摘要: 本文转自：http://coolshell.cn/articles/1379.htmlBash是Linux操作系统的默认Shell脚本。Shell是用来处理操作系统和用户交互的一个程序。Shell的脚本可以帮助用户自动化地和操作系统进行交互。你也可以理解为一种脚本式的编程。即然有编程，那么，程序的编..."}
{"title": "我常用的crontab命令", "content": "命令简介\r\ncrontab-操作每个用户的守护程序和该执行的时间表。部分参数说明crontab file [-u user]-用指定的文件替代目前的crontab。crontab-[-u user]-用标准输入替代目前的crontab.crontab-1[user]-列出用户目前的crontab.crontab-e[user]-编辑用户目前的crontab.crontab-d[user]-删除用户目前的crontab.crontab-c dir- 指定crontab的目录。crontab文件的格式：M H D m d cmd.M: 分钟（0-59）。H：小时（0-23）。D：天（1-31）。m: 月（1-12）。d: 一星期内的天（0~6，0为星期天）。cmd要运行的程序，程序被送入sh执行，这个shell只有USER,HOME,SHELL这三个环境变量。\r\n\r\n一次配置，多次运行：\r\n\r\n\r\n0,10,20,30,40,50 6,7,8,9 * * * sh /home/hlst_ftp_ls.sh\r\n\r\n上述配置表示，6,7,8,9四个小时中每个小时的0分，10分，20分，30分，40分，50分都运行。\r\n\r\n每小时0~10分钟内，每隔2分钟运行一次\r\n\r\n\r\n0-10/2 * * * * sh /home/test/test.sh &\r\n\r\n次配置表示每小时0~10分，每隔2分钟运行一遍", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>我常用的crontab命令 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4505574.html\">我常用的crontab命令</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p>命令简介</p>\r\n<p>crontab-操作每个用户的守护程序和该执行的时间表。<br>部分参数说明<br>crontab file [-u user]-用指定的文件替代目前的crontab。<br>crontab-[-u user]-用标准输入替代目前的crontab.<br><span style=\"color: #ff0000;\"><strong>crontab-1[user]-列出用户目前的crontab.</strong></span><br><span style=\"color: #ff0000;\"><strong>crontab-e[user]-编辑用户目前的crontab.</strong></span><br>crontab-d[user]-删除用户目前的crontab.<br>crontab-c dir- 指定crontab的目录。<br><span style=\"color: #ff0000;\"><strong>crontab文件的格式：M H D m d cmd.</strong></span><br>M: 分钟（0-59）。<br>H：小时（0-23）。<br>D：天（1-31）。<br>m: 月（1-12）。<br>d: 一星期内的天（0~6，0为星期天）。<br>cmd要运行的程序，程序被送入sh执行，这个shell只有USER,HOME,SHELL这三个环境变量。</p>\r\n<ul>\r\n<li>一次配置，多次运行：</li>\r\n</ul>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #800080;\">0</span>,<span style=\"color: #800080;\">10</span>,<span style=\"color: #800080;\">20</span>,<span style=\"color: #800080;\">30</span>,<span style=\"color: #800080;\">40</span>,<span style=\"color: #800080;\">50</span> <span style=\"color: #800080;\">6</span>,<span style=\"color: #800080;\">7</span>,<span style=\"color: #800080;\">8</span>,<span style=\"color: #800080;\">9</span> * * * <span style=\"color: #0000ff;\">sh</span> /home/hlst_ftp_ls.<span style=\"color: #0000ff;\">sh</span></pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">上述配置表示，6,7,8,9四个小时中每个小时的0分，10分，20分，30分，40分，50分都运行。</span></p>\r\n<ul>\r\n<li>每小时0~10分钟内，每隔2分钟运行一次</li>\r\n</ul>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #800080;\">0</span>-<span style=\"color: #800080;\">10</span>/<span style=\"color: #800080;\">2</span> * * * * <span style=\"color: #0000ff;\">sh</span> /home/test/test.<span style=\"color: #0000ff;\">sh</span> &amp;</pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">次配置表示每小时0~10分，每隔2分钟运行一遍</span></p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-15 12:01</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4505574\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4505574);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4505574,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/15 12:01:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4505574.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=20", "desc": "摘要: 命令简介crontab-操作每个用户的守护程序和该执行的时间表。部分参数说明crontab file [-u user]-用指定的文件替代目前的crontab。crontab-[-u user]-用标准输入替代目前的crontab.crontab-1[user]-列出用户目前的crontab.cro..."}
{"title": "oracle、mysql、sybase和sqlserver复制表结构和数据", "content": "Sql Server(sybase)：\r\n1．复制表结构：\r\n新建表student2，并且结构同表syn_xj_student一致。Sql语句如下：\r\n\r\nselect * into syn_xj_student2 from syn_xj_student where 1=2\r\n\r\n2．复制表数据，并排除俩表中相同的数据：\r\n\r\ninsert into syn_xj_student2 select * from syn_xj_student where f_id not in (select f_id from syn_xj_student2)\r\n\r\nmysql：\r\n1．复制表结构：\r\n\r\ncreate table topic like bbs_topic\r\n\r\n2．复制表数据：\r\n\r\nINSERT into topic SELECT * FROM bbs_topic\r\n\r\n3．复制整个表：\r\n\r\nCREATE TABLE new_table SELECT * FROM old_table;\r\n\r\nOracle：\r\n1.复制表结构\r\n\r\ncreate table 用户名.表名 as select * from 用户名.表名 where 1=2\r\n\r\n2.同用户表之间的数据复制\r\n用户B下有两个表：B.x和B.y，如果需要从表x转移数据到表y，使用用户B登陆sqlpus即可：\r\n\r\ninsert into y select * from x;\r\n\r\n3.B.x中个别字段转移到B.y的相同字段\r\n\r\ninsert into y(字段1,字段2) select 字段1,字段2 from\r\n\r\n4.不同用户之间的表数据复制\r\n对于在一个数据库上的两个用户A和B，假如需要把A下表old的数据复制到B下的new，请使用权限足够的用户登入sqlplus：\r\n\r\ninsert into B.newTable(select * from A.oldTable);\r\n\r\n如果需要加条件限制，比如复制当天的A.oldTable数据\r\n\r\ninsert into B.newTable(select * from A.oldTable where date=GMT);\r\n\r\n ", "html": "<html lang=\"zh-cn\">\r\n<head>\r\n<meta charset=\"utf-8\">\r\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\r\n<title>oracle、mysql、sybase和sqlserver复制表结构和数据 - 秋楓 - 博客园</title>\r\n<link type=\"text/css\" rel=\"stylesheet\" href=\"/bundles/blog-common.css?v=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1\">\n<link id=\"MainCss\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside.css?v=RRjf6pEarGnbXZ86qxNycPfQivwSKWRa4heYLB15rVE1\">\n<link id=\"mobile-style\" media=\"only screen and (max-width: 768px)\" type=\"text/css\" rel=\"stylesheet\" href=\"/skins/ThinkInside/bundle-ThinkInside-mobile.css?v=XiHqzbpMg2U13FTnOc9wLUlANuknD0GvNM80XwtTSvY1\">\r\n<link title=\"RSS\" type=\"application/rss+xml\" rel=\"alternate\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">\r\n<link title=\"RSD\" type=\"application/rsd+xml\" rel=\"EditURI\" href=\"http://www.cnblogs.com/rwxwsblog/rsd.xml\">\n<link type=\"application/wlwmanifest+xml\" rel=\"wlwmanifest\" href=\"http://www.cnblogs.com/rwxwsblog/wlwmanifest.xml\">\r\n<script src=\"//common.cnblogs.com/script/jquery.js\" type=\"text/javascript\"></script>  \r\n<script type=\"text/javascript\">var currentBlogApp = 'rwxwsblog', cb_enable_mathjax=false;var isLogined=false;</script>\r\n<script src=\"/bundles/blog-common.js?v=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1\" type=\"text/javascript\"></script>\r\n</head>\r\n<body>\r\n<a name=\"top\"></a>\n<!--PageBeginHtml Block Begin-->\n<a href=\"https://github.com/jackgitgz\" target=\"_blank\"><img style=\"position: absolute; top: 35px; right: 0; border: 0; position: fixed;\" src=\"https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67\" alt=\"Fork me on GitHub\" data-canonical-src=\"https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png\"></a>\n<!--PageBeginHtml Block End-->\r\n\r\n<!--done-->\r\n<div id=\"home\">\r\n<div id=\"header\">\r\n\t<div id=\"blogTitle\">\r\n\t<a id=\"lnkBlogLogo\" href=\"http://www.cnblogs.com/rwxwsblog/\"><img id=\"blogLogo\" src=\"/Skins/custom/images/logo.gif\" alt=\"返回主页\"></a>\t\t\t\r\n\t\t\r\n<!--done-->\r\n<h1><a id=\"Header1_HeaderTitle\" class=\"headermaintitle\" href=\"http://www.cnblogs.com/rwxwsblog/\">一葉知秋</a></h1>\r\n<h2></h2><p><a>知道可以做什么样的人，是成长的基础。</a></p>\r\n\r\n\r\n\r\n\t\t\r\n\t</div><!--end: blogTitle 博客的标题和副标题 -->\r\n\t<div id=\"navigator\">\r\n\t\t\r\n<ul id=\"navList\">\r\n<li><a id=\"blog_nav_sitehome\" class=\"menu\" href=\"http://www.cnblogs.com/\">博客园</a></li>\r\n<li><a id=\"blog_nav_myhome\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/\">首页</a></li>\r\n<li><a id=\"blog_nav_newpost\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/EditPosts.aspx?opt=1\">新随笔</a></li>\r\n<li><a id=\"blog_nav_contact\" class=\"menu\" rel=\"nofollow\" href=\"https://msg.cnblogs.com/send/%E7%A7%8B%E6%A5%93\">联系</a></li>\r\n<li><a id=\"blog_nav_rss\" class=\"menu\" href=\"http://www.cnblogs.com/rwxwsblog/rss\">订阅</a>\r\n<!--<a id=\"blog_nav_rss_image\" class=\"aHeaderXML\" href=\"http://www.cnblogs.com/rwxwsblog/rss\"><img src=\"//www.cnblogs.com/images/xml.gif\" alt=\"订阅\" /></a>--></li>\r\n<li><a id=\"blog_nav_admin\" class=\"menu\" rel=\"nofollow\" href=\"https://i.cnblogs.com/\">管理</a></li>\r\n</ul>\r\n\t\t<div class=\"blogStats\">\r\n\t\t\t\r\n\t\t\t<div id=\"blog_stats\">\r\n<span id=\"stats_post_count\">随笔 - 315  </span>\r\n<span id=\"stats_article_count\">文章 - 0  </span>\r\n<span id=\"stats-comment_count\">评论 - 208</span>\r\n</div>\r\n\t\t\t\r\n\t\t</div><!--end: blogStats -->\r\n\t</div><!--end: navigator 博客导航栏 -->\r\n</div><!--end: header 头部 -->\r\n\r\n<div id=\"main\">\r\n\t<div id=\"mainContent\">\r\n\t<div class=\"forFlow\">\r\n\t\t\r\n<div id=\"post_detail\">\r\n<!--done-->\r\n<div id=\"topics\">\r\n\t<div class=\"post\">\r\n\t\t<h1 class=\"postTitle\">\r\n\t\t\t<a id=\"cb_post_title_url\" class=\"postTitle2\" href=\"http://www.cnblogs.com/rwxwsblog/p/4506016.html\">oracle、mysql、sybase和sqlserver复制表结构和数据</a>\r\n\t\t</h1>\r\n\t\t<div class=\"clear\"></div>\r\n\t\t<div class=\"postBody\">\r\n\t\t\t<div id=\"cnblogs_post_body\"><p><span style=\"color: #ff0000;\"><strong>Sql Server(sybase)：</strong></span></p>\r\n<p>1．复制表结构：</p>\r\n<p>新建表student2，并且结构同表syn_xj_student一致。Sql语句如下：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">select</span> <span style=\"color: #808080;\">*</span> <span style=\"color: #0000ff;\">into</span> syn_xj_student2 <span style=\"color: #0000ff;\">from</span> syn_xj_student <span style=\"color: #0000ff;\">where</span> <span style=\"color: #800000; font-weight: bold;\">1</span><span style=\"color: #808080;\">=</span><span style=\"color: #800000; font-weight: bold;\">2</span></pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">2．复制表数据，并排除俩表中相同的数据：</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">insert</span> <span style=\"color: #0000ff;\">into</span> syn_xj_student2 <span style=\"color: #0000ff;\">select</span> <span style=\"color: #808080;\">*</span> <span style=\"color: #0000ff;\">from</span> syn_xj_student <span style=\"color: #0000ff;\">where</span> f_id <span style=\"color: #808080;\">not</span> <span style=\"color: #808080;\">in</span> (<span style=\"color: #0000ff;\">select</span> f_id <span style=\"color: #0000ff;\">from</span> syn_xj_student2)</pre>\r\n</div>\r\n<p><strong style=\"color: #ff0000; line-height: 1.5;\">mysql：</strong></p>\r\n<p>1．复制表结构：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">create</span> <span style=\"color: #0000ff;\">table</span> topic <span style=\"color: #808080;\">like</span> bbs_topic</pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">2．复制表数据：</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">INSERT</span> <span style=\"color: #0000ff;\">into</span> topic <span style=\"color: #0000ff;\">SELECT</span> <span style=\"color: #808080;\">*</span> <span style=\"color: #0000ff;\">FROM</span> bbs_topic</pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">3．复制整个表：</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">CREATE</span> <span style=\"color: #0000ff;\">TABLE</span> new_table <span style=\"color: #0000ff;\">SELECT</span> <span style=\"color: #808080;\">*</span> <span style=\"color: #0000ff;\">FROM</span> old_table;</pre>\r\n</div>\r\n<p><strong style=\"color: #ff0000; line-height: 1.5;\">Oracle：</strong></p>\r\n<p>1.复制表结构</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">create</span> <span style=\"color: #0000ff;\">table</span> 用户名.表名 <span style=\"color: #0000ff;\">as</span> <span style=\"color: #0000ff;\">select</span> <span style=\"color: #808080;\">*</span> <span style=\"color: #0000ff;\">from</span> 用户名.表名 <span style=\"color: #0000ff;\">where</span> <span style=\"color: #800000; font-weight: bold;\">1</span><span style=\"color: #808080;\">=</span><span style=\"color: #800000; font-weight: bold;\">2</span></pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">2.同用户表之间的数据复制</span></p>\r\n<p>用户B下有两个表：B.x和B.y，如果需要从表x转移数据到表y，使用用户B登陆sqlpus即可：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">insert</span> <span style=\"color: #0000ff;\">into</span> y <span style=\"color: #0000ff;\">select</span> <span style=\"color: #808080;\">*</span> <span style=\"color: #0000ff;\">from</span> x;</pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">3.B.x中个别字段转移到B.y的相同字段</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">insert</span> <span style=\"color: #0000ff;\">into</span> y(字段1,字段2) <span style=\"color: #0000ff;\">select</span> 字段1,字段2 <span style=\"color: #0000ff;\">from</span></pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">4.不同用户之间的表数据复制</span></p>\r\n<p>对于在一个数据库上的两个用户A和B，假如需要把A下表old的数据复制到B下的new，请使用权限足够的用户登入sqlplus：</p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">insert</span> <span style=\"color: #0000ff;\">into</span> B.newTable(<span style=\"color: #0000ff;\">select</span> <span style=\"color: #808080;\">*</span> <span style=\"color: #0000ff;\">from</span> A.oldTable);</pre>\r\n</div>\r\n<p><span style=\"line-height: 1.5;\">如果需要加条件限制，比如复制当天的A.oldTable数据</span></p>\r\n<div class=\"cnblogs_code\">\r\n<pre><span style=\"color: #0000ff;\">insert</span> <span style=\"color: #0000ff;\">into</span> B.newTable(<span style=\"color: #0000ff;\">select</span> <span style=\"color: #808080;\">*</span> <span style=\"color: #0000ff;\">from</span> A.oldTable <span style=\"color: #0000ff;\">where</span> date<span style=\"color: #808080;\">=</span>GMT);</pre>\r\n</div>\r\n<p> </p></div><div id=\"MySignature\"></div>\r\n<div class=\"clear\"></div>\r\n<div id=\"blog_post_info_block\">\r\n<div id=\"BlogPostCategory\"></div>\r\n<div id=\"EntryTag\"></div>\r\n<div id=\"blog_post_info\">\r\n</div>\r\n<div class=\"clear\"></div>\r\n<div id=\"post_next_prev\"></div>\r\n</div>\r\n\r\n\r\n\t\t</div>\r\n\t\t<div class=\"postDesc\">posted @ <span id=\"post-date\">2015-05-15 15:10</span> <a href=\"http://www.cnblogs.com/rwxwsblog/\">秋楓</a> 阅读(<span id=\"post_view_count\">...</span>) 评论(<span id=\"post_comment_count\">...</span>)  <a href=\"https://i.cnblogs.com/EditPosts.aspx?postid=4506016\" rel=\"nofollow\">编辑</a> <a href=\"#\" onclick=\"AddToWz(4506016);return false;\">收藏</a></div>\r\n\t</div>\r\n\t<script type=\"text/javascript\">var allowComments=true,cb_blogId=210525,cb_entryId=4506016,cb_blogApp=currentBlogApp,cb_blogUserGuid='c869982d-3092-e411-b908-9dcfd8948a71',cb_entryCreatedDate='2015/5/15 15:10:00';loadViewCount(cb_entryId);</script>\r\n\t\r\n</div><!--end: topics 文章、评论容器-->\r\n</div><a name=\"!comments\"></a><div id=\"blog-comments-placeholder\"></div><script type=\"text/javascript\">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>\r\n<div id=\"comment_form\" class=\"commentform\">\r\n<a name=\"commentform\"></a>\r\n<div id=\"divCommentShow\"></div>\r\n<div id=\"comment_nav\"><span id=\"span_refresh_tips\"></span><a href=\"javascript:void(0);\" onclick=\"return RefreshCommentList();\" id=\"lnk_RefreshComments\" runat=\"server\" clientidmode=\"Static\">刷新评论</a><a href=\"#\" onclick=\"return RefreshPage();\">刷新页面</a><a href=\"#top\">返回顶部</a></div>\r\n<div id=\"comment_form_container\"></div>\r\n<div class=\"ad_text_commentbox\" id=\"ad_text_under_commentbox\"></div>\r\n<div id=\"ad_t2\"></div>\r\n<div id=\"opt_under_post\"></div>\r\n<div id=\"cnblogs_c1\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_news\"></div>\r\n<div id=\"cnblogs_c2\" class=\"c_ad_block\"></div>\r\n<div id=\"under_post_kb\"></div>\r\n<div id=\"HistoryToday\" class=\"c_ad_block\"></div>\r\n<script type=\"text/javascript\">\r\n    fixPostBody();\r\n    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);\r\n    deliverAdT2();\r\n    deliverAdC1();\r\n    deliverAdC2();    \r\n    loadNewsAndKb();\r\n    loadBlogSignature();\r\n    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);\r\n    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);\r\n    loadOptUnderPost();\r\n    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   \r\n</script>\r\n</div>\r\n\r\n\r\n\t</div><!--end: forFlow -->\r\n\t</div><!--end: mainContent 主体内容容器-->\r\n\r\n\t<div id=\"sideBar\">\r\n\t\t<div id=\"sideBarMain\">\r\n\t\t\t\r\n<!--done-->\r\n<div class=\"newsItem\">\r\n<h3 class=\"catListTitle\">公告</h3>\r\n\t<div id=\"blog-news\"></div><script type=\"text/javascript\">loadBlogNews();</script>\r\n</div>\r\n\r\n\t\t\t<div id=\"blog-calendar\" style=\"display:none\"></div><script type=\"text/javascript\">loadBlogDefaultCalendar();</script>\r\n\t\t\t\r\n\t\t\t<div id=\"leftcontentcontainer\">\r\n\t\t\t\t<div id=\"blog-sidecolumn\"></div><script type=\"text/javascript\">loadBlogSideColumn();</script>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div><!--end: sideBarMain -->\r\n\t</div><!--end: sideBar 侧边栏容器 -->\r\n\t<div class=\"clear\"></div>\r\n\t</div><!--end: main -->\r\n\t<div class=\"clear\"></div>\r\n\t<div id=\"footer\">\r\n\t\t\r\n<!--done-->\r\nCopyright ©2017 秋楓\r\n\t</div><!--end: footer -->\r\n</div><!--end: home 自定义的最大容器 -->\n<!--PageEndHtml Block Begin-->\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818%26show%3Dpic' type='text/javascript'%3E%3C/script%3E\"));</script>\r\n<script type=\"text/javascript\">var cnzz_protocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");document.write(unescape(\"%3Cspan id='cnzz_stat_icon_1255738818'%3E%3C/span%3E%3Cscript src='\" + cnzz_protocol + \"s95.cnzz.com/z_stat.php%3Fid%3D1255738818' type='text/javascript'%3E%3C/script%3E\"));</script>\n<!--PageEndHtml Block End-->\r\n</body>\r\n</html>", "link": "http://www.cnblogs.com/rwxwsblog/p/4506016.html", "listUrl": "http://www.cnblogs.com/rwxwsblog/default.html?page=20", "desc": "摘要: Sql Server(sybase)：1．复制表结构：新建表student2，并且结构同表syn_xj_student一致。Sql语句如下：select * into syn_xj_student2 from syn_xj_student where 1=22．复制表数据，并排除俩表中相同的数据：i..."}
